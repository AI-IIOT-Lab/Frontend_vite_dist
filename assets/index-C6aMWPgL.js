import{d as e,b as a,i as t,e as r,B as l,o as s,c as i,O as o,P as n,ai as c,V as d,a as u,T as h,U as m,u as p,az as g,aA as f,E as w,S as b,s as v,a9 as _,F as y,_ as P,au as V}from"./@vue-CUhjx3xN.js";import{d as k,s as M,c as T}from"./pinia-1b3CJuO9.js";import{s as U}from"./pinia-plugin-persistedstate-Cs-f0Iqr.js";import{E,a as z,g as L,i as C}from"./element-plus-B-tr-0tJ.js";import{u as S,c as x,a as j,b as R}from"./vue-router-dm1sOcUI.js";import{i as A}from"./echarts-Dl9h2yw_.js";import{a as D}from"./axios-CQPGHLVK.js";import{o as N,d as I,B as $,i as q,m as F,Q as G,O as B,R as O,S as Y,T as H,U as W,k as Z}from"./@element-plus-B6wVwyZJ.js";import{T as J,E as K}from"./@wangeditor-L7EEmVTa.js";import"./lodash-es-CjrOehCd.js";import"./@vueuse-BiPv-Z-O.js";import"./@popperjs-CpAfbxx4.js";import"./@ctrl-D2oWfImC.js";import"./dayjs-BKYM6hcM.js";import"./async-validator-Cuo4gI4y.js";import"./memoize-one-Ds0C_khL.js";import"./normalize-wheel-es-CUoAWVRo.js";import"./@floating-ui-OmdWBiZ4.js";import"./tslib-DITk-L2-.js";import"./zrender-CJ9J8NmF.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))a(e);new MutationObserver((e=>{for(const t of e)if("childList"===t.type)for(const e of t.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&a(e)})).observe(document,{childList:!0,subtree:!0})}function a(e){if(e.ep)return;e.ep=!0;const a=function(e){const a={};return e.integrity&&(a.integrity=e.integrity),e.referrerPolicy&&(a.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?a.credentials="include":"anonymous"===e.crossOrigin?a.credentials="omit":a.credentials="same-origin",a}(e);fetch(e.href,a)}}();const Q=(e,a)=>{const t=e.__vccOpts||e;for(const[r,l]of a)t[r]=l;return t},X=Q(e({__name:"LineChart",props:{chartData:{}},setup(e){const o=e,n=a(null);let c=null;const d=()=>{c&&o.chartData&&c.setOption({xAxis:{type:"category",data:o.chartData.labels},yAxis:{type:"value"},series:o.chartData.datasets.map((e=>({name:e.label,type:"line",data:e.data,smooth:!0}))),tooltip:{trigger:"axis"},legend:{data:o.chartData.datasets.map((e=>e.label))}})},u=()=>{c&&c.resize()};return t((()=>{n.value&&(c=A(n.value),d(),window.addEventListener("resize",u))})),r((()=>o.chartData),(()=>{d()}),{deep:!0}),l((()=>{window.removeEventListener("resize",u),c&&c.dispose()})),(e,a)=>(s(),i("div",{ref_key:"chartRef",ref:n,class:"line-chart"},null,512))}}),[["__scopeId","data-v-5c790e80"]]),ee="/auth",ae=k("login",{state:()=>({token:localStorage.getItem("authToken")||null,username:null,isAuthenticated:!1}),actions:{async login({username:e,password:a}){return await new Promise(((t,r)=>{re({url:`${ee}/login`,method:"POST",data:{username:e,password:a}}).then((e=>{this.setUserData(e.token,e.username),this.isAuthenticated=!0,t()})).catch((e=>{r(e)}))}))},logout(){return new Promise((e=>{this.clearUserData(),e()}))},async refreshToken(){return await new Promise(((e,a)=>{re({url:`${ee}/refresh-token`,method:"POST",headers:{Authorization:`Bearer ${this.token}`}}).then((a=>{this.setUserData(a.token,a.username),e(a.token)})).catch((e=>{a(e)}))}))},addAminCount:async e=>await new Promise(((a,t)=>{re({url:`${ee}/createAdmin`,method:"POST",data:e}).then((()=>{a()})).catch((e=>t(e)))})),setUserData(e,a){this.token=e,this.username=a,this.isAuthenticated=!0,localStorage.setItem("authToken",e),localStorage.setItem("username",a)},clearUserData(){this.token=null,this.username=null,this.isAuthenticated=!1,localStorage.removeItem("authToken"),localStorage.removeItem("username")}},persist:{key:"login-store",storage:localStorage}}),te=D.create({baseURL:"/api",timeout:1e4,headers:{"Content-Type":"application/json"}});te.interceptors.request.use((e=>{const a=localStorage.getItem("authToken");return e.headers={...te.defaults.headers,...e.headers},a&&e.headers&&(e.headers.Authorization=`Bearer ${a}`),e}),(e=>Promise.reject(e))),te.interceptors.response.use((e=>new Promise(((a,t)=>{if(200===e.status){const{data:r}=e;200===r.status?a(r):t(r.message)}else a(e)}))),(async e=>new Promise((async(a,t)=>{const r=e.config;if(e.response){const{status:t,data:l}=e.response;401===t&&(l.message&&l.message.includes("令牌已过期")&&!r._retry?(r._retry=!0,await ae().refreshToken().then((e=>{r.headers.Authorization=`Bearer ${e}`,a(te(r))})).catch((e=>{ae().clearUserData(),ae().$reset(),Et.push({name:"Login"})}))):(ae().clearUserData(),ae().$reset(),Et.push({name:"Login"})))}t(e.response?e.response.data:e.message)}))));const re=e=>new Promise(((a,t)=>{te.request(e).then((e=>{a(e.data)})).catch((e=>{t(e)}))})),le="/latest-updates",se=k("news",{state:()=>({newsList:[],totalNews:0,currentPage:1,cachedNews:[],cacheTimestamp:0,cacheDuration:3e5,pageSize:15,newsGrowth:[]}),getters:{findNewsById:e=>a=>e.newsList.find((e=>e.id===a))},actions:{async fetchNews(e=1){const a=Date.now();a-this.cacheTimestamp>this.cacheDuration&&this.clearCache();const t=(e-1)*this.pageSize,r=e*this.pageSize;if(!(this.cachedNews.length>=r&&this.cachedNews.slice(t,r).length>0))return await new Promise(((t,r)=>{re({url:le,method:"GET",params:{page:e,size:this.pageSize}}).then((r=>{const{data:l,total:s}=r;l.forEach((e=>{this.cachedNews.some((a=>a.id===e.id))||this.cachedNews.push(e)})),this.totalNews=s,this.cacheTimestamp=a,this.updateNewsList(e),t()})).catch((e=>{r(e)}))}));this.updateNewsList(e)},async fetchNewsById(e){const a=this.findNewsById(e);return a||await new Promise(((a,t)=>{re({url:`${le}/${e}`,method:"GET"}).then((e=>a(e))).catch((e=>t(e)))}))},async addNews(e){return await new Promise(((a,t)=>{re({url:le,method:"POST",data:e}).then((e=>{Array.isArray(this.cachedNews)||(this.cachedNews=[],this.cachedNews.push(e),this.totalNews+=1,this.updateNewsList(this.currentPage)),a()})).catch((e=>t(e)))}))},async updateNews(e){return await new Promise(((a,t)=>{re({url:`${le}/${e.id}`,method:"PUT",data:e}).then((e=>{const t=this.cachedNews.findIndex((a=>a.id===e.id));-1!==t&&(this.cachedNews[t]=e,this.updateNewsList(this.currentPage)),a()})).catch((e=>{t(e)}))}))},async deleteNews(e){return await new Promise(((a,t)=>{re({method:"DELETE",url:`${le}/${e}`}).then((()=>{this.cachedNews=this.cachedNews.filter((a=>a.id!==e)),this.totalNews-=1,this.updateNewsList(this.currentPage),a()})).catch((e=>{t(e)}))}))},updateNewsList(e){this.newsList=this.cachedNews.slice((e-1)*this.pageSize,e*this.pageSize),this.currentPage=e},async fetchNewsGrowth(){return await new Promise(((e,a)=>{re({url:`${le}/growth`,method:"GET"}).then((a=>{this.newsGrowth=a,e()})).catch((e=>a(e)))}))},clearCache(){this.cachedNews=[],this.cacheTimestamp=0}},persist:{key:"news-store",storage:sessionStorage}}),ie="/research-projects",oe=k("projects",{state:()=>({projectsList:[],totalProjects:0,currentPage:1,cachedProjects:[],cacheTimestamp:0,cacheDuration:3e5,pageSize:15,dialogVisible:!1}),getters:{findProjectById:e=>a=>e.projectsList.find((e=>e.id===a))},actions:{async fetchProjects(e=1){const a=Date.now();a-this.cacheTimestamp>this.cacheDuration&&this.clearCache();const t=(e-1)*this.pageSize,r=e*this.pageSize;if(!(this.cachedProjects.length>=r&&this.cachedProjects.slice(t,r).length>0))return await new Promise(((t,r)=>{re({url:ie,method:"GET",params:{page:e,size:this.pageSize}}).then((({data:r,total:l})=>{r.forEach((r=>{this.cachedProjects.some((e=>e.id===r.id))||this.cachedProjects.push(r),this.totalProjects=l,this.cacheTimestamp=a,this.updateProjectList(e),t()}))})).catch((e=>{r(e)}))}));this.updateProjectList(e)},async fetchProjectById(e){const a=this.findProjectById(e);return a||await new Promise(((a,t)=>{re({url:`${ie}/${e}`,method:"GET"}).then((e=>{a(e)})).catch((e=>{t(e)}))}))},async addProject(e){return await new Promise(((a,t)=>{re({url:ie,method:"POST",data:e}).then((e=>{this.cachedProjects.push(e),this.totalProjects+=1,this.updateProjectList(this.currentPage),a()})).catch((e=>{t(e)}))}))},async updateProject(e){return await new Promise(((a,t)=>{re({url:`${ie}/${e.id}`,method:"PUT",data:e}).then((e=>{const t=this.cachedProjects.findIndex((a=>a.id===e.id));-1!==t&&(this.cachedProjects[t]=e,this.updateProjectList(this.currentPage)),a()})).catch((e=>{t(e)}))}))},async deleteProject(e){return await new Promise(((a,t)=>{re({url:`${ie}/${e}`,method:"DELETE"}).then((()=>{this.cachedProjects=this.cachedProjects.filter((a=>a.id!==e)),this.totalProjects-=1,this.updateProjectList(this.currentPage),a()})).catch((e=>{t(e)}))}))},updateProjectList(e){this.cachedProjects&&0!==this.cachedProjects.length?this.projectsList=this.cachedProjects.slice((e-1)*this.pageSize,e*this.pageSize):this.projectsList=[],this.currentPage=e},clearCache(){this.cachedProjects=[],this.cacheTimestamp=0}},persist:{key:"projects-store",storage:sessionStorage}}),ne="/publications",ce=k("publications",{state:()=>({publicationsList:[],totalPublications:0,currentPage:1,cachedPublications:[],cacheTimestamp:0,cacheDuration:3e5,pageSize:15,dialogVisible:!1,publicationsGrowth:[]}),getters:{findPublicationById:e=>a=>e.publicationsList.find((e=>e.id===a))},actions:{async fetchPublications(e=1){const a=Date.now(),t=(e-1)*this.pageSize,r=e*this.pageSize;if(!(this.cachedPublications.length>=r&&this.cachedPublications.slice(t,r).length>0))return await new Promise(((t,r)=>{re({url:ne,method:"GET",params:{page:e,size:this.pageSize}}).then((({data:r,total:l})=>{r.forEach((e=>{this.cachedPublications.some((a=>a.id===e.id))||this.cachedPublications.push(e)})),this.totalPublications=l,this.cacheTimestamp=a,this.updatePublicationList(e),t()})).catch((e=>{r(e)}))}));this.updatePublicationList(e)},async fetchPublicationById(e){const a=this.findPublicationById(e);return a||await new Promise(((a,t)=>{re({url:`${ne}/${e}`,method:"GET"}).then((e=>a(e))).catch((e=>t(e)))}))},async addPublication(e){return await new Promise(((a,t)=>{re({url:ne,method:"POST",data:e}).then((e=>{this.cachedPublications.push(e),this.totalPublications+=1,this.updatePublicationList(this.currentPage),a()})).catch((e=>t(e)))}))},async updatePublication(e){return await new Promise(((a,t)=>{re({url:`${ne}/${e.id}`,method:"PUT",data:e}).then((e=>{const t=this.cachedPublications.findIndex((a=>a.id===e.id));-1!==t&&(this.cachedPublications[t]=e,this.updatePublicationList(this.currentPage)),a()})).catch((e=>t(e)))}))},async deletePublication(e){return await new Promise(((a,t)=>{re({method:"DELETE",url:`/api/publications/${e}`}).then((()=>{this.cachedPublications=this.cachedPublications.filter((a=>a.id!==e)),this.totalPublications-=1,this.updatePublicationList(this.currentPage),a()})).catch((e=>{t(e)}))}))},updatePublicationList(e){this.publicationsList=this.cachedPublications.slice((e-1)*this.pageSize,e*this.pageSize),this.currentPage=e},async fetchPublicationsGrowth(){return await new Promise(((e,a)=>{re({url:`${ne}/growth`,method:"GET"}).then((a=>{this.publicationsGrowth=a,e()})).catch((e=>a(e)))}))},clearCache(){this.cachedPublications=[],this.cacheTimestamp=0}},persist:{key:"publications-store",storage:sessionStorage}}),de="/important-links",ue=k("resources",{state:()=>({resourcesList:[],totalResources:0,currentPage:1,cachedResources:[],cacheTimestamp:0,cacheDuration:3e5,pageSize:15,dialogVisible:!1,resourcesGrowth:[]}),getters:{findResourceById:e=>a=>e.resourcesList.find((e=>e.id===a))},actions:{async fetchResources(e=1){const a=Date.now(),t=(e-1)*this.pageSize,r=e*this.pageSize;a-this.cacheTimestamp>this.cacheDuration&&this.clearCache();if(!(this.cachedResources.length>=r&&this.cachedResources.slice(t,r).length>0))return new Promise(((t,r)=>{re({url:de,method:"GET",params:{page:e,size:this.pageSize}}).then((({data:r,total:l})=>{r.forEach((e=>{this.cachedResources.some((a=>a.id===e.id))||this.cachedResources.push(e)})),this.totalResources=l,this.cacheTimestamp=a,this.updateResourceList(e),t()})).catch((e=>{r(e)}))}));this.updateResourceList(e)},async fetchResourceById(e){const a=this.findResourceById(e);return a||await new Promise(((a,t)=>{re({url:`${de}/${e}`,method:"GET"}).then((e=>{a(e)})).catch((e=>{t(e)}))}))},async addResource(e){return await new Promise(((a,t)=>{re({url:`${de}`,method:"POST",data:e}).then((e=>{this.cachedResources.push(e),this.totalResources+=1,this.updateResourceList(this.currentPage),a()})).catch((e=>{t(e)}))}))},async updateResource(e){return await new Promise(((a,t)=>{re({url:`${de}/${e.id}`,method:"PUT",data:e}).then((e=>{const t=this.cachedResources.findIndex((a=>a.id===e.id));-1!==t&&(this.cachedResources[t]=e,this.updateResourceList(this.currentPage)),a()})).catch((e=>{t(e)}))}))},async deleteResource(e){return await new Promise(((a,t)=>{re({url:`${de}/${e}`,method:"DELETE"}).then((()=>{this.cachedResources=this.cachedResources.filter((a=>a.id!==e)),this.totalResources-=1,this.updateResourceList(this.currentPage),a()})).catch((e=>{t(e)}))}))},updateResourceList(e){this.cachedResources&&0!==this.cachedResources.length?this.resourcesList=this.cachedResources.slice((e-1)*this.pageSize,e*this.pageSize):this.resourcesList=[],this.currentPage=e},async fechResourcesGrowth(){return await new Promise(((e,a)=>{re({url:`${de}/growth`,method:"GET"}).then((a=>{this.resourcesGrowth=a,e()})).catch((e=>a(e)))}))},clearCache(){this.cachedResources=[],this.cacheTimestamp=0}},persist:{key:"resources-store",storage:sessionStorage}}),he=k("fileUpload",{state:()=>({fileList:[]}),getters:{},actions:{uploadFile:async e=>await new Promise(((a,t)=>{const r=new FormData;r.append("file",e),re({url:"/files/upload",method:"POST",headers:{"Content-Type":"multipart/form-data"},data:r,onUploadProgress:e=>{if(e.event){Math.round(100*e.loaded/e.total)}}}).then((e=>{a(e)})).catch((e=>{t(e)}))}))}}),me="/team-members",pe=k("team",{state:()=>({teamMembersList:[],totalTeamMembers:0,currentPage:1,cachedTeamMembers:[],cacheTimestamp:0,cacheDuration:3e5,pageSize:15,dialogVisible:!1,email_error:""}),getters:{findTeamMemberById:e=>a=>e.teamMembersList.find((e=>e.id===a))},actions:{async fetchTeamMembers(e=1){const a=Date.now(),t=(e-1)*this.pageSize,r=e*this.pageSize;a-this.cacheTimestamp>this.cacheDuration&&this.clearCache();if(!(this.cachedTeamMembers.length>=r&&this.cachedTeamMembers.slice(t,r).length>0))return await new Promise(((t,r)=>{re({url:me,method:"GET",params:{page:e,size:this.pageSize}}).then((r=>{const{data:l,total:s}=r;l.forEach((e=>{this.cachedTeamMembers.some((a=>a.id===e.id))||this.cachedTeamMembers.push(e)})),this.totalTeamMembers=s,this.cacheTimestamp=a,this.updateTeamMembersList(e),t()})).catch((e=>{r(e)}))}));this.updateTeamMembersList(e)},async fetchTeamMemberById(e){const a=this.findTeamMemberById(e);return a||await new Promise(((a,t)=>{re({url:`${me}/${e}`,method:"GET"}).then((e=>a(e))).catch((e=>t(e)))}))},async addTeamMember(e){return await new Promise(((a,t)=>{re({url:me,method:"POST",data:e}).then((e=>{this.cachedTeamMembers.push(e),this.totalTeamMembers+=1,this.updateTeamMembersList(this.currentPage),a()})).catch((e=>{t(e)}))}))},async updateTeamMember(e){return await new Promise(((a,t)=>{re({url:`${me}/${e.id}`,method:"PUT",data:e}).then((e=>{const t=this.cachedTeamMembers.findIndex((a=>a.id===e.id));-1!==t&&(this.cachedTeamMembers[t]=e,this.updateTeamMembersList(this.currentPage)),a()})).catch((e=>{t(e)}))}))},async deleteTeamMember(e){return await new Promise(((a,t)=>{re({url:`${me}/${e}`,method:"DELETE"}).then((()=>{this.cachedTeamMembers=this.cachedTeamMembers.filter((a=>a.id!==e)),this.totalTeamMembers-=1,this.updateTeamMembersList(this.currentPage),a()})).catch((e=>{t(e)}))}))},updateTeamMembersList(e){this.cachedTeamMembers&&0!==this.cachedTeamMembers.length?this.teamMembersList=this.cachedTeamMembers.slice((e-1)*this.pageSize,e*this.pageSize):this.teamMembersList=[],this.currentPage=e},clearCache(){this.cachedTeamMembers=[],this.cacheTimestamp=0}},persist:{key:"team-store",storage:sessionStorage}}),ge="/users",fe=k("users",{state:()=>({usersList:[],totalUsers:0,currentPage:1,cachedUsers:[],cacheTimestamp:0,cacheDuration:3e5,pageSize:15,dialogVisible:!1,usersGrowth:[],email_error:"",username_error:""}),getters:{findUserById:e=>a=>e.usersList.find((e=>e.id===a))},actions:{async fetchUsers(e=1){const a=Date.now(),t=(e-1)*this.pageSize,r=e*this.pageSize;if(!(this.cachedUsers.length>=r&&this.cachedUsers.slice(t,r).length>0))return await new Promise(((t,r)=>{re({url:ge,method:"GET",params:{page:e,size:this.pageSize}}).then((r=>{const{data:l,total:s}=r;l.forEach((e=>{this.cachedUsers.some((a=>a.id===e.id))||this.cachedUsers.push(e)})),this.totalUsers=s,this.cacheTimestamp=a,this.updateUserList(e),t()})).catch((e=>{r(e)}))}));this.updateUserList(e)},async fetchUserById(e){const a=this.findUserById(e);return a||await new Promise(((a,t)=>{re({url:`${ge}/${e}`,method:"GET"}).then((e=>a(e))).catch((e=>t(e)))}))},async addUser(e){return await new Promise(((a,t)=>{re({url:`${ge}`,method:"POST",data:e}).then((e=>{this.cachedUsers.push(e),this.totalUsers+=1,this.updateUserList(this.currentPage),a()})).catch((e=>t(e)))}))},async updateUser(e){return await new Promise(((a,t)=>{re({url:`/users/${e.id}`,method:"PUT",data:e}).then((e=>{const t=this.cachedUsers.findIndex((a=>a.id===e.id));-1!==t&&(this.cachedUsers[t]=e,this.updateUserList(this.currentPage)),a()})).catch((e=>{t(e)}))}))},async deleteUser(e){return await new Promise(((a,t)=>{re({method:"DELETE",url:`/api/users/${e}`}).then((()=>{this.cachedUsers=this.cachedUsers.filter((a=>a.id!==e)),this.totalUsers-=1,this.updateUserList(this.currentPage),a()})).catch((e=>{t(e)}))}))},updateUserList(e){this.usersList=this.cachedUsers.slice((e-1)*this.pageSize,e*this.pageSize),this.currentPage=e},async fetchUserGrowthData(){return await new Promise(((e,a)=>{re({url:`${ge}/growth`,method:"GET"}).then((a=>{this.usersGrowth=a,e()})).catch((e=>a(e)))}))},clearCache(){this.cachedUsers=[],this.cacheTimestamp=0}},persist:{key:"users-store",storage:sessionStorage}}),we="/messages",be=k("messages",{state:()=>({messagesList:[],totalMessages:0,currentPage:1,cachedMessages:[],cacheTimestamp:0,cacheDuration:3e5,pageSize:15,dialogVisible:!1}),getters:{findMessageById:e=>a=>e.messagesList.find((e=>e.id===a))},actions:{async fetchMessages(e=1){const a=Date.now();a-this.cacheTimestamp>this.cacheDuration&&this.clearCache();const t=(e-1)*this.pageSize,r=e*this.pageSize;if(!(this.cachedMessages.length>=r&&this.cachedMessages.slice(t,r).length>0))return await new Promise(((t,r)=>{re({url:we,method:"GET",params:{page:e,size:this.pageSize}}).then((r=>{const{data:l,total:s}=r;l.forEach((e=>{this.cachedMessages.some((a=>a.id===e.id))||this.cachedMessages.push(e)})),this.totalMessages=s,this.cacheTimestamp=a,this.updateMessagesList(e),t()})).catch((e=>{r(e)}))}));this.updateMessagesList(e)},async fetchMessageById(e){const a=this.findMessageById(e);return a||await new Promise(((a,t)=>{re({url:`${we}/${e}`,method:"GET"}).then((e=>a(e))).catch((e=>t(e)))}))},async addMessage(e){return await new Promise(((a,t)=>{re({url:we,method:"POST",data:e}).then((e=>{Array.isArray(this.cachedMessages)||(this.cachedMessages=[]),this.cachedMessages.push(e),this.totalMessages+=1,this.updateMessagesList(this.currentPage),a()})).catch((e=>t(e)))}))},async updateMessage(e,a){return await new Promise(((t,r)=>{re({url:`${we}/${e}/is-read`,method:"PUT",data:a}).then((e=>{const a=this.cachedMessages.findIndex((a=>a.id===e.id));-1!==a&&(this.cachedMessages[a]=e,this.updateMessagesList(this.currentPage)),t()})).catch((e=>{r(e)}))}))},async deleteMessage(e){return await new Promise(((a,t)=>{re({method:"DELETE",url:`${we}/${e}`}).then((()=>{this.cachedMessages=this.cachedMessages.filter((a=>a.id!==e)),this.totalMessages-=1,this.updateMessagesList(this.currentPage),a()})).catch((e=>{t(e)}))}))},updateMessagesList(e){this.messagesList=this.cachedMessages.slice((e-1)*this.pageSize,e*this.pageSize),this.currentPage=e},clearCache(){this.cachedMessages=[],this.cacheTimestamp=0}},persist:{key:"messages-store",storage:sessionStorage}}),ve=()=>({news:se(),projects:oe(),publications:ce(),resources:ue(),upload:he(),teams:pe(),users:fe(),messages:be(),login:ae()}),_e={slot:"header",class:"card-header"},ye={class:"card-value"},Pe={slot:"header",class:"card-header"},Ve={class:"card-value"},ke={slot:"header",class:"card-header"},Me={class:"card-value"},Te={slot:"header",class:"card-header"},Ue={class:"card-value"},Ee={slot:"header",class:"card-header"},ze={class:"card-value ellipsis"},Le={slot:"header",class:"card-header"},Ce={class:"card-value"},Se={slot:"header",class:"card-header"},xe={class:"card-value"},je=(e=>(g("data-v-caad31bf"),e=e(),f(),e))((()=>u("p",null,"加载中...",-1))),Re=Q(e({__name:"Dashboard",setup(e){const{news:r,users:l,projects:i,publications:g,resources:f,teams:w,messages:b,login:v}=ve(),{totalNews:_,newsGrowth:y}=M(r),{totalProjects:P}=M(i),{totalPublications:V,publicationsGrowth:k}=M(g),{totalResources:T,resourcesGrowth:U}=M(f),{totalTeamMembers:E}=M(w),{totalUsers:z,usersGrowth:L}=M(l),{totalMessages:C}=M(b),{isAuthenticated:S}=M(v),x=a({labels:[],datasets:[{label:"新闻数量变化折线图",data:[],fill:!1,borderColor:"#409EFF",tension:.1}]}),j=a({labels:[],datasets:[{label:"出版物变化折线图",data:[],fill:!1,borderColor:"#409EFF",tension:.1}]}),R=a({labels:[],datasets:[{label:"资源变化折线图",data:[],fill:!1,borderColor:"#409EFF",tension:.1}]}),A=a({labels:[],datasets:[{label:"用户变化折线图",data:[],fill:!1,borderColor:"#409EFF",tension:.1}]}),D=a(!0);return t((()=>{(async()=>{try{await r.fetchNews(),await r.fetchNewsGrowth().then((()=>{x.value.labels=y.value.map((e=>e.month)),x.value.datasets[0].data=y.value.map((e=>e.data))})),await l.fetchUsers(),await l.fetchUserGrowthData().then((()=>{A.value.labels=L.value.map((e=>e.month)),A.value.datasets[0].data=L.value.map((e=>e.data))})),await i.fetchProjects(),await g.fetchPublications(),await g.fetchPublicationsGrowth().then((()=>{j.value.labels=k.value.map((e=>e.month)),j.value.datasets[0].data=k.value.map((e=>e.data))})),await f.fetchResources(),await f.fechResourcesGrowth().then((()=>{R.value.labels=U.value.map((e=>e.month)),R.value.datasets[0].data=U.value.map((e=>e.data))})),await w.fetchTeamMembers(),await b.fetchMessages(),D.value=!1}catch(e){e.messages&&e.messages.includes("JWT verification failed")&&(S.value=!1,Et.push({name:"Login"}))}})()})),(e,a)=>{const t=c("router-link"),r=c("el-card"),l=c("el-col"),i=c("el-row"),g=c("el-main"),f=c("el-container");return D.value?(s(),o(f,{key:1,class:"dashboard"},{default:n((()=>[d(g,null,{default:n((()=>[d(i,{class:"stats-row"},{default:n((()=>[d(l,null,{default:n((()=>[d(r,{shadow:"hover"},{default:n((()=>[je])),_:1})])),_:1})])),_:1})])),_:1})])),_:1})):(s(),o(f,{key:0,class:"dashboard"},{default:n((()=>[d(g,null,{default:n((()=>[d(i,{gutter:20,class:"stats-row"},{default:n((()=>[d(l,{span:6},{default:n((()=>[d(r,{shadow:"hover"},{default:n((()=>[u("div",_e,[d(t,{to:"/news"},{default:n((()=>[h("新闻数量")])),_:1})]),u("p",ye,m(p(_)),1)])),_:1})])),_:1}),d(l,{span:6},{default:n((()=>[d(r,{shadow:"hover"},{default:n((()=>[u("div",Pe,[d(t,{to:"/projects"},{default:n((()=>[h("项目数量")])),_:1})]),u("p",Ve,m(p(P)),1)])),_:1})])),_:1}),d(l,{span:6},{default:n((()=>[d(r,{shadow:"hover"},{default:n((()=>[u("div",ke,[d(t,{to:"/publications"},{default:n((()=>[h("出版物总数")])),_:1})]),u("p",Me,m(p(V)),1)])),_:1})])),_:1}),d(l,{span:6},{default:n((()=>[d(r,{shadow:"hover"},{default:n((()=>[u("div",Te,[d(t,{to:"/resources"},{default:n((()=>[h("资源数量")])),_:1})]),u("p",Ue,m(p(T)),1)])),_:1})])),_:1})])),_:1}),d(i,{gutter:20,class:"stats-row",style:{"margin-top":"20px"}},{default:n((()=>[d(l,{span:6},{default:n((()=>[d(r,{shadow:"hover"},{default:n((()=>[u("div",Ee,[d(t,{to:"/team"},{default:n((()=>[h("团队成员数量")])),_:1})]),u("p",ze,m(p(E)),1)])),_:1})])),_:1}),d(l,{span:6},{default:n((()=>[d(r,{shadow:"hover"},{default:n((()=>[u("div",Le,[d(t,{to:"/users"},{default:n((()=>[h("用户总数")])),_:1})]),u("p",Ce,m(p(z)),1)])),_:1})])),_:1}),d(l,{span:6},{default:n((()=>[d(r,{shadow:"hover"},{default:n((()=>[u("div",Se,[d(t,{to:"/messages"},{default:n((()=>[h("留言总数")])),_:1})]),u("p",xe,m(p(C)),1)])),_:1})])),_:1})])),_:1}),d(i,{gutter:20,style:{"margin-top":"20px"}},{default:n((()=>[d(l,{span:12},{default:n((()=>[d(r,{shadow:"hover"},{default:n((()=>[d(X,{"chart-data":x.value},null,8,["chart-data"])])),_:1})])),_:1}),d(l,{span:12},{default:n((()=>[d(r,{shadow:"hover"},{default:n((()=>[d(X,{"chart-data":j.value},null,8,["chart-data"])])),_:1})])),_:1})])),_:1}),d(i,{gutter:20,style:{"margin-top":"20px"}},{default:n((()=>[d(l,{span:12},{default:n((()=>[d(r,{shadow:"hover"},{default:n((()=>[d(X,{"chart-data":R.value},null,8,["chart-data"])])),_:1})])),_:1}),d(l,{span:12},{default:n((()=>[d(r,{shadow:"hover"},{default:n((()=>[d(X,{"chart-data":A.value},null,8,["chart-data"])])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}))}}}),[["__scopeId","data-v-caad31bf"]]),Ae=(e,a)=>{if(!e)return"无日期";try{return new Intl.DateTimeFormat("zh-CN",{...a,timeZone:"Asia/Shanghai"}).format(new Date(e))}catch(t){return e}},De=e=>Ae(e,{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!1}).replace(/\//g,"-"),Ne=e=>Ae(e,{year:"numeric",month:"2-digit",day:"2-digit"}).replace(/\//g,"-"),Ie=e=>{if(!e)return NaN;try{if(/^\d{4}$/.test(e))return parseInt(e,10);return new Date(e).getFullYear()}catch(a){return 1900}},$e={slot:"footer",class:"dialog-footer"},qe=e({__name:"MessageDialog",props:{isEdit:{type:Boolean},currentMessage:{}},emits:["save"],setup(e,{emit:t}){const{messages:r}=ve();let{dialogVisible:l}=M(r);const i=e,g=t,f=a(null),b=a({name:[{required:!0,message:"姓名不能为空",trigger:"blur"}],email:[{required:!0,type:"email",message:"请输入正确的邮箱地址",trigger:"blur"}],message:[{required:!0,message:"留言内容不能为空",trigger:"blur"}]}),v=()=>{f.value&&f.value.validate((async e=>{e?g("save",i.currentMessage):z.warning("请检查表单填写是否正确")}))},_=()=>{l.value=!1};return(e,a)=>{const t=c("el-input"),r=c("el-form-item"),i=c("el-switch"),g=c("el-button"),y=c("el-dialog");return s(),o(y,{title:e.isEdit?"编辑留言":"添加留言",modelValue:p(l),"onUpdate:modelValue":a[6]||(a[6]=e=>w(l)?l.value=e:l=e),onClose:_,"destroy-on-close":"",draggable:"","close-on-click-modal":!1},{default:n((()=>[d(p(E),{model:e.currentMessage,rules:b.value,ref_key:"messageForm",ref:f,"label-width":"100px","scroll-to-error":""},{default:n((()=>[d(r,{label:"姓名",prop:"name",readonly:""},{default:n((()=>[d(t,{modelValue:e.currentMessage.name,"onUpdate:modelValue":a[0]||(a[0]=a=>e.currentMessage.name=a),placeholder:"请输入留言者姓名",readonly:""},null,8,["modelValue"])])),_:1}),d(r,{label:"电子邮件",prop:"email"},{default:n((()=>[d(t,{modelValue:e.currentMessage.email,"onUpdate:modelValue":a[1]||(a[1]=a=>e.currentMessage.email=a),placeholder:"请输入留言者邮箱",readonly:""},null,8,["modelValue"])])),_:1}),d(r,{label:"留言内容",prop:"message"},{default:n((()=>[d(t,{modelValue:e.currentMessage.message,"onUpdate:modelValue":a[2]||(a[2]=a=>e.currentMessage.message=a),type:"textarea",placeholder:"请输入留言内容",readonly:""},null,8,["modelValue"])])),_:1}),d(r,{label:"IP 地址"},{default:n((()=>[d(t,{modelValue:e.currentMessage.ipAddress,"onUpdate:modelValue":a[3]||(a[3]=a=>e.currentMessage.ipAddress=a),placeholder:"请输入IP地址",readonly:""},null,8,["modelValue"])])),_:1}),d(r,{label:"是否已读"},{default:n((()=>[d(i,{modelValue:e.currentMessage.isRead,"onUpdate:modelValue":a[4]||(a[4]=a=>e.currentMessage.isRead=a),"active-icon":p(N),"inactive-icon":p(I),"inline-prompt":""},null,8,["modelValue","active-icon","inactive-icon"])])),_:1})])),_:1},8,["model","rules"]),u("div",$e,[d(g,{onClick:a[5]||(a[5]=e=>w(l)?l.value=!1:l=!1)},{default:n((()=>[h("取消")])),_:1}),d(g,{type:"primary",onClick:v},{default:n((()=>[h(m(e.isEdit?"保存":"添加"),1)])),_:1})])])),_:1},8,["title","modelValue"])}}}),Fe=(e=>(g("data-v-70c955c8"),e=e(),f(),e))((()=>u("div",{class:"header-content-common"},[u("h1",{class:"title-common"},"留言管理")],-1))),Ge=Q(e({__name:"Messages",setup(e){const{messages:r}=ve(),l=a(!1),i=a(1),u=a({createdAt:"",email:"",id:99999,ipAddress:"",isRead:!1,message:"",name:""}),g=async e=>{l.value?("无"===e.ipAddress&&(e.ipAddress=""),await r.updateMessage(e.id,e.isRead).then((()=>{z.success("留言更新成功"),r.dialogVisible=!1})).catch((e=>{z.error("留言更新失败: "+e)}))):await r.addMessage(e).then((()=>{z.success("留言添加成功"),r.dialogVisible=!1})).catch((e=>{z.error("留言添加失败: "+e)}))},f=e=>{i.value=e,r.fetchMessages(e)};return t((()=>{r.fetchMessages(i.value).catch((e=>{z.error("获取留言失败: "+e)}))})),(e,a)=>{const t=c("el-header"),w=c("el-table-column"),v=c("el-tag"),_=c("el-button"),y=c("el-table"),P=c("el-pagination"),V=c("el-empty"),k=c("el-main"),M=c("el-container");return s(),o(M,{class:"container-common"},{default:n((()=>[d(t,{class:"header-common"},{default:n((()=>[Fe])),_:1}),d(k,null,{default:n((()=>[p(r).messagesList.length?(s(),o(y,{key:0,data:p(r).messagesList,style:{width:"100%"},height:"673",stripe:"",border:"","highlight-current-row":"","show-overflow-tooltip":""},{default:n((()=>[d(w,{fixed:"",label:"序号",width:"60",align:"center","header-align":"center"},{default:n((e=>{return[h(m((a=e.$index,(i.value-1)*r.pageSize+a+1)),1)];var a})),_:1}),d(w,{prop:"name",label:"姓名",width:"150",align:"center"}),d(w,{prop:"email",label:"邮箱","min-width":"200",align:"center"}),d(w,{prop:"message",label:"留言内容","min-width":"300",align:"center"}),d(w,{prop:"ipAddress",label:"IP 地址","min-width":"150",align:"center"}),d(w,{prop:"isRead",label:"是否已读",width:"90",align:"center"},{default:n((e=>[d(v,{type:e.row.isRead?"success":"danger"},{default:n((()=>[h(m(e.row.isRead?"已读":"未读"),1)])),_:2},1032,["type"])])),_:1}),d(w,{prop:"createdAt",label:"提交时间",width:"160",align:"center"},{default:n((e=>[h(m(p(De)(e.row.createdAt)),1)])),_:1}),d(w,{fixed:"right",label:"操作",width:"140",align:"center","header-align":"center"},{default:n((e=>[d(_,{onClick:a=>{return t=e.row,l.value=!0,t.ipAddress=t.ipAddress||"无",u.value={...t},void(r.dialogVisible=!0);var t},type:"primary",size:"small"},{default:n((()=>[h("编辑")])),_:2},1032,["onClick"]),d(_,{onClick:a=>(async e=>{await r.deleteMessage(e).then((()=>{z.success("删除成功"),r.fetchMessages(i.value)})).catch((e=>{z.error("删除失败: "+e)}))})(e.row.id),type:"danger",size:"small"},{default:n((()=>[h("删除")])),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])):b("",!0),p(r).totalMessages>0?(s(),o(P,{key:1,background:"",layout:"total, prev, pager, next",total:p(r).totalMessages,"page-size":p(r).pageSize,onCurrentChange:f,class:"pagination_common"},null,8,["total","page-size"])):b("",!0),0===p(r).totalMessages?(s(),o(V,{key:2,style:{height:"673px"},description:"暂无留言"})):b("",!0)])),_:1}),d(qe,{isEdit:l.value,currentMessage:u.value,onSave:g},null,8,["isEdit","currentMessage"])])),_:1})}}}),[["__scopeId","data-v-70c955c8"]]),Be={class:"header-content-common"},Oe=(e=>(g("data-v-fe2231bc"),e=e(),f(),e))((()=>u("h1",{class:"title-common"},"新闻与活动管理",-1))),Ye={class:"operation-buttons"},He=Q(e({__name:"NewsList",setup(e){const{news:r}=ve(),l=a(1),i=async e=>{l.value=e,await r.fetchNews(e).catch((e=>{z.error("加载新闻数据失败: "+e.message)}))};return t((()=>{r.fetchNews().catch((e=>{z.error("初始化新闻数据失败: "+e.message)}))})),(e,a)=>{const t=c("el-icon"),g=c("router-link"),f=c("el-tooltip"),w=c("el-header"),v=c("el-table-column"),_=c("el-button"),y=c("el-popconfirm"),P=c("el-table"),V=c("el-pagination"),k=c("el-empty"),M=c("el-main"),T=c("el-container");return s(),o(T,{class:"container-common"},{default:n((()=>[d(w,{class:"header-common"},{default:n((()=>[u("div",Be,[Oe,d(f,{effect:"dark",content:"添加新闻",placement:"right-start"},{default:n((()=>[d(g,{to:{name:"NewsAdd"}},{default:n((()=>[d(t,{size:21,class:"add-icon-common"},{default:n((()=>[d(p($))])),_:1})])),_:1})])),_:1})])])),_:1}),d(M,null,{default:n((()=>[p(r).newsList.length?(s(),o(P,{key:0,data:p(r).newsList,style:{width:"100%"},height:"673",stripe:"",border:"","highlight-current-row":"","show-overflow-tooltip":""},{default:n((()=>[d(v,{fixed:"",label:"序号",width:"60",align:"center","header-align":"center"},{default:n((e=>{return[h(m((a=e.$index,(l.value-1)*r.pageSize+a+1)),1)];var a})),_:1}),d(v,{prop:"title",label:"新闻标题",align:"center","min-width":"600","header-align":"center"}),d(v,{prop:"createdAt",label:"创建日期","min-width":"160",align:"center","header-align":"center"},{default:n((e=>[h(m(p(De)(e.row.createdAt)),1)])),_:1}),d(v,{prop:"publishTime",label:"发布日期","min-width":"160",align:"center","header-align":"center"},{default:n((e=>[h(m(p(De)(e.row.publishTime)),1)])),_:1}),d(v,{fixed:"right",label:"操作",width:"180",align:"center","header-align":"center"},{default:n((e=>[u("div",Ye,[d(g,{to:{name:"NewsView",params:{id:e.row.id}}},{default:n((()=>[d(_,{type:"info",size:"small"},{default:n((()=>[h("查看")])),_:1})])),_:2},1032,["to"]),d(g,{to:{name:"NewsEdit",params:{id:e.row.id}}},{default:n((()=>[d(_,{type:"primary",size:"small"},{default:n((()=>[h("编辑")])),_:1})])),_:2},1032,["to"]),d(y,{"confirm-button-text":"是","cancel-button-text":"否",icon:p(q),"icon-color":"#626AEF",title:"确定删除这个文件嘛？",onConfirm:a=>(async e=>{await r.deleteNews(e).then((()=>{z.success("删除成功")})).catch((e=>{z.error("删除新闻失败: "+e.message)}))})(e.row.id)},{reference:n((()=>[d(_,{type:"danger",size:"small"},{default:n((()=>[h("删除")])),_:1})])),_:2},1032,["icon","onConfirm"])])])),_:1})])),_:1},8,["data"])):b("",!0),p(r).totalNews>0?(s(),o(V,{key:1,background:"",layout:"total, prev, pager, next",total:p(r).totalNews,"page-size":p(r).pageSize,"hide-on-single-page":!0,onCurrentChange:i,class:"pagination_common"},null,8,["total","page-size"])):b("",!0),0===p(r).newsList.length?(s(),o(k,{key:2,style:{height:"673px"},description:"暂无新闻"})):b("",!0)])),_:1})])),_:1})}}}),[["__scopeId","data-v-fe2231bc"]]),We={class:"header-content"},Ze={class:"inline-form-item"},Je={style:{border:"1px solid #ccc","min-height":"300px",width:"100%","text-align":"start"}},Ke=Q(e({__name:"NewsEdit",props:{id:{},mode:{}},setup(e){const r=v(),i=a(""),g=a({}),f=a("default"),w=e=>{r.value=e,"edit"===_.mode&&k.value.content&&e.setHtml(k.value.content)},b=e=>{k.value.content=e.getHtml()};l((()=>{const e=r.value;null!=e&&e.destroy()}));const _=e,y=S(),{news:P,upload:V}=ve(),k=a({id:null,title:"",content:"",publishTime:"",createdAt:""}),M=a(null),T={title:[{required:!0,message:"请输入新闻标题",trigger:"blur"}],content:[{required:!0,message:"请输入新闻内容",trigger:"blur"}],publishTime:[{required:!0,message:"请选择发布日期",trigger:"change"},{validator:(e,a,t)=>{new Date(a)<=new Date&&"add"===_.mode?t(new Error("发布日期必须在当前日期之后")):t()},trigger:"change"}]};t((()=>{var e;if("edit"===_.mode&&_.id){const a=P.findNewsById(_.id);a?(k.value=a,i.value=a.content,null==(e=r.value)||e.setHtml(a.content)):(z.error("未找到对应的新闻"),y.push({name:"News"}))}}));const U=a({placeholder:"输入新闻内容...",MENU_CONF:{uploadImage:{server:"/api/files/upload",fieldName:"image",headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`},maxFileSize:2097152,maxNumberOfFiles:5,allowedFileTypes:["image/jpeg","image/png"],customInsert(e,a){a(e.data,"",e.data)},async customUpload(e,a){Object.defineProperty(e,"uid",{value:L(),writable:!0,enumerable:!0,configurable:!0}),await V.uploadFile(e).then((e=>{a(e,"",e)})).catch((e=>{z.error("图片上传失败"+e)}))},onSuccess(e,a){z.success("图片上传成功")},onFailed(e,a){z.error("图片上传失败")},onError(e,a,t){z.error("图片上传出错")}}}}),C=()=>{y.push({name:"News"})},x=()=>{var e;null==(e=M.value)||e.validate((async e=>{e&&("add"===_.mode?await P.addNews({...k.value}).then((()=>{z.success("新闻添加成功"),y.push({name:"News"})})).catch((e=>{z.error("新闻添加失败："+e.message)})):await P.updateNews(k.value).then((()=>{z.success("新闻更新成功"),y.push({name:"News"})})).catch((e=>{z.error("新闻更新失败："+e.message)})))}))};return(e,a)=>{const t=c("el-button"),l=c("router-link"),v=c("el-header"),_=c("el-input"),y=c("el-form-item"),P=c("el-date-picker"),V=c("el-main"),z=c("el-container");return s(),o(z,{class:"news-edit"},{default:n((()=>[d(v,{class:"header"},{default:n((()=>{var a;return[u("div",We,[d(l,{to:{name:"News"}},{default:n((()=>[d(t,{type:"primary",icon:p(F),class:"back-button",plain:""},null,8,["icon"])])),_:1}),u("h1",null,m("add"===e.mode?"添加新闻":`编辑 ${(null==(a=k.value)?void 0:a.title)||"新闻"}`),1)])]})),_:1}),d(V,null,{default:n((()=>[d(p(E),{model:k.value,rules:T,ref_key:"newsForm",ref:M,"label-width":"100px"},{default:n((()=>[d(y,{label:"新闻标题",prop:"title"},{default:n((()=>[d(_,{modelValue:k.value.title,"onUpdate:modelValue":a[0]||(a[0]=e=>k.value.title=e),placeholder:"请输入新闻标题"},null,8,["modelValue"])])),_:1}),u("div",Ze,[d(y,{label:"发布日期",prop:"publishTime"},{default:n((()=>[d(P,{modelValue:k.value.publishTime,"onUpdate:modelValue":a[1]||(a[1]=e=>k.value.publishTime=e),type:"datetime",placeholder:"选择发布日期和时间","value-format":"YYYY-MM-DD HH:mm",format:"YYYY-MM-DD HH:mm"},null,8,["modelValue"])])),_:1}),u("div",null,[d(t,{onClick:C,class:"action-button"},{default:n((()=>[h("取消")])),_:1}),d(t,{type:"primary",onClick:x,class:"action-button"},{default:n((()=>[h(m("add"===e.mode?"添加":"保存"),1)])),_:1})])]),d(y,{label:"新闻内容",prop:"content"},{default:n((()=>[u("div",Je,[d(p(J),{style:{"border-bottom":"1px solid #ccc"},editor:r.value,defaultConfig:g.value,mode:f.value},null,8,["editor","defaultConfig","mode"]),d(p(K),{style:{height:"555px",width:"100%","overflow-y":"hidden"},modelValue:i.value,"onUpdate:modelValue":a[2]||(a[2]=e=>i.value=e),defaultConfig:U.value,mode:f.value,onOnCreated:w,onOnChange:b},null,8,["modelValue","defaultConfig","mode"])])])),_:1})])),_:1},8,["model"])])),_:1})])),_:1})}}}),[["__scopeId","data-v-0bd9831c"]]),Qe={class:"header-content"},Xe=["innerHTML"],ea=Q(e({__name:"NewsView",props:{id:{}},setup(e){const r=e;S();const{news:l}=ve(),i=a(null),g=a(!1);return t((()=>{try{i.value=l.findNewsById(r.id)||{id:null,title:"新闻未找到",content:"抱歉，没有找到相关内容。",createdAt:(new Date).toISOString().slice(0,10),publishTime:(new Date).toISOString().slice(0,10)}}catch(e){g.value=!0}})),(e,a)=>{const t=c("el-button"),r=c("router-link"),l=c("el-header"),f=c("el-descriptions-item"),w=c("el-descriptions"),b=c("el-main"),v=c("el-alert"),_=c("el-container");return s(),o(_,{class:"news-view"},{default:n((()=>[d(l,{class:"header"},{default:n((()=>{var e;return[u("div",Qe,[d(r,{to:{name:"News"}},{default:n((()=>[d(t,{type:"primary",icon:p(F),class:"back-button",plain:""},null,8,["icon"])])),_:1}),u("h1",null,m((null==(e=i.value)?void 0:e.title)||"新闻详情"),1)])]})),_:1}),g.value?(s(),o(b,{key:1,class:"error-main"},{default:n((()=>[d(v,{title:"无法加载新闻详情，请稍后重试。",type:"error","show-icon":""}),d(r,{to:{name:"News"}},{default:n((()=>[d(t,{type:"primary",icon:p(F),class:"back-button",plain:""},null,8,["icon"])])),_:1})])),_:1})):(s(),o(b,{key:0},{default:n((()=>[d(w,{column:1,border:"",class:"news-details"},{default:n((()=>[d(f,{label:"发布日期：",class:"fixed-width-column"},{default:n((()=>{var e;return[h(m(p(De)(null==(e=i.value)?void 0:e.publishTime)),1)]})),_:1}),d(f,{label:"内容：",class:"fixed-width-column"},{default:n((()=>{var e;return[u("div",{innerHTML:null==(e=i.value)?void 0:e.content},null,8,Xe)]})),_:1})])),_:1})])),_:1}))])),_:1})}}}),[["__scopeId","data-v-4e4dd6f7"]]),aa={slot:"footer",class:"dialog-footer"},ta=e({__name:"ProjectDialog",props:{isEdit:{type:Boolean},currentProject:{}},emits:["save"],setup(e,{emit:t}){const{projects:r}=ve();let{dialogVisible:l}=M(r);const i=e,g=t,f=a(null),b=a({title:[{required:!0,message:"项目标题不能为空",trigger:"blur"}],status:[{required:!0,message:"请选择项目状态",trigger:"change"}],startDate:[{required:!0,message:"请选择开始日期",trigger:"change"}]}),v=()=>{f.value&&f.value.validate((async e=>{e?g("save",i.currentProject):z.warning("请检查表单填写是否正确")}))},_=()=>{l.value=!1};return(e,a)=>{const t=c("el-input"),r=c("el-form-item"),i=c("el-option"),g=c("el-select"),y=c("el-date-picker"),P=c("el-button"),V=c("el-dialog");return s(),o(V,{title:e.isEdit?"编辑项目":"添加项目",modelValue:p(l),"onUpdate:modelValue":a[7]||(a[7]=e=>w(l)?l.value=e:l=e),onClose:_,"destroy-on-close":"",draggable:"","close-on-click-modal":!1},{default:n((()=>[d(p(E),{model:e.currentProject,rules:b.value,ref_key:"projectForm",ref:f,"label-width":"100px","scroll-to-error":""},{default:n((()=>[d(r,{label:"项目标题",prop:"title"},{default:n((()=>[d(t,{modelValue:e.currentProject.title,"onUpdate:modelValue":a[0]||(a[0]=a=>e.currentProject.title=a),placeholder:"请输入项目标题"},null,8,["modelValue"])])),_:1}),d(r,{label:"项目描述"},{default:n((()=>[d(t,{modelValue:e.currentProject.description,"onUpdate:modelValue":a[1]||(a[1]=a=>e.currentProject.description=a),type:"textarea",placeholder:"请输入项目描述"},null,8,["modelValue"])])),_:1}),d(r,{label:"项目状态",prop:"status"},{default:n((()=>[d(g,{modelValue:e.currentProject.status,"onUpdate:modelValue":a[2]||(a[2]=a=>e.currentProject.status=a),placeholder:"请选择项目状态"},{default:n((()=>[d(i,{label:"未开始",value:"not_started"}),d(i,{label:"进行中",value:"in_progress"}),d(i,{label:"已完成",value:"completed"}),d(i,{label:"已取消",value:"cancelled"})])),_:1},8,["modelValue"])])),_:1}),d(r,{label:"开始日期",prop:"startDate"},{default:n((()=>[d(y,{modelValue:e.currentProject.startDate,"onUpdate:modelValue":a[3]||(a[3]=a=>e.currentProject.startDate=a),type:"date",placeholder:"选择开始日期"},null,8,["modelValue"])])),_:1}),d(r,{label:"结束日期",prop:"endDate"},{default:n((()=>[d(y,{modelValue:e.currentProject.endDate,"onUpdate:modelValue":a[4]||(a[4]=a=>e.currentProject.endDate=a),type:"date",placeholder:"选择结束日期"},null,8,["modelValue"])])),_:1}),d(r,{label:"项目备注"},{default:n((()=>[d(t,{modelValue:e.currentProject.notes,"onUpdate:modelValue":a[5]||(a[5]=a=>e.currentProject.notes=a),type:"textarea",placeholder:"请输入项目备注"},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"]),u("div",aa,[d(P,{onClick:a[6]||(a[6]=e=>w(l)?l.value=!1:l=!1)},{default:n((()=>[h("取消")])),_:1}),d(P,{type:"primary",onClick:v},{default:n((()=>[h(m(e.isEdit?"保存":"添加"),1)])),_:1})])])),_:1},8,["title","modelValue"])}}}),ra={not_started:"info",in_progress:"warning",completed:"success",cancelled:"danger"},la={not_started:"未开始",in_progress:"进行中",completed:"已完成",cancelled:"已取消"},sa={class:"header-content-common"},ia=u("h1",{class:"title-common"},"项目管理",-1),oa=e({__name:"Projects",setup(e){const{projects:r}=ve(),l=a(!1),i=a(1),g=a({id:null,title:"",description:"",status:"",startDate:"",endDate:"",notes:"",createdAt:""}),f=()=>{l.value=!1,g.value={id:null,title:"",description:"",status:"",startDate:"",endDate:"",notes:"",createdAt:""},r.dialogVisible=!0},w=async e=>{l.value?await r.updateProject(e).then((()=>{z.success("项目更新成功"),r.dialogVisible=!1})).catch((e=>{z.error("项目更新失败"+e)})):await r.addProject(e).then((()=>{z.success("项目添加成功"),r.dialogVisible=!1})).catch((e=>{z.error("项目添加失败"+e)}))},v=async e=>{i.value=e,await r.fetchProjects(e).catch((e=>{z.error("加载项目数据失败: "+e)}))};return t((()=>{r.fetchProjects().catch((e=>{z.error("初始化项目数据失败: "+e.message)}))})),(e,a)=>{const t=c("el-icon"),_=c("el-tooltip"),y=c("el-header"),P=c("el-table-column"),V=c("el-tag"),k=c("el-button"),M=c("el-popconfirm"),T=c("el-table"),U=c("el-pagination"),E=c("el-empty"),L=c("el-main"),C=c("el-container");return s(),o(C,{class:"container-common"},{default:n((()=>[d(y,{class:"header-common"},{default:n((()=>[u("div",sa,[ia,d(_,{class:"box-item",effect:"dark",content:"添加项目",placement:"right-start"},{default:n((()=>[d(t,{size:21,class:"add-icon-common",onClick:f},{default:n((()=>[d(p($))])),_:1})])),_:1})])])),_:1}),d(L,null,{default:n((()=>[p(r).projectsList.length?(s(),o(T,{key:0,data:p(r).projectsList,style:{width:"100%"},height:"673",stripe:"",border:"","highlight-current-row":"","show-overflow-tooltip":""},{default:n((()=>[d(P,{fixed:"",label:"序号",width:"60",align:"center","header-align":"center"},{default:n((e=>{return[h(m((a=e.$index,(i.value-1)*r.pageSize+a+1)),1)];var a})),_:1}),d(P,{prop:"title",label:"项目标题","min-width":"200",align:"center","header-align":"center"}),d(P,{prop:"description",label:"项目描述","min-width":"200",align:"center","header-align":"center"},{default:n((e=>[h(m(e.row.description||"暂无描述"),1)])),_:1}),d(P,{prop:"status",label:"项目状态",width:"100",align:"center","header-align":"center"},{default:n((e=>[d(V,{type:p(ra)[e.row.status],"disable-transitions":""},{default:n((()=>[h(m(p(la)[e.row.status]),1)])),_:2},1032,["type"])])),_:1}),d(P,{prop:"createdAt",label:"创建日期",width:"160",align:"center","header-align":"center"},{default:n((e=>[h(m(p(De)(e.row.createdAt)),1)])),_:1}),d(P,{prop:"startDate",label:"开始日期",width:"150",align:"center","header-align":"center"},{default:n((e=>[h(m(p(Ne)(e.row.startDate)),1)])),_:1}),d(P,{prop:"endDate",label:"结束日期",width:"150",align:"center","header-align":"center"},{default:n((e=>[h(m(p(Ne)(e.row.endDate)),1)])),_:1}),d(P,{prop:"notes",label:"备注","min-width":"200",align:"center","header-align":"center"},{default:n((e=>[h(m(e.row.notes||"暂无备注"),1)])),_:1}),d(P,{fixed:"right",label:"操作",width:"135",align:"center","header-align":"center"},{default:n((e=>[d(k,{onClick:a=>{return t=e.row,l.value=!0,g.value={...t},void(r.dialogVisible=!0);var t},type:"primary",size:"small"},{default:n((()=>[h("编辑")])),_:2},1032,["onClick"]),d(M,{"confirm-button-text":"是","cancel-button-text":"否",icon:p(q),"icon-color":"#626AEF",title:"确定删除这个文件嘛？",onConfirm:a=>(async e=>{await r.deleteProject(e).then((()=>{z.success("项目删除成功")})).catch((e=>{z.error("项目删除失败"+e)}))})(e.row.id)},{reference:n((()=>[d(k,{type:"danger",size:"small"},{default:n((()=>[h("删除")])),_:1})])),_:2},1032,["icon","onConfirm"])])),_:1})])),_:1},8,["data"])):b("",!0),p(r).totalProjects>0?(s(),o(U,{key:1,background:"",layout:"total, prev, pager, next",total:p(r).totalProjects,"page-size":p(r).pageSize,"hide-on-single-page":!0,onCurrentChange:v,class:"pagination_common"},null,8,["total","page-size"])):b("",!0),0===p(r).projectsList.length?(s(),o(E,{key:2,style:{height:"673px"},description:"暂无新闻"})):b("",!0)])),_:1}),d(ta,{isEdit:l.value,currentProject:g.value,onSave:w,style:{"min-width":"600px"}},null,8,["isEdit","currentProject"])])),_:1})}}}),na={journal:"期刊",book:"书籍",conference:"会议论文",report:"报告",other:"其他"},ca={slot:"footer",class:"dialog-footer"},da=e({__name:"PublicationDialog",props:{isEdit:{type:Boolean},currentPublication:{}},emits:["save"],setup(e,{emit:t}){const{publications:r}=ve(),{dialogVisible:l}=M(r),g=e,f=t,b=a(null),v=a({title:[{required:!0,message:"出版物标题不能为空",trigger:"blur"}],author:[{required:!0,message:"作者不能为空",trigger:"blur"}],year:[{required:!0,message:"出版年份不能为空",trigger:"blur"}],type:[{required:!0,message:"请选择出版物类型",trigger:"change"}],link:[{required:!0,validator:(e,a,t)=>{a?/^https?:\/\//.test(a)?t():t(new Error("出版物链接必须以http或https开头")):t(new Error("出版物链接不能为空"))},trigger:"blur"}]}),P=()=>{b.value&&b.value.validate((async e=>{e?(g.currentPublication.year instanceof Date&&(g.currentPublication.year=g.currentPublication.year.getFullYear()),f("save",g.currentPublication)):z.warning("请检查表单填写是否正确")}))},V=()=>{l.value=!1};return(e,a)=>{const t=c("el-input"),r=c("el-form-item"),g=c("el-option"),f=c("el-select"),k=c("el-col"),M=c("el-date-picker"),T=c("el-row"),U=c("el-button"),z=c("el-dialog");return s(),o(z,{title:e.isEdit?"编辑出版物":"添加出版物",modelValue:p(l),"onUpdate:modelValue":a[6]||(a[6]=e=>w(l)?l.value=e:null),onClose:V,"destroy-on-close":"",draggable:"","close-on-click-modal":!1},{default:n((()=>[d(p(E),{model:e.currentPublication,rules:v.value,ref_key:"publicationForm",ref:b,"label-width":"100px","scroll-to-error":""},{default:n((()=>[d(r,{label:"出版物标题",prop:"title"},{default:n((()=>[d(t,{modelValue:e.currentPublication.title,"onUpdate:modelValue":a[0]||(a[0]=a=>e.currentPublication.title=a),placeholder:"请输入出版物标题"},null,8,["modelValue"])])),_:1}),d(r,{label:"作者",prop:"author"},{default:n((()=>[d(t,{modelValue:e.currentPublication.author,"onUpdate:modelValue":a[1]||(a[1]=a=>e.currentPublication.author=a),placeholder:"请输入作者"},null,8,["modelValue"])])),_:1}),d(T,{gutter:20},{default:n((()=>[d(k,{span:12},{default:n((()=>[d(r,{label:"类型",prop:"type"},{default:n((()=>[d(f,{modelValue:e.currentPublication.type,"onUpdate:modelValue":a[2]||(a[2]=a=>e.currentPublication.type=a),placeholder:"请选择出版物类型"},{default:n((()=>[(s(!0),i(y,null,_(p(na),((e,a)=>(s(),o(g,{key:a,label:e,value:a},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1}),d(k,{span:12},{default:n((()=>[d(r,{label:"年份",prop:"year"},{default:n((()=>[d(M,{modelValue:e.currentPublication.year,"onUpdate:modelValue":a[3]||(a[3]=a=>e.currentPublication.year=a),type:"year",placeholder:"请选择出版年份"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),d(r,{label:"出版物链接",prop:"link"},{default:n((()=>[d(t,{modelValue:e.currentPublication.link,"onUpdate:modelValue":a[4]||(a[4]=a=>e.currentPublication.link=a),placeholder:"请输入出版物链接"},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"]),u("div",ca,[d(U,{onClick:a[5]||(a[5]=e=>l.value=!1),class:"cancel-button"},{default:n((()=>[h("取消")])),_:1}),d(U,{type:"primary",onClick:P,class:"save-button"},{default:n((()=>[h(m(e.isEdit?"保存":"添加"),1)])),_:1})])])),_:1},8,["title","modelValue"])}}}),ua={class:"header-content-common"},ha=(e=>(g("data-v-0afebfd5"),e=e(),f(),e))((()=>u("h1",{class:"title-common"},"出版物管理",-1))),ma=Q(e({__name:"Publications",setup(e){const{publications:r}=ve(),l=a(!1),i=a(1),g=a({id:null,title:"",author:"",year:"",type:"",link:""}),f=()=>{l.value=!1,g.value={id:null,title:"",author:"",year:"",type:"",link:""},r.dialogVisible=!0},w=async e=>{l.value?await r.updatePublication(e).then((()=>{z.success("出版物更新成功"),r.dialogVisible=!1})).catch((e=>{z.error("出版物更新失败"+e)})):await r.addPublication(e).then((()=>{z.success("出版物添加成功"),r.dialogVisible=!1})).catch((e=>{z.error("出版物添加失败"+e)}))},v=async e=>{i.value=e,await r.fetchPublications(e).catch((e=>{z.error("加载出版物数据失败: "+e)}))};return t((()=>{r.fetchPublications().catch((e=>{z.error("初始化项目数据失败: "+e.message)}))})),(e,a)=>{const t=c("el-icon"),_=c("el-tooltip"),y=c("el-header"),P=c("el-table-column"),V=c("el-link"),k=c("el-button"),M=c("el-popconfirm"),T=c("el-table"),U=c("el-pagination"),E=c("el-empty"),L=c("el-main"),C=c("el-container");return s(),o(C,{class:"container-common"},{default:n((()=>[d(y,{class:"header-common"},{default:n((()=>[u("div",ua,[ha,d(_,{effect:"dark",content:"添加出版物",placement:"right-start"},{default:n((()=>[d(t,{size:21,class:"add-icon-common",onClick:f},{default:n((()=>[d(p($))])),_:1})])),_:1})])])),_:1}),d(L,null,{default:n((()=>[p(r).publicationsList.length?(s(),o(T,{key:0,data:p(r).publicationsList,style:{width:"100%"},height:"673",stripe:"",border:"","highlight-current-row":"","show-overflow-tooltip":""},{default:n((()=>[d(P,{fixed:"",label:"序号",width:"60",align:"center","header-align":"center"},{default:n((e=>{return[h(m((a=e.$index,(i.value-1)*r.pageSize+a+1)),1)];var a})),_:1}),d(P,{prop:"title",label:"标题","min-width":"300",align:"center","header-align":"center"}),d(P,{prop:"author",label:"作者","min-width":"100",align:"center","header-align":"center"}),d(P,{prop:"year",label:"年份",width:"100",align:"center","header-align":"center"},{default:n((e=>[h(m(p(Ie)(e.row.year)),1)])),_:1}),d(P,{prop:"link",label:"连接","min-width":"100",align:"center","header-align":"center"},{default:n((e=>[d(V,{href:e.row.link||"",target:"_blank"},{default:n((()=>[h(m(e.row.link||"无连接"),1)])),_:2},1032,["href"])])),_:1}),d(P,{prop:"type",label:"类型",width:"150",align:"center","header-align":"center"},{default:n((e=>[h(m(p(na)[e.row.type]),1)])),_:1}),d(P,{fixed:"right",label:"操作",width:"135",align:"center","header-align":"center"},{default:n((e=>[d(k,{onClick:a=>{return t=e.row,l.value=!0,g.value={...t},void(r.dialogVisible=!0);var t},type:"primary",size:"small"},{default:n((()=>[h("编辑")])),_:2},1032,["onClick"]),d(M,{"confirm-button-text":"是","cancel-button-text":"否",icon:p(q),"icon-color":"#626AEF",title:"确定删除这个文件嘛？",onConfirm:a=>(async e=>{await r.deletePublication(e).catch((e=>{z.error("删除出版物失败: "+e)}))})(e.row.id)},{reference:n((()=>[d(k,{type:"danger",size:"small"},{default:n((()=>[h("删除")])),_:1})])),_:2},1032,["icon","onConfirm"])])),_:1})])),_:1},8,["data"])):b("",!0),p(r).totalPublications>0?(s(),o(U,{key:1,background:"",layout:"total, prev, pager, next",total:p(r).totalPublications,"page-size":p(r).pageSize,"hide-on-single-page":!0,onCurrentChange:v,class:"pagination_common"},null,8,["total","page-size"])):b("",!0),0===p(r).publicationsList.length?(s(),o(E,{key:2,style:{height:"673px"},description:"暂无出版物"})):b("",!0)])),_:1}),d(da,{isEdit:l.value,currentPublication:g.value,onSave:w,style:{"min-width":"600px"}},null,8,["isEdit","currentPublication"])])),_:1})}}}),[["__scopeId","data-v-0afebfd5"]]);var pa=(e=>(e.DOCUMENT="document",e.IMAGE="image",e.VIDEO="video",e.AUDIO="audio",e.ARCHIVE="archive",e.SOFTWARE="software",e.OTHER="other",e))(pa||{});const ga={document:"文档",image:"图片",video:"视频",audio:"音频",archive:"压缩文件",software:"软件",other:"其他"},fa={pdf:"document",doc:"document",docx:"document",xls:"document",xlsx:"document",txt:"document",rtf:"document",jpg:"image",jpeg:"image",png:"image",gif:"image",mp4:"video",avi:"video",mov:"video",mp3:"audio",wav:"audio",zip:"archive",rar:"archive","7z":"archive",exe:"software",dmg:"software"},wa=(e=>(g("data-v-cc272be3"),e=e(),f(),e))((()=>u("div",{class:"el-upload__tip"},"只能上传 PDF、PPT、DOCX 文件，且不超过 10MB",-1))),ba=Q(e({__name:"FileUpload",emits:["save_filename"],setup(e,{emit:t}){const{upload:r}=ve(),{fileList:l}=M(r),i=a(null),d=t,u=e=>e.size/1024/1024<10?(l.value=[e],!1):(z.error("文件大小不能超过 10MB"),!1),m=e=>{u(e.raw)?d("save_filename",e.raw.name):i.value.clearFiles()},g=e=>{const a=e[0];u(a)&&(i.value.clearFiles(),a.uid=L(),i.value.handleStart(a))},f=()=>{l.value=[]};return(e,a)=>{const t=c("el-button"),r=c("el-upload");return s(),o(r,{ref_key:"uploadRef",ref:i,class:"file-uploader","file-list":p(l),"list-type":"text","auto-upload":!1,"on-remove":f,"on-exceed":g,limit:1,style:{width:"100%"},"on-change":m},{trigger:n((()=>[0===p(l).length?(s(),o(t,{key:0,type:"primary"},{default:n((()=>[h("点击选择文件")])),_:1})):b("",!0),wa])),_:1},8,["file-list"])}}}),[["__scopeId","data-v-cc272be3"]]),va={slot:"footer",class:"dialog-footer"},_a=e({__name:"ResourceDialog",props:{isEdit:{type:Boolean},currentResource:{}},emits:["save"],setup(e,{emit:t}){const{resources:l,upload:g}=ve(),{dialogVisible:f}=M(l),{fileList:b}=M(g),v=e,P=a(!0);r((()=>v.currentResource.url),(e=>{e&&e.startsWith("http")?P.value=!0:P.value=!1}),{immediate:!0});const V=a({title:[{required:!0,message:"资源标题不能为空",trigger:"blur"}],description:[{required:!0,message:"资源描述不能为空",trigger:"blur"}],category:[{required:!0,message:"请选择资源分类",trigger:"change"}],url:[{required:!0,message:"下载链接不能为空",trigger:"blur",when:()=>P.value}]}),k=t,T=a(null),U=()=>{f.value=!1},L=async e=>{const a=e.split("."),t=a.length>1?a[a.length-1].toLowerCase():"";v.currentResource.title=a[0],v.currentResource.category=fa[t]||pa.OTHER},C=async()=>{T.value&&T.value.validate((async e=>{e?!P.value&&g.fileList.length>0?await g.uploadFile(b.value[0]).then((e=>{v.currentResource.url=e,k("save",v.currentResource)})).catch((e=>{z.error("文件上传出错: "+e.message)})):P.value&&k("save",v.currentResource):z.warning("请检查表单填写是否正确")}))};return(e,a)=>{const t=c("el-input"),r=c("el-form-item"),l=c("el-option"),g=c("el-select"),b=c("el-col"),v=c("el-switch"),k=c("el-row"),M=c("el-button"),z=c("el-dialog");return s(),o(z,{title:e.isEdit?"编辑资源":"添加资源",modelValue:p(f),"onUpdate:modelValue":a[6]||(a[6]=e=>w(f)?f.value=e:null),onClose:U,"destroy-on-close":"",draggable:"","close-on-click-modal":!1},{default:n((()=>[d(p(E),{model:e.currentResource,rules:V.value,ref_key:"resourceForm",ref:T,"label-width":"100px","scroll-to-error":""},{default:n((()=>[d(r,{label:"资源标题",prop:"title","show-message":""===e.currentResource.title,"validate-status":""!==e.currentResource.title?"success":"error"},{default:n((()=>[d(t,{modelValue:e.currentResource.title,"onUpdate:modelValue":a[0]||(a[0]=a=>e.currentResource.title=a),placeholder:"请输入资源标题"},null,8,["modelValue"])])),_:1},8,["show-message","validate-status"]),d(r,{label:"描述",prop:"description"},{default:n((()=>[d(t,{modelValue:e.currentResource.description,"onUpdate:modelValue":a[1]||(a[1]=a=>e.currentResource.description=a),placeholder:"请输入资源描述",type:"textarea",rows:3,maxlength:"500","show-word-limit":""},null,8,["modelValue"])])),_:1}),d(k,{gutter:20},{default:n((()=>[d(b,{span:12},{default:n((()=>[d(r,{label:"分类",prop:"category"},{default:n((()=>[d(g,{modelValue:e.currentResource.category,"onUpdate:modelValue":a[2]||(a[2]=a=>e.currentResource.category=a),placeholder:"请选择分类"},{default:n((()=>[(s(!0),i(y,null,_(p(ga),((e,a)=>(s(),o(l,{key:a,label:e,value:a},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1}),d(b,{span:12},{default:n((()=>[d(r,{label:"链接?",prop:"isLink"},{default:n((()=>[d(v,{modelValue:P.value,"onUpdate:modelValue":a[3]||(a[3]=e=>P.value=e),"inline-prompt":"","active-icon":p(N),"inactive-icon":p(I)},null,8,["modelValue","active-icon","inactive-icon"])])),_:1})])),_:1})])),_:1}),P.value?(s(),o(r,{key:0,label:"下载链接",prop:"url"},{default:n((()=>[d(t,{modelValue:e.currentResource.url,"onUpdate:modelValue":a[4]||(a[4]=a=>e.currentResource.url=a),placeholder:"请输入资源下载链接"},null,8,["modelValue"])])),_:1})):(s(),o(r,{key:1,label:"上传资源"},{default:n((()=>[d(ba,{drag:"",onSave_filename:L})])),_:1}))])),_:1},8,["model","rules"]),u("div",va,[d(M,{onClick:a[5]||(a[5]=e=>f.value=!1),class:"cancel-button"},{default:n((()=>[h("取消")])),_:1}),d(M,{type:"primary",onClick:C,class:"save-button"},{default:n((()=>[h(m(e.isEdit?"保存":"添加"),1)])),_:1})])])),_:1},8,["title","modelValue"])}}}),ya={class:"header-content-common"},Pa=(e=>(g("data-v-e5f84924"),e=e(),f(),e))((()=>u("h1",{class:"title-common"},"资源下载管理",-1))),Va=Q(e({__name:"Resources",setup(e){const{resources:r}=ve(),l=a(!1),i=a(1),g=a({id:null,title:"",description:"",url:"",category:"",downloadCount:0}),f=()=>{},w=()=>{l.value=!1,g.value={id:null,title:"",description:"",url:"",category:"",downloadCount:0},r.dialogVisible=!0},v=async e=>{i.value=e,await r.fetchResources(e).catch((e=>{z.error("加载项目数据失败: "+e)}))},_=async e=>{l.value?await r.updateResource(e).then((()=>{z.success("资源更新成功"),r.dialogVisible=!1})).catch((e=>{z.error("资源更新失败"+e)})):await r.addResource(e).then((()=>{z.success("资源添加成功"),r.dialogVisible=!1})).catch((e=>{z.error("资源添加失败"+e)}))};return t((()=>{r.fetchResources().catch((e=>{z.error("初始化资源数据失败: "+e.message)}))})),(e,a)=>{const t=c("el-icon"),y=c("el-tooltip"),P=c("el-header"),V=c("el-table-column"),k=c("el-link"),M=c("el-button"),T=c("el-popconfirm"),U=c("el-table"),E=c("el-pagination"),L=c("el-empty"),C=c("el-main"),S=c("el-container");return s(),o(S,{class:"container-common"},{default:n((()=>[d(P,{class:"header-common"},{default:n((()=>[u("div",ya,[Pa,d(y,{effect:"dark",content:"添加资源",placement:"right-start"},{default:n((()=>[d(t,{size:21,class:"add-icon-common",onClick:w},{default:n((()=>[d(p($))])),_:1})])),_:1})])])),_:1}),d(C,null,{default:n((()=>[p(r).resourcesList.length?(s(),o(U,{key:0,data:p(r).resourcesList,style:{width:"100%"},height:"673",stripe:"",border:"","highlight-current-row":"","show-overflow-tooltip":""},{default:n((()=>[d(V,{fixed:"",label:"序号",width:"60",align:"center","header-align":"center"},{default:n((e=>{return[h(m((a=e.$index,(i.value-1)*r.pageSize+a+1)),1)];var a})),_:1}),d(V,{prop:"title",label:"资源标题","min-width":"250",align:"center","header-align":"center"}),d(V,{prop:"description",label:"描述","min-width":"250",align:"center","header-align":"center"}),d(V,{prop:"category",label:"分类",width:"80",align:"center","header-align":"center"},{default:n((e=>[h(m(p(ga)[e.row.category]),1)])),_:1}),d(V,{prop:"createdAt",label:"创建日期",width:"150",align:"center","header-align":"center"}),d(V,{prop:"url",label:"下载链接",width:"100",align:"center","header-align":"center"},{default:n((e=>[d(k,{onClick:a=>(async(e,a)=>{await fetch(e).then((async e=>{if(!e.ok)return void z.error("文件下载失败");const t=await e.blob(),r=document.createElement("a"),l=URL.createObjectURL(t);r.href=l,r.download=a,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(l),z.success("下载开始")})).catch((e=>{z.error("下载失败: "+e)}))})(e.row.url,e.row.title),target:"_blank"},{default:n((()=>[h("下载")])),_:2},1032,["onClick"])])),_:1}),d(V,{prop:"downloadCount",label:"下载次数",width:"150",align:"center","header-align":"center"}),d(V,{fixed:"right",label:"操作",width:"135",align:"center","header-align":"center"},{default:n((e=>[d(M,{onClick:a=>{return t=e.row,l.value=!0,g.value={...t},void(r.dialogVisible=!0);var t},type:"primary",size:"small"},{default:n((()=>[h("编辑")])),_:2},1032,["onClick"]),d(T,{"confirm-button-text":"是","cancel-button-text":"否",icon:p(q),"icon-color":"#626AEF",title:"确定删除这个文件嘛？",onConfirm:a=>(async e=>{await r.deleteResource(e).then((()=>{z.success("资源删除成功")})).catch((e=>{z.error("资源删除失败"+e)}))})(e.row.id),onCancel:f},{reference:n((()=>[d(M,{type:"danger",size:"small"},{default:n((()=>[h("删除")])),_:1})])),_:2},1032,["icon","onConfirm"])])),_:1})])),_:1},8,["data"])):b("",!0),p(r).totalResources>0?(s(),o(E,{key:1,background:"",layout:"total, prev, pager, next",total:p(r).totalResources,"page-size":p(r).pageSize,"hide-on-single-page":!0,onCurrentChange:v,class:"pagination_common"},null,8,["total","page-size"])):b("",!0),0===p(r).resourcesList.length?(s(),o(L,{key:2,style:{height:"673px"},description:"暂无资源"})):b("",!0)])),_:1}),d(_a,{isEdit:l.value,currentResource:g.value,onSave:_,style:{"min-width":"600px"}},null,8,["isEdit","currentResource"])])),_:1})}}}),[["__scopeId","data-v-e5f84924"]]);var ka=(e=>(e.UNDERGRADUATE="undergraduate",e.GRADUATE="graduate",e.RESEARCHER="researcher",e.PROFESSOR="professor",e.LAB_MANAGER="lab_manager",e.ASSISTANT="assistant",e))(ka||{});const Ma={undergraduate:"本科生",graduate:"研究生",researcher:"研究员",professor:"教授",lab_manager:"实验室经理",assistant:"助理"},Ta={slot:"footer",class:"dialog-footer"},Ua=e({__name:"TeamDialog",props:{isEdit:{type:Boolean},currentMember:{}},emits:["save"],setup(e,{emit:t}){const{teams:r}=ve(),{dialogVisible:l,email_error:g}=M(r),f=e,v=t,V=a(null),k=P({name:[{required:!0,message:"姓名不能为空",trigger:"blur"}],position:[{required:!0,message:"请选择职位",trigger:"change"}],email:[{required:!0,validator:(e,a,t)=>{a?/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,6}$/.test(a)?t():t(new Error("请输入有效的邮箱地址")):t(new Error("邮箱不能为空"))},trigger:"blur"}],enrollmentYear:[{required:!0,message:"入学年份不能为空",trigger:"blur"}],graduationYear:[{required:!1,message:"毕业年份不能为空",trigger:"blur"}],careerPath:[{required:!1,message:"毕业去向不能为空",trigger:"blur"}]}),T=()=>{V.value&&V.value.validate((async e=>{e?(f.currentMember.enrollmentYear instanceof Date&&(f.currentMember.enrollmentYear=f.currentMember.enrollmentYear.getFullYear()),f.currentMember.graduationYear instanceof Date&&(f.currentMember.graduationYear=f.currentMember.graduationYear.getFullYear()),v("save",f.currentMember)):z.warning("请检查表单填写是否正确")}))},U=()=>{l.value=!1,g.value=""};return(e,a)=>{const t=c("el-input"),r=c("el-form-item"),f=c("el-option"),v=c("el-select"),P=c("el-col"),M=c("el-row"),z=c("el-date-picker"),L=c("el-button"),C=c("el-dialog");return s(),o(C,{title:e.isEdit?"编辑团队成员":"添加团队成员",modelValue:p(l),"onUpdate:modelValue":a[9]||(a[9]=e=>w(l)?l.value=e:null),onClose:U,"destroy-on-close":"",draggable:"","close-on-click-modal":!1},{default:n((()=>[d(p(E),{model:e.currentMember,rules:k,ref_key:"teamForm",ref:V,"label-width":"100px","scroll-to-error":""},{default:n((()=>[d(r,{label:"姓名",prop:"name"},{default:n((()=>[d(t,{modelValue:e.currentMember.name,"onUpdate:modelValue":a[0]||(a[0]=a=>e.currentMember.name=a),placeholder:"请输入团队成员姓名"},null,8,["modelValue"])])),_:1}),d(M,{gutter:20},{default:n((()=>[d(P,{span:12},{default:n((()=>[d(r,{label:"职位",prop:"position"},{default:n((()=>[d(v,{modelValue:e.currentMember.position,"onUpdate:modelValue":a[1]||(a[1]=a=>e.currentMember.position=a),placeholder:"请选择团队成员职位"},{default:n((()=>[(s(!0),i(y,null,_(p(Ma),((e,a)=>(s(),o(f,{key:a,label:e,value:a},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1}),d(P,{span:12},{default:n((()=>["undergraduate"!==e.currentMember.position?(s(),o(r,{key:0,required:"undergraduate"!==e.currentMember.position,label:"研究领域",prop:"researchArea",error:"研究领域不能为空"},{default:n((()=>[d(t,{modelValue:e.currentMember.researchArea,"onUpdate:modelValue":a[2]||(a[2]=a=>e.currentMember.researchArea=a),placeholder:"请输入研究领域"},null,8,["modelValue"])])),_:1},8,["required"])):b("",!0)])),_:1})])),_:1}),d(M,{gutter:20},{default:n((()=>[d(P,{span:12},{default:n((()=>[d(r,{label:"入学年份",prop:"enrollmentYear"},{default:n((()=>[d(z,{modelValue:e.currentMember.enrollmentYear,"onUpdate:modelValue":a[3]||(a[3]=a=>e.currentMember.enrollmentYear=a),type:"year",placeholder:"请输入入学年份"},null,8,["modelValue"])])),_:1})])),_:1}),d(P,{span:12},{default:n((()=>[d(r,{label:"毕业年份",prop:"graduationYear"},{default:n((()=>[d(z,{modelValue:e.currentMember.graduationYear,"onUpdate:modelValue":a[4]||(a[4]=a=>e.currentMember.graduationYear=a),type:"year",placeholder:"请输入毕业年份"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),d(r,{label:"毕业去向",prop:"careerPath"},{default:n((()=>[d(t,{modelValue:e.currentMember.careerPath,"onUpdate:modelValue":a[5]||(a[5]=a=>e.currentMember.careerPath=a),placeholder:"请输入毕业去向",type:"textarea"},null,8,["modelValue"])])),_:1}),d(r,{label:"邮箱",prop:"email",error:p(g)},{default:n((()=>[d(t,{modelValue:e.currentMember.email,"onUpdate:modelValue":a[6]||(a[6]=a=>e.currentMember.email=a),placeholder:"请输入团队成员邮箱",type:"email"},null,8,["modelValue"])])),_:1},8,["error"]),d(r,{label:"简介",prop:"description"},{default:n((()=>[d(t,{modelValue:e.currentMember.description,"onUpdate:modelValue":a[7]||(a[7]=a=>e.currentMember.description=a),placeholder:"请输入简介",type:"textarea"},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"]),u("div",Ta,[d(L,{onClick:a[8]||(a[8]=e=>l.value=!1),class:"cancel-button"},{default:n((()=>[h("取消")])),_:1}),d(L,{type:"primary",onClick:T,class:"save-button"},{default:n((()=>[h(m(e.isEdit?"保存":"添加"),1)])),_:1})])])),_:1},8,["title","modelValue"])}}}),Ea={class:"header-content-common"},za=(e=>(g("data-v-179b62cc"),e=e(),f(),e))((()=>u("h1",{class:"title-common"},"团队管理",-1))),La=Q(e({__name:"Team",setup(e){const{teams:r}=ve(),l=a(!1),i=a(1),g=a({id:null,name:"",position:ka.UNDERGRADUATE,email:"",description:"",researchArea:"",enrollmentYear:(new Date).getFullYear().toString(),graduationYear:"",careerPath:""}),f=()=>{l.value=!1,g.value={id:null,name:"",position:ka.UNDERGRADUATE,email:"",description:"",researchArea:"",enrollmentYear:(new Date).getFullYear().toString(),graduationYear:"",careerPath:""},r.dialogVisible=!0},w=async e=>{i.value=e,await r.fetchTeamMembers(e).catch((e=>{z.error("加载项目数据失败: "+e)}))},v=async e=>{l.value?await r.updateTeamMember(e).then((()=>{z.success("成员更新成功"),r.dialogVisible=!1})).catch((e=>{z.error("成员更新失败"+e.message)})):await r.addTeamMember(e).then((()=>{z.success("成员添加成功"),r.dialogVisible=!1})).catch((e=>{e.message.includes("email")&&(r.email_error="邮箱已存在")}))};return t((()=>{r.fetchTeamMembers().catch((e=>{z.error("初始化资源数据失败: "+e.message)}))})),(e,a)=>{const t=c("el-icon"),_=c("el-tooltip"),y=c("el-header"),P=c("el-table-column"),V=c("el-button"),k=c("el-popconfirm"),M=c("el-table"),T=c("el-pagination"),U=c("el-empty"),E=c("el-main"),L=c("el-container");return s(),o(L,{class:"container-common"},{default:n((()=>[d(y,{class:"header-common"},{default:n((()=>[u("div",Ea,[za,d(_,{effect:"dark",content:"添加团队成员",placement:"right-start"},{default:n((()=>[d(t,{size:21,class:"add-icon-common",onClick:f},{default:n((()=>[d(p($))])),_:1})])),_:1})])])),_:1}),d(E,null,{default:n((()=>[p(r).teamMembersList.length?(s(),o(M,{key:0,data:p(r).teamMembersList,style:{width:"100%"},height:"673",stripe:"",border:"","highlight-current-row":"","show-overflow-tooltip":""},{default:n((()=>[d(P,{fixed:"",label:"序号",width:"60",align:"center","header-align":"center"},{default:n((e=>{return[h(m((a=e.$index,(i.value-1)*r.pageSize+a+1)),1)];var a})),_:1}),d(P,{prop:"name",label:"姓名",align:"center",width:"150","header-align":"center"}),d(P,{prop:"position",label:"职位",width:"150",align:"center","header-align":"center"},{default:n((e=>[h(m(p(Ma)[e.row.position]),1)])),_:1}),d(P,{prop:"email",label:"邮箱","min-width":"200",align:"center","header-align":"center"}),d(P,{prop:"researchArea",label:"研究领域","min-width":"300",align:"center","header-align":"center"}),d(P,{prop:"enrollmentYear",label:"入学年份",width:"90",align:"center","header-align":"center"},{default:n((e=>[h(m(p(Ie)(e.row.enrollmentYear)),1)])),_:1}),d(P,{prop:"graduationYear",label:"毕业年份",width:"90",align:"center","header-align":"center"},{default:n((e=>[h(m(p(Ie)(e.row.graduationYear)||"尚未毕业"),1)])),_:1}),d(P,{fixed:"right",label:"操作",width:"200",align:"center","header-align":"center"},{default:n((e=>[d(V,{onClick:a=>{return t=e.row,g.value={...t},void(r.dialogVisible=!0);var t},type:"info",size:"small"},{default:n((()=>[h("查看")])),_:2},1032,["onClick"]),d(V,{onClick:a=>{return t=e.row,l.value=!0,g.value={...t},void(r.dialogVisible=!0);var t},type:"primary",size:"small"},{default:n((()=>[h("编辑")])),_:2},1032,["onClick"]),d(k,{"confirm-button-text":"是","cancel-button-text":"否",icon:p(q),"icon-color":"#626AEF",title:"确定删除该成员嘛？",onConfirm:a=>(async e=>{await r.deleteTeamMember(e).then((()=>{z.success("资源成员删除成功")})).catch((e=>{z.error("资源成员删除失败"+e)}))})(e.row.id)},{reference:n((()=>[d(V,{type:"danger",size:"small"},{default:n((()=>[h("删除")])),_:1})])),_:2},1032,["icon","onConfirm"])])),_:1})])),_:1},8,["data"])):b("",!0),p(r).totalTeamMembers>0?(s(),o(T,{key:1,background:"",layout:"total, prev, pager, next",total:p(r).totalTeamMembers,"page-size":p(r).pageSize,"hide-on-single-page":!0,onCurrentChange:w,class:"pagination_common"},null,8,["total","page-size"])):b("",!0),0===p(r).teamMembersList.length?(s(),o(U,{key:2,style:{height:"673px"},description:"暂无团队成员"})):b("",!0)])),_:1}),d(Ua,{isEdit:l.value,currentMember:g.value,onSave:v},null,8,["isEdit","currentMember"])])),_:1})}}}),[["__scopeId","data-v-179b62cc"]]),Ca={admin:"管理员",member:"普通用户",guest:"访客"},Sa={slot:"footer",class:"dialog-footer"},xa=e({__name:"UserDialog",props:{isEdit:{type:Boolean},currentUser:{}},emits:["save"],setup(e,{emit:t}){const{users:r}=ve(),{dialogVisible:l,email_error:g,username_error:f}=M(r),v=e,P=t,V=a(null),k={username:[{required:!0,message:"用户名不能为空",trigger:"blur"}],email:[{required:!0,validator:(e,a,t)=>{a?/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,6}$/.test(a)?t():t(new Error("请输入有效的邮箱地址")):t(new Error("邮箱不能为空"))},trigger:"blur"}],password:[{required:!v.isEdit,message:"密码不能为空",trigger:"blur"}],role:[{required:!0,message:"请选择角色",trigger:"change"}]},T=()=>{V.value&&V.value.validate((async e=>{e?P("save",v.currentUser):z.warning("请检查表单填写是否正确")}))},U=()=>{l.value=!1,g.value="",f.value=""};return(e,a)=>{const t=c("el-input"),r=c("el-form-item"),v=c("el-option"),P=c("el-select"),M=c("el-button"),z=c("el-dialog");return s(),o(z,{title:e.isEdit?"编辑用户":"添加用户",modelValue:p(l),"onUpdate:modelValue":a[5]||(a[5]=e=>w(l)?l.value=e:null),onClose:U,"destroy-on-close":"",draggable:"","close-on-click-modal":!1},{default:n((()=>[d(p(E),{model:e.currentUser,rules:k,ref_key:"userForm",ref:V,"label-width":"100px","scroll-to-error":""},{default:n((()=>[d(r,{label:"用户名",prop:"username",error:p(f)},{default:n((()=>[d(t,{modelValue:e.currentUser.username,"onUpdate:modelValue":a[0]||(a[0]=a=>e.currentUser.username=a),placeholder:"请输入用户名"},null,8,["modelValue"])])),_:1},8,["error"]),d(r,{label:"邮箱",prop:"email",error:p(g)},{default:n((()=>[d(t,{modelValue:e.currentUser.email,"onUpdate:modelValue":a[1]||(a[1]=a=>e.currentUser.email=a),placeholder:"请输入团队成员邮箱",type:"email"},null,8,["modelValue"])])),_:1},8,["error"]),e.isEdit?b("",!0):(s(),o(r,{key:0,label:"密码",prop:"password"},{default:n((()=>[d(t,{modelValue:e.currentUser.password,"onUpdate:modelValue":a[2]||(a[2]=a=>e.currentUser.password=a),placeholder:"请输入密码",type:"password"},null,8,["modelValue"])])),_:1})),d(r,{label:"角色",prop:"role"},{default:n((()=>[d(P,{modelValue:e.currentUser.role,"onUpdate:modelValue":a[3]||(a[3]=a=>e.currentUser.role=a),placeholder:"请选择角色"},{default:n((()=>[(s(!0),i(y,null,_(p(Ca),((e,a)=>(s(),o(v,{key:a,label:e,value:a},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model"]),u("div",Sa,[d(M,{onClick:a[4]||(a[4]=e=>l.value=!1),class:"cancel-button"},{default:n((()=>[h("取消")])),_:1}),d(M,{type:"primary",onClick:T,class:"save-button"},{default:n((()=>[h(m(e.isEdit?"保存":"添加"),1)])),_:1})])])),_:1},8,["title","modelValue"])}}}),ja={class:"header-content-common"},Ra=(e=>(g("data-v-632a95cc"),e=e(),f(),e))((()=>u("h1",{class:"title-common"},"用户管理",-1))),Aa=Q(e({__name:"Users",setup(e){const{users:r}=ve(),{dialogVisible:l}=M(r),i=a(!1),g=a(!1),f=a(1),w=a({id:null,username:"",password:"",role:""}),v=()=>{i.value=!1,g.value=!1,w.value={id:null,username:"",password:"",role:"",email:""},l.value=!0},_=async e=>{i.value?await r.updateUser(e).then((()=>{z.success("成员更新成功"),r.dialogVisible=!1})).catch((e=>{e.includes("not authorized")?z.error("权限不足"):z.error("成员更新失败"+e.message)})):await r.addUser(e).then((()=>{z.success("成员添加成功"),r.dialogVisible=!1})).catch((e=>{z.error("成员添加失败"+e.message),e.message.includes("email")&&(r.email_error="邮箱已存在"),e.message.includes("username")&&(r.username_error="用户名已存在")}))},y=async e=>{f.value=e,await r.fetchUsers(e).catch((e=>{z.error("加载用户数据失败: "+e)}))};return t((async()=>{await r.fetchUsers().catch((()=>{z.error("获取用户列表失败")}))})),(e,a)=>{const t=c("el-icon"),P=c("el-tooltip"),V=c("el-header"),k=c("el-table-column"),M=c("el-button"),T=c("el-table"),U=c("el-pagination"),E=c("el-empty"),L=c("el-main"),C=c("el-container");return s(),o(C,{class:"container-common"},{default:n((()=>[d(V,{class:"header-common"},{default:n((()=>[u("div",ja,[Ra,d(P,{effect:"dark",content:"添加用户",placement:"right-start"},{default:n((()=>[d(t,{size:21,class:"add-icon-common",onClick:v},{default:n((()=>[d(p($))])),_:1})])),_:1})])])),_:1}),d(L,null,{default:n((()=>[p(r).usersList.length?(s(),o(T,{key:0,data:p(r).usersList,style:{width:"100%"},height:"673",stripe:"",border:"","highlight-current-row":"","show-overflow-tooltip":""},{default:n((()=>[d(k,{fixed:"",label:"序号",width:"60",align:"center","header-align":"center"},{default:n((e=>{return[h(m((a=e.$index,(f.value-1)*r.pageSize+a+1)),1)];var a})),_:1}),d(k,{prop:"username",label:"用户名","min-width":"200",align:"center","header-align":"center"}),d(k,{prop:"role","min-width":"200",label:"角色",width:"150",align:"center","header-align":"center"},{default:n((e=>[h(m(p(Ca)[e.row.role]),1)])),_:1}),d(k,{prop:"email",label:"邮箱","min-width":"200",align:"center","header-align":"center"}),d(k,{prop:"createdAt",label:"创建日期",width:"160",align:"center","header-align":"center"},{default:n((e=>[h(m(p(De)(e.row.createdAt)),1)])),_:1}),d(k,{fixed:"right",label:"操作",width:"140",align:"center","header-align":"center"},{default:n((e=>[d(M,{onClick:a=>{return t=e.row,i.value=!0,g.value=!1,w.value={...t,password:""},void(l.value=!0);var t},type:"primary",size:"small"},{default:n((()=>[h("编辑")])),_:2},1032,["onClick"]),"ADMIN"!==e.row.username.toString().toUpperCase()?(s(),o(M,{key:0,onClick:a=>(async e=>{var a;if("ADMIN"===(null==(a=r.findUserById(e))?void 0:a.username.toUpperCase()))return z.error("管理员不允许删除");await r.deleteUser(e).then((()=>{z.success("用户删除成功")})).catch((e=>{z.error("用户删除失败"+e)}))})(e.row.id),type:"danger",size:"small"},{default:n((()=>[h("删除")])),_:2},1032,["onClick"])):b("",!0)])),_:1})])),_:1},8,["data"])):b("",!0),p(r).totalUsers>0?(s(),o(U,{key:1,background:"",layout:"total, prev, pager, next",total:p(r).totalUsers,"page-size":p(r).pageSize,"hide-on-single-page":!0,"current-page":p(r).currentPage,onCurrentChange:y,class:"pagination_common"},null,8,["total","page-size","current-page"])):b("",!0),0===p(r).usersList.length?(s(),o(E,{key:2,style:{height:"673px"},description:"暂无用户"})):b("",!0)])),_:1}),d(xa,{isEdit:i.value,currentUser:w.value,onSave:_},null,8,["isEdit","currentUser"])])),_:1})}}}),[["__scopeId","data-v-632a95cc"]]),Da=(e=>(g("data-v-84b4de98"),e=e(),f(),e))((()=>u("h1",null,"用户登录",-1))),Na={class:"forgot-password"},Ia=Q(e({__name:"Login",setup(e){const{login:r}=ve(),{isAuthenticated:l}=M(r),i=a({username:"",password:""}),m={username:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]},g=a(null),f=S(),w=a(!1);t((()=>{l.value&&localStorage.getItem("token")&&z.error("登陆信息出错 请重新登录！")}));const b=a({username:"admin",password:"admin",email:"admin@example.com",role:"ADMIN"}),v=()=>{var e;null==(e=g.value)||e.validate((async e=>{e&&(w.value=!0,await r.login({username:i.value.username,password:i.value.password}).then((()=>{l.value=!0,f.push({name:"/"})})).catch((e=>{l.value=!1,z.error("登录失败："+e)})).finally((()=>{w.value=!1})))}))},_=async()=>{await r.addAminCount(b.value).then((()=>{z.warning("忘记密码？")})).catch((e=>{}))};return(e,a)=>{const t=c("el-header"),r=c("el-input"),l=c("el-form-item"),f=c("el-button"),b=c("el-main"),y=c("el-container");return s(),o(y,{class:"login-container"},{default:n((()=>[d(t,{class:"login-header"},{default:n((()=>[Da])),_:1}),d(b,null,{default:n((()=>[d(p(E),{model:i.value,"status-icon":"",rules:m,ref_key:"formRef",ref:g,"label-width":"100px",class:"login-form"},{default:n((()=>[d(l,{label:"用户名",prop:"username"},{default:n((()=>[d(r,{modelValue:i.value.username,"onUpdate:modelValue":a[0]||(a[0]=e=>i.value.username=e),placeholder:"请输入用户名"},null,8,["modelValue"])])),_:1}),d(l,{label:"密码",prop:"password"},{default:n((()=>[d(r,{modelValue:i.value.password,"onUpdate:modelValue":a[1]||(a[1]=e=>i.value.password=e),type:"password",placeholder:"请输入密码"},null,8,["modelValue"])])),_:1}),d(l,null,{default:n((()=>[d(f,{type:"primary",class:"login-button",onClick:v,loading:w.value},{default:n((()=>[h("登录")])),_:1},8,["loading"])])),_:1}),d(l,null,{default:n((()=>[u("span",Na,[h(" 忘记密码? "),d(f,{size:"small",type:"info",round:"",onClick:_},{default:n((()=>[h("点此重置")])),_:1})])])),_:1})])),_:1},8,["model"])])),_:1})])),_:1})}}}),[["__scopeId","data-v-84b4de98"]]),$a={name:"Register",data(){return{form:{username:"",email:"",password:"",confirmPassword:""},rules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:20,message:"用户名长度应在3到20个字符之间",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",message:"请输入有效的邮箱地址",trigger:["blur","change"]}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,message:"密码长度不能少于6个字符",trigger:"blur"}],confirmPassword:[{required:!0,message:"请确认密码",trigger:"blur"},{validator:(e,a,t)=>{a!==this.form.password?t(new Error("两次输入的密码不一致")):t()},trigger:"blur"}]}}},methods:{onSubmit(){this.$refs.form.validate((e=>{if(!e)return!1;D.post("/api/register",this.form).then((()=>{this.$message({type:"success",message:"注册成功"})})).catch((e=>{this.$message({type:"error",message:"注册失败，请重试"})}))}))}}},qa=(e=>(g("data-v-43a28940"),e=e(),f(),e))((()=>u("h1",null,"用户注册",-1)));const Fa=Q($a,[["render",function(e,a,t,r,l,i){const u=c("el-header"),m=c("el-input"),p=c("el-form-item"),g=c("el-button"),f=c("el-form"),w=c("el-main"),b=c("el-container");return s(),o(b,{class:"register"},{default:n((()=>[d(u,null,{default:n((()=>[qa])),_:1}),d(w,null,{default:n((()=>[d(f,{model:l.form,"status-icon":"",rules:l.rules,ref:"form","label-width":"100px"},{default:n((()=>[d(p,{label:"用户名",prop:"username"},{default:n((()=>[d(m,{modelValue:l.form.username,"onUpdate:modelValue":a[0]||(a[0]=e=>l.form.username=e),placeholder:"请输入用户名"},null,8,["modelValue"])])),_:1}),d(p,{label:"邮箱",prop:"email"},{default:n((()=>[d(m,{modelValue:l.form.email,"onUpdate:modelValue":a[1]||(a[1]=e=>l.form.email=e),placeholder:"请输入邮箱"},null,8,["modelValue"])])),_:1}),d(p,{label:"密码",prop:"password"},{default:n((()=>[d(m,{modelValue:l.form.password,"onUpdate:modelValue":a[2]||(a[2]=e=>l.form.password=e),type:"password",placeholder:"请输入密码"},null,8,["modelValue"])])),_:1}),d(p,{label:"确认密码",prop:"confirmPassword"},{default:n((()=>[d(m,{modelValue:l.form.confirmPassword,"onUpdate:modelValue":a[3]||(a[3]=e=>l.form.confirmPassword=e),type:"password",placeholder:"请确认密码"},null,8,["modelValue"])])),_:1}),d(p,null,{default:n((()=>[d(g,{type:"primary",onClick:i.onSubmit},{default:n((()=>[h("注册")])),_:1},8,["onClick"])])),_:1})])),_:1},8,["model","rules"])])),_:1})])),_:1})}],["__scopeId","data-v-43a28940"]]),Ga={name:"ForgotPassword",data:()=>({form:{email:""},rules:{email:[{required:!0,message:"请输入邮箱地址",trigger:"blur"},{type:"email",message:"请输入有效的邮箱地址",trigger:["blur","change"]}]}}),methods:{onSubmit(){this.$refs.form.validate((e=>{if(!e)return!1;D.post("/api/forgot-password",this.form).then((()=>{this.$message({type:"success",message:"重置链接已发送到您的邮箱"})})).catch((e=>{this.$message({type:"error",message:"发送重置链接失败，请检查邮箱地址"})}))}))}}},Ba=(e=>(g("data-v-76337488"),e=e(),f(),e))((()=>u("h1",null,"找回密码",-1)));const Oa=Q(Ga,[["render",function(e,a,t,r,l,i){const u=c("el-header"),m=c("el-input"),p=c("el-form-item"),g=c("el-button"),f=c("el-form"),w=c("el-main"),b=c("el-container");return s(),o(b,{class:"forgot-password"},{default:n((()=>[d(u,null,{default:n((()=>[Ba])),_:1}),d(w,null,{default:n((()=>[d(f,{model:l.form,"status-icon":"",rules:l.rules,ref:"form","label-width":"100px"},{default:n((()=>[d(p,{label:"邮箱",prop:"email"},{default:n((()=>[d(m,{modelValue:l.form.email,"onUpdate:modelValue":a[0]||(a[0]=e=>l.form.email=e),placeholder:"请输入注册邮箱"},null,8,["modelValue"])])),_:1}),d(p,null,{default:n((()=>[d(g,{type:"primary",onClick:i.onSubmit},{default:n((()=>[h("发送重置链接")])),_:1},8,["onClick"])])),_:1})])),_:1},8,["model","rules"])])),_:1})])),_:1})}],["__scopeId","data-v-76337488"]]),Ya={name:"NotFound"},Ha=e=>(g("data-v-85e1e872"),e=e(),f(),e),Wa={class:"error-page"},Za=Ha((()=>u("h1",null,"404",-1))),Ja=Ha((()=>u("p",null,"抱歉！您访问的页面不存在。",-1)));const Ka=Q(Ya,[["render",function(e,a,t,r,l,o){const u=c("router-link");return s(),i("div",Wa,[Za,Ja,d(u,{to:"/"},{default:n((()=>[h("返回首页")])),_:1})])}],["__scopeId","data-v-85e1e872"]]),Qa={name:"ServerError"},Xa=e=>(g("data-v-81b649ce"),e=e(),f(),e),et={class:"error-page"},at=Xa((()=>u("h1",null,"500",-1))),tt=Xa((()=>u("p",null,"抱歉，服务器发生错误。",-1)));const rt=Q(Qa,[["render",function(e,a,t,r,l,o){const u=c("router-link");return s(),i("div",et,[at,tt,d(u,{to:"/"},{default:n((()=>[h("返回首页")])),_:1})])}],["__scopeId","data-v-81b649ce"]]),lt={name:"Forbidden"},st=e=>(g("data-v-8d372cf9"),e=e(),f(),e),it={class:"error-page"},ot=st((()=>u("h1",null,"403",-1))),nt=st((()=>u("p",null,"您无权访问此页面。",-1)));const ct=Q(lt,[["render",function(e,a,t,r,l,o){const u=c("router-link");return s(),i("div",it,[ot,nt,d(u,{to:"/"},{default:n((()=>[h("返回首页")])),_:1})])}],["__scopeId","data-v-8d372cf9"]]),dt={name:"BadRequest"},ut=e=>(g("data-v-6ac85d20"),e=e(),f(),e),ht={class:"error-page"},mt=ut((()=>u("h1",null,"400",-1))),pt=ut((()=>u("p",null,"请求错误，请检查您的输入。",-1)));const gt=Q(dt,[["render",function(e,a,t,r,l,o){const u=c("router-link");return s(),i("div",ht,[mt,pt,d(u,{to:"/"},{default:n((()=>[h("返回首页")])),_:1})])}],["__scopeId","data-v-6ac85d20"]]),ft={name:"Unauthorized"},wt=e=>(g("data-v-428cf9cd"),e=e(),f(),e),bt={class:"error-page"},vt=wt((()=>u("h1",null,"401",-1))),_t=wt((()=>u("p",null,"您未被授权访问此页面。",-1)));const yt=Q(ft,[["render",function(e,a,t,r,l,o){const u=c("router-link");return s(),i("div",bt,[vt,_t,d(u,{to:"/login"},{default:n((()=>[h("登录")])),_:1})])}],["__scopeId","data-v-428cf9cd"]]),Pt={name:"Maintenance"},Vt=e=>(g("data-v-0d76c64f"),e=e(),f(),e),kt={class:"error-page"},Mt=[Vt((()=>u("h1",null,"我们很快回来！",-1))),Vt((()=>u("p",null,"我们的网站目前正在进行维护。",-1))),Vt((()=>u("p",null,"感谢您的耐心等待。",-1)))];const Tt=[{path:"/",component:Re,name:"/",meta:{requiresAuth:!0}},{path:"/messages",component:Ge,name:"Messages",meta:{requiresAuth:!0}},{path:"/news",component:He,name:"News",meta:{requiresAuth:!0}},{path:"/news/add",component:Ke,name:"NewsAdd",meta:{requiresAuth:!0},props:{mode:"add"}},{path:"/news/edit/:id",component:Ke,name:"NewsEdit",meta:{requiresAuth:!0},props:e=>({mode:"edit",id:Number(e.params.id)})},{path:"/news/view/:id",component:ea,name:"NewsView",meta:{requiresAuth:!0},props:e=>({id:Number(e.params.id)})},{path:"/projects",component:oa,name:"Projects",meta:{requiresAuth:!0}},{path:"/publications",component:ma,name:"Publications",meta:{requiresAuth:!0}},{path:"/resources",component:Va,name:"Resources",meta:{requiresAuth:!0}},{path:"/team",component:La,name:"Team",meta:{requiresAuth:!0}},{path:"/users",component:Aa,name:"Users",meta:{requiresAuth:!0}},{path:"/login",component:Ia,name:"Login"},{path:"/register",component:Fa,name:"Register"},{path:"/forgot-password",component:Oa,name:"ForgotPassword"},{path:"/:pathMatch(.*)*",component:Ka,name:"NotFound"},{path:"/500",component:rt,name:"ServerError"},{path:"/403",component:ct,name:"Forbidden"},{path:"/400",component:gt,name:"BadRequest"},{path:"/401",component:yt,name:"Unauthorized"},{path:"/maintenance",component:Q(Pt,[["render",function(e,a,t,r,l,o){return s(),i("div",kt,Mt)}],["__scopeId","data-v-0d76c64f"]]),name:"Maintenance"}],Ut=x({history:j(),routes:Tt});Ut.beforeEach(((e,a,t)=>{const r=e.matched.some((e=>e.meta.requiresAuth)),l=!!localStorage.getItem("authToken");return r&&!l?t({name:"Login"}):"/login"!==e.path&&"/register"!==e.path||!l?void t():t({path:"/"})}));const Et=Ut,zt=e=>(g("data-v-c3026eb5"),e=e(),f(),e),Lt=zt((()=>u("img",{src:"/frontend_vite_dist/assets/AI_IIOT_Lab-logo-BW8oLYvo.png",alt:"Logo",class:"logo"},null,-1))),Ct=zt((()=>u("span",{class:"menu-text"},"主页",-1))),St=zt((()=>u("span",{class:"menu-text"},"新闻",-1))),xt=zt((()=>u("span",{class:"menu-text"},"项目",-1))),jt=zt((()=>u("span",{class:"menu-text"},"出版物",-1))),Rt=zt((()=>u("span",{class:"menu-text"},"资源",-1))),At=zt((()=>u("span",{class:"menu-text"},"团队成员",-1))),Dt=zt((()=>u("span",{class:"menu-text"},"用户",-1))),Nt=zt((()=>u("span",{class:"menu-text"},"留言查看",-1))),It={class:"el-dropdown-link"},$t=Q(e({__name:"Menu",setup(e){const l=S(),i=R(),m=a(""),g=a(!1),f=()=>{const e=i.path;m.value=e.startsWith("/news")?"/news":e.startsWith("/projects")?"/projects":e.startsWith("/publications")?"/publications":e.startsWith("/resources")?"/resources":e.startsWith("/team")?"/team":e.startsWith("/users")?"/users":e.startsWith("/messages")?"/messages":"/"},w=()=>{g.value=window.outerWidth<=1400},b=()=>{ae().clearUserData(),ae().$reset(),l.push({name:"Login"})};return t((()=>{f(),w(),window.addEventListener("resize",w)})),r(i,f),(e,a)=>{const t=c("el-col"),r=c("el-icon"),l=c("el-menu-item"),i=c("el-menu"),f=c("el-dropdown-item"),w=c("el-dropdown-menu"),v=c("el-dropdown"),_=c("el-row");return s(),o(_,{class:"header-row",type:"flex",justify:"space-between",align:"middle"},{default:n((()=>[d(t,{span:3,class:"logo-col"},{default:n((()=>[Lt])),_:1}),d(t,{span:19,class:"menu-col"},{default:n((()=>[d(i,{"default-active":m.value,router:"",class:"el-menu-demo",mode:"horizontal",ellipsis:g.value,overflow:!0},{default:n((()=>[d(l,{index:"/"},{default:n((()=>[d(r,{class:"menu-icon"},{default:n((()=>[d(p(G))])),_:1}),Ct])),_:1}),d(l,{index:"/news"},{default:n((()=>[d(r,{class:"menu-icon"},{default:n((()=>[d(p(B))])),_:1}),St])),_:1}),d(l,{index:"/projects"},{default:n((()=>[d(r,{class:"menu-icon"},{default:n((()=>[d(p(B))])),_:1}),xt])),_:1}),d(l,{index:"/publications"},{default:n((()=>[d(r,{class:"menu-icon"},{default:n((()=>[d(p(O))])),_:1}),jt])),_:1}),d(l,{index:"/resources"},{default:n((()=>[d(r,{class:"menu-icon"},{default:n((()=>[d(p(Y))])),_:1}),Rt])),_:1}),d(l,{index:"/team"},{default:n((()=>[d(r,{class:"menu-icon"},{default:n((()=>[d(p(O))])),_:1}),At])),_:1}),d(l,{index:"/users"},{default:n((()=>[d(r,{class:"menu-icon"},{default:n((()=>[d(p(O))])),_:1}),Dt])),_:1}),d(l,{index:"/messages"},{default:n((()=>[d(r,{class:"menu-icon"},{default:n((()=>[d(p(H))])),_:1}),Nt])),_:1})])),_:1},8,["default-active","ellipsis"])])),_:1}),d(t,{span:2,class:"logo-col"},{default:n((()=>[d(v,null,{dropdown:n((()=>[d(w,null,{default:n((()=>[d(f,{icon:p(W),onClick:b},{default:n((()=>[h("退出登录")])),_:1},8,["icon"])])),_:1})])),default:n((()=>[u("span",It,[h(" 菜单"),d(r,{class:"el-icon--right"},{default:n((()=>[d(p(Z))])),_:1})])])),_:1})])),_:1})])),_:1})}}}),[["__scopeId","data-v-c3026eb5"]]),qt=V(Q(e({__name:"App",setup(e){const{login:a}=ve(),{isAuthenticated:r}=M(a),l=S();return t((()=>{r.value||"/login"===l.currentRoute.value.path||l.push({name:"Login"})})),(e,a)=>{const t=c("el-header"),l=c("router-view"),u=c("el-main"),h=c("el-container");return s(),o(h,{class:"app"},{default:n((()=>[p(r)?(s(),i(y,{key:0},[d(t,null,{default:n((()=>[d($t)])),_:1}),d(u,null,{default:n((()=>[d(l)])),_:1})],64)):(s(),o(u,{key:1},{default:n((()=>[d(l)])),_:1}))])),_:1})}}}),[["__scopeId","data-v-8db316b2"]])),Ft=T();Ft.use(U),qt.use(Et),qt.use(Ft),qt.use(C),qt.mount("#app");
