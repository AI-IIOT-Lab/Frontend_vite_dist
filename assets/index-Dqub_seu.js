import{d as e,b as t,j as a,e as r,B as l,o as s,c as i,ai as o,O as n,P as c,V as u,a as d,T as h,U as m,u as p,E as g,S as f,s as w,a9 as b,F as _,_ as v,au as y}from"./@vue-CrLKbyvS.js";import{d as P,s as V,c as k}from"./pinia-DSMXprM5.js";import{s as M}from"./pinia-plugin-persistedstate-Cs-f0Iqr.js";import{E as T,a as U,g as E,i as L}from"./element-plus-DO-TCPOw.js";import{u as z,c as C,a as S,b as x}from"./vue-router-CmemVqE3.js";import{i as j}from"./echarts-GOmwggSC.js";import{a as R}from"./axios-XtWrBBVz.js";import{o as A,c as D,B as N,i as I,m as $,Q as q,O as F,R as G,S as B,T as O,U as Y,k as H}from"./@element-plus-C9ra6SRE.js";import{T as W,E as Z}from"./@wangeditor-kFGIISjb.js";import"./lodash-es-CjrOehCd.js";import"./@vueuse-BRN6SSo8.js";import"./@popperjs-CpAfbxx4.js";import"./@ctrl-D2oWfImC.js";import"./dayjs-Ck5B1_UM.js";import"./async-validator-Cuo4gI4y.js";import"./memoize-one-Ds0C_khL.js";import"./normalize-wheel-es-CUoAWVRo.js";import"./@floating-ui-PFcfV5ms.js";import"./tslib-DITk-L2-.js";import"./zrender-DEZZK99m.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const a of e)if("childList"===a.type)for(const e of a.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const J=(e,t)=>{const a=e.__vccOpts||e;for(const[r,l]of t)a[r]=l;return a},K=J(e({__name:"LineChart",props:{chartData:{}},setup(e){const o=e,n=t(null);let c=null;const u=()=>{c&&o.chartData&&c.setOption({xAxis:{type:"category",data:o.chartData.labels},yAxis:{type:"value"},series:o.chartData.datasets.map((e=>({name:e.label,type:"line",data:e.data,smooth:!0}))),tooltip:{trigger:"axis"},legend:{data:o.chartData.datasets.map((e=>e.label))}})},d=()=>{c&&c.resize()};return a((()=>{n.value&&(c=j(n.value),u(),window.addEventListener("resize",d))})),r((()=>o.chartData),(()=>{u()}),{deep:!0}),l((()=>{window.removeEventListener("resize",d),c&&c.dispose()})),(e,t)=>(s(),i("div",{ref_key:"chartRef",ref:n,class:"line-chart"},null,512))}}),[["__scopeId","data-v-5c790e80"]]),Q="/auth",X=P("login",{state:()=>({token:localStorage.getItem("authToken")||null,username:null,isAuthenticated:!1}),actions:{async login({username:e,password:t}){return await new Promise(((a,r)=>{te({url:`${Q}/login`,method:"POST",data:{username:e,password:t}}).then((e=>{this.setUserData(e.token,e.username),this.isAuthenticated=!0,a()})).catch((e=>{r(e)}))}))},logout(){return new Promise((e=>{this.clearUserData(),e()}))},async refreshToken(){return await new Promise(((e,t)=>{te({url:`${Q}/refresh-token`,method:"POST",headers:{Authorization:`Bearer ${this.token}`}}).then((t=>{this.setUserData(t.token,t.username),e(t.token)})).catch((e=>{t(e)}))}))},addAminCount:async e=>await new Promise(((t,a)=>{te({url:`${Q}/createAdmin`,method:"POST",data:e}).then((()=>{t()})).catch((e=>a(e)))})),setUserData(e,t){this.token=e,this.username=t,this.isAuthenticated=!0,localStorage.setItem("authToken",e),localStorage.setItem("username",t)},clearUserData(){this.token=null,this.username=null,this.isAuthenticated=!1,localStorage.removeItem("authToken"),localStorage.removeItem("username")}},persist:{key:"login-store",storage:localStorage}}),ee=R.create({baseURL:"/api",timeout:1e4,headers:{"Content-Type":"application/json"}});ee.interceptors.request.use((e=>{const t=localStorage.getItem("authToken");return e.headers={...ee.defaults.headers,...e.headers},t&&e.headers&&(e.headers.Authorization=`Bearer ${t}`),e}),(e=>Promise.reject(e))),ee.interceptors.response.use((e=>new Promise(((t,a)=>{if(200===e.status){const{data:r}=e;200===r.status?t(r):a(r.message)}else t(e)}))),(async e=>new Promise((async(t,a)=>{const r=e.config;if(e.response){const{status:a,data:l}=e.response;401===a&&(l.message&&l.message.includes("令牌已过期")&&!r._retry?(r._retry=!0,await X().refreshToken().then((e=>{r.headers.Authorization=`Bearer ${e}`,t(ee(r))})).catch((e=>{X().clearUserData(),X().$reset(),xt.push({name:"Login"})}))):(X().clearUserData(),X().$reset(),xt.push({name:"Login"})))}a(e.response?e.response.data:e.message)}))));const te=e=>new Promise(((t,a)=>{ee.request(e).then((e=>{t(e.data)})).catch((e=>{a(e)}))})),ae="/latest-updates",re=P("news",{state:()=>({newsList:[],totalNews:0,currentPage:1,cachedNews:[],cacheTimestamp:0,cacheDuration:3e5,pageSize:15,newsGrowth:[]}),getters:{findNewsById:e=>t=>e.newsList.find((e=>e.id===t))},actions:{async fetchNews(e=1){const t=Date.now();t-this.cacheTimestamp>this.cacheDuration&&this.clearCache();const a=(e-1)*this.pageSize,r=e*this.pageSize;if(!(this.cachedNews.length>=r&&this.cachedNews.slice(a,r).length>0))return await new Promise(((a,r)=>{te({url:ae,method:"GET",params:{page:e,size:this.pageSize}}).then((r=>{const{data:l,total:s}=r;l.forEach((e=>{this.cachedNews.some((t=>t.id===e.id))||this.cachedNews.push(e)})),this.totalNews=s,this.cacheTimestamp=t,this.updateNewsList(e),a()})).catch((e=>{r(e)}))}));this.updateNewsList(e)},async fetchNewsById(e){const t=this.findNewsById(e);return t||await new Promise(((t,a)=>{te({url:`${ae}/${e}`,method:"GET"}).then((e=>t(e))).catch((e=>a(e)))}))},async addNews(e){return await new Promise(((t,a)=>{te({url:ae,method:"POST",data:e}).then((e=>{Array.isArray(this.cachedNews)||(this.cachedNews=[],this.cachedNews.push(e),this.totalNews+=1,this.updateNewsList(this.currentPage)),t()})).catch((e=>a(e)))}))},async updateNews(e){return await new Promise(((t,a)=>{te({url:`${ae}/${e.id}`,method:"PUT",data:e}).then((e=>{const a=this.cachedNews.findIndex((t=>t.id===e.id));-1!==a&&(this.cachedNews[a]=e,this.updateNewsList(this.currentPage)),t()})).catch((e=>{a(e)}))}))},async deleteNews(e){return await new Promise(((t,a)=>{te({method:"DELETE",url:`${ae}/${e}`}).then((()=>{this.cachedNews=this.cachedNews.filter((t=>t.id!==e)),this.totalNews-=1,this.updateNewsList(this.currentPage),t()})).catch((e=>{a(e)}))}))},updateNewsList(e){this.newsList=this.cachedNews.slice((e-1)*this.pageSize,e*this.pageSize),this.currentPage=e},async fetchNewsGrowth(){return await new Promise(((e,t)=>{te({url:`${ae}/growth`,method:"GET"}).then((t=>{this.newsGrowth=t,e()})).catch((e=>t(e)))}))},clearCache(){this.cachedNews=[],this.cacheTimestamp=0}},persist:{key:"news-store",storage:sessionStorage}}),le="/research-projects",se=P("projects",{state:()=>({projectsList:[],totalProjects:0,currentPage:1,cachedProjects:[],cacheTimestamp:0,cacheDuration:3e5,pageSize:15,dialogVisible:!1}),getters:{findProjectById:e=>t=>e.projectsList.find((e=>e.id===t))},actions:{async fetchProjects(e=1){const t=Date.now();t-this.cacheTimestamp>this.cacheDuration&&this.clearCache();const a=(e-1)*this.pageSize,r=e*this.pageSize;if(!(this.cachedProjects.length>=r&&this.cachedProjects.slice(a,r).length>0))return await new Promise(((a,r)=>{te({url:le,method:"GET",params:{page:e,size:this.pageSize}}).then((({data:r,total:l})=>{r.forEach((r=>{this.cachedProjects.some((e=>e.id===r.id))||this.cachedProjects.push(r),this.totalProjects=l,this.cacheTimestamp=t,this.updateProjectList(e),a()}))})).catch((e=>{r(e)}))}));this.updateProjectList(e)},async fetchProjectById(e){const t=this.findProjectById(e);return t||await new Promise(((t,a)=>{te({url:`${le}/${e}`,method:"GET"}).then((e=>{t(e)})).catch((e=>{a(e)}))}))},async addProject(e){return await new Promise(((t,a)=>{te({url:le,method:"POST",data:e}).then((e=>{this.cachedProjects.push(e),this.totalProjects+=1,this.updateProjectList(this.currentPage),t()})).catch((e=>{a(e)}))}))},async updateProject(e){return await new Promise(((t,a)=>{te({url:`${le}/${e.id}`,method:"PUT",data:e}).then((e=>{const a=this.cachedProjects.findIndex((t=>t.id===e.id));-1!==a&&(this.cachedProjects[a]=e,this.updateProjectList(this.currentPage)),t()})).catch((e=>{a(e)}))}))},async deleteProject(e){return await new Promise(((t,a)=>{te({url:`${le}/${e}`,method:"DELETE"}).then((()=>{this.cachedProjects=this.cachedProjects.filter((t=>t.id!==e)),this.totalProjects-=1,this.updateProjectList(this.currentPage),t()})).catch((e=>{a(e)}))}))},updateProjectList(e){this.cachedProjects&&0!==this.cachedProjects.length?this.projectsList=this.cachedProjects.slice((e-1)*this.pageSize,e*this.pageSize):this.projectsList=[],this.currentPage=e},clearCache(){this.cachedProjects=[],this.cacheTimestamp=0}},persist:{key:"projects-store",storage:sessionStorage}}),ie="/publications",oe=P("publications",{state:()=>({publicationsList:[],totalPublications:0,currentPage:1,cachedPublications:[],cacheTimestamp:0,cacheDuration:3e5,pageSize:15,dialogVisible:!1,publicationsGrowth:[]}),getters:{findPublicationById:e=>t=>e.publicationsList.find((e=>e.id===t))},actions:{async fetchPublications(e=1){const t=Date.now(),a=(e-1)*this.pageSize,r=e*this.pageSize;if(!(this.cachedPublications.length>=r&&this.cachedPublications.slice(a,r).length>0))return await new Promise(((a,r)=>{te({url:ie,method:"GET",params:{page:e,size:this.pageSize}}).then((({data:r,total:l})=>{r.forEach((e=>{this.cachedPublications.some((t=>t.id===e.id))||this.cachedPublications.push(e)})),this.totalPublications=l,this.cacheTimestamp=t,this.updatePublicationList(e),a()})).catch((e=>{r(e)}))}));this.updatePublicationList(e)},async fetchPublicationById(e){const t=this.findPublicationById(e);return t||await new Promise(((t,a)=>{te({url:`${ie}/${e}`,method:"GET"}).then((e=>t(e))).catch((e=>a(e)))}))},async addPublication(e){return await new Promise(((t,a)=>{te({url:ie,method:"POST",data:e}).then((e=>{this.cachedPublications.push(e),this.totalPublications+=1,this.updatePublicationList(this.currentPage),t()})).catch((e=>a(e)))}))},async updatePublication(e){return await new Promise(((t,a)=>{te({url:`${ie}/${e.id}`,method:"PUT",data:e}).then((e=>{const a=this.cachedPublications.findIndex((t=>t.id===e.id));-1!==a&&(this.cachedPublications[a]=e,this.updatePublicationList(this.currentPage)),t()})).catch((e=>a(e)))}))},async deletePublication(e){return await new Promise(((t,a)=>{te({method:"DELETE",url:`/api/publications/${e}`}).then((()=>{this.cachedPublications=this.cachedPublications.filter((t=>t.id!==e)),this.totalPublications-=1,this.updatePublicationList(this.currentPage),t()})).catch((e=>{a(e)}))}))},updatePublicationList(e){this.publicationsList=this.cachedPublications.slice((e-1)*this.pageSize,e*this.pageSize),this.currentPage=e},async fetchPublicationsGrowth(){return await new Promise(((e,t)=>{te({url:`${ie}/growth`,method:"GET"}).then((t=>{this.publicationsGrowth=t,e()})).catch((e=>t(e)))}))},clearCache(){this.cachedPublications=[],this.cacheTimestamp=0}},persist:{key:"publications-store",storage:sessionStorage}}),ne="/important-links",ce=P("resources",{state:()=>({resourcesList:[],totalResources:0,currentPage:1,cachedResources:[],cacheTimestamp:0,cacheDuration:3e5,pageSize:15,dialogVisible:!1,resourcesGrowth:[]}),getters:{findResourceById:e=>t=>e.resourcesList.find((e=>e.id===t))},actions:{async fetchResources(e=1){const t=Date.now(),a=(e-1)*this.pageSize,r=e*this.pageSize;t-this.cacheTimestamp>this.cacheDuration&&this.clearCache();if(!(this.cachedResources.length>=r&&this.cachedResources.slice(a,r).length>0))return new Promise(((a,r)=>{te({url:ne,method:"GET",params:{page:e,size:this.pageSize}}).then((({data:r,total:l})=>{r.forEach((e=>{this.cachedResources.some((t=>t.id===e.id))||this.cachedResources.push(e)})),this.totalResources=l,this.cacheTimestamp=t,this.updateResourceList(e),a()})).catch((e=>{r(e)}))}));this.updateResourceList(e)},async fetchResourceById(e){const t=this.findResourceById(e);return t||await new Promise(((t,a)=>{te({url:`${ne}/${e}`,method:"GET"}).then((e=>{t(e)})).catch((e=>{a(e)}))}))},async addResource(e){return await new Promise(((t,a)=>{te({url:`${ne}`,method:"POST",data:e}).then((e=>{this.cachedResources.push(e),this.totalResources+=1,this.updateResourceList(this.currentPage),t()})).catch((e=>{a(e)}))}))},async updateResource(e){return await new Promise(((t,a)=>{te({url:`${ne}/${e.id}`,method:"PUT",data:e}).then((e=>{const a=this.cachedResources.findIndex((t=>t.id===e.id));-1!==a&&(this.cachedResources[a]=e,this.updateResourceList(this.currentPage)),t()})).catch((e=>{a(e)}))}))},async deleteResource(e){return await new Promise(((t,a)=>{te({url:`${ne}/${e}`,method:"DELETE"}).then((()=>{this.cachedResources=this.cachedResources.filter((t=>t.id!==e)),this.totalResources-=1,this.updateResourceList(this.currentPage),t()})).catch((e=>{a(e)}))}))},updateResourceList(e){this.cachedResources&&0!==this.cachedResources.length?this.resourcesList=this.cachedResources.slice((e-1)*this.pageSize,e*this.pageSize):this.resourcesList=[],this.currentPage=e},async fechResourcesGrowth(){return await new Promise(((e,t)=>{te({url:`${ne}/growth`,method:"GET"}).then((t=>{this.resourcesGrowth=t,e()})).catch((e=>t(e)))}))},clearCache(){this.cachedResources=[],this.cacheTimestamp=0}},persist:{key:"resources-store",storage:sessionStorage}}),ue=P("fileUpload",{state:()=>({fileList:[]}),getters:{},actions:{uploadFile:async e=>await new Promise(((t,a)=>{const r=new FormData;r.append("file",e),te({url:"/files/upload",method:"POST",headers:{"Content-Type":"multipart/form-data"},data:r,onUploadProgress:e=>{if(e.event){Math.round(100*e.loaded/e.total)}}}).then((e=>{t(e)})).catch((e=>{a(e)}))}))}}),de="/team-members",he=P("team",{state:()=>({teamMembersList:[],totalTeamMembers:0,currentPage:1,cachedTeamMembers:[],cacheTimestamp:0,cacheDuration:3e5,pageSize:15,dialogVisible:!1,email_error:""}),getters:{findTeamMemberById:e=>t=>e.teamMembersList.find((e=>e.id===t))},actions:{async fetchTeamMembers(e=1){const t=Date.now(),a=(e-1)*this.pageSize,r=e*this.pageSize;t-this.cacheTimestamp>this.cacheDuration&&this.clearCache();if(!(this.cachedTeamMembers.length>=r&&this.cachedTeamMembers.slice(a,r).length>0))return await new Promise(((a,r)=>{te({url:de,method:"GET",params:{page:e,size:this.pageSize}}).then((r=>{const{data:l,total:s}=r;l.forEach((e=>{this.cachedTeamMembers.some((t=>t.id===e.id))||this.cachedTeamMembers.push(e)})),this.totalTeamMembers=s,this.cacheTimestamp=t,this.updateTeamMembersList(e),a()})).catch((e=>{r(e)}))}));this.updateTeamMembersList(e)},async fetchTeamMemberById(e){const t=this.findTeamMemberById(e);return t||await new Promise(((t,a)=>{te({url:`${de}/${e}`,method:"GET"}).then((e=>t(e))).catch((e=>a(e)))}))},async addTeamMember(e){return await new Promise(((t,a)=>{te({url:de,method:"POST",data:e}).then((e=>{this.cachedTeamMembers.push(e),this.totalTeamMembers+=1,this.updateTeamMembersList(this.currentPage),t()})).catch((e=>{a(e)}))}))},async updateTeamMember(e){return await new Promise(((t,a)=>{te({url:`${de}/${e.id}`,method:"PUT",data:e}).then((e=>{const a=this.cachedTeamMembers.findIndex((t=>t.id===e.id));-1!==a&&(this.cachedTeamMembers[a]=e,this.updateTeamMembersList(this.currentPage)),t()})).catch((e=>{a(e)}))}))},async deleteTeamMember(e){return await new Promise(((t,a)=>{te({url:`${de}/${e}`,method:"DELETE"}).then((()=>{this.cachedTeamMembers=this.cachedTeamMembers.filter((t=>t.id!==e)),this.totalTeamMembers-=1,this.updateTeamMembersList(this.currentPage),t()})).catch((e=>{a(e)}))}))},updateTeamMembersList(e){this.cachedTeamMembers&&0!==this.cachedTeamMembers.length?this.teamMembersList=this.cachedTeamMembers.slice((e-1)*this.pageSize,e*this.pageSize):this.teamMembersList=[],this.currentPage=e},clearCache(){this.cachedTeamMembers=[],this.cacheTimestamp=0}},persist:{key:"team-store",storage:sessionStorage}}),me="/users",pe=P("users",{state:()=>({usersList:[],totalUsers:0,currentPage:1,cachedUsers:[],cacheTimestamp:0,cacheDuration:3e5,pageSize:15,dialogVisible:!1,usersGrowth:[],email_error:"",username_error:""}),getters:{findUserById:e=>t=>e.usersList.find((e=>e.id===t))},actions:{async fetchUsers(e=1){const t=Date.now(),a=(e-1)*this.pageSize,r=e*this.pageSize;if(!(this.cachedUsers.length>=r&&this.cachedUsers.slice(a,r).length>0))return await new Promise(((a,r)=>{te({url:me,method:"GET",params:{page:e,size:this.pageSize}}).then((r=>{const{data:l,total:s}=r;l.forEach((e=>{this.cachedUsers.some((t=>t.id===e.id))||this.cachedUsers.push(e)})),this.totalUsers=s,this.cacheTimestamp=t,this.updateUserList(e),a()})).catch((e=>{r(e)}))}));this.updateUserList(e)},async fetchUserById(e){const t=this.findUserById(e);return t||await new Promise(((t,a)=>{te({url:`${me}/${e}`,method:"GET"}).then((e=>t(e))).catch((e=>a(e)))}))},async addUser(e){return await new Promise(((t,a)=>{te({url:`${me}`,method:"POST",data:e}).then((e=>{this.cachedUsers.push(e),this.totalUsers+=1,this.updateUserList(this.currentPage),t()})).catch((e=>a(e)))}))},async updateUser(e){return await new Promise(((t,a)=>{te({url:`/users/${e.id}`,method:"PUT",data:e}).then((e=>{const a=this.cachedUsers.findIndex((t=>t.id===e.id));-1!==a&&(this.cachedUsers[a]=e,this.updateUserList(this.currentPage)),t()})).catch((e=>{a(e)}))}))},async deleteUser(e){return await new Promise(((t,a)=>{te({method:"DELETE",url:`/api/users/${e}`}).then((()=>{this.cachedUsers=this.cachedUsers.filter((t=>t.id!==e)),this.totalUsers-=1,this.updateUserList(this.currentPage),t()})).catch((e=>{a(e)}))}))},updateUserList(e){this.usersList=this.cachedUsers.slice((e-1)*this.pageSize,e*this.pageSize),this.currentPage=e},async fetchUserGrowthData(){return await new Promise(((e,t)=>{te({url:`${me}/growth`,method:"GET"}).then((t=>{this.usersGrowth=t,e()})).catch((e=>t(e)))}))},clearCache(){this.cachedUsers=[],this.cacheTimestamp=0}},persist:{key:"users-store",storage:sessionStorage}}),ge="/messages",fe=P("messages",{state:()=>({messagesList:[],totalMessages:0,currentPage:1,cachedMessages:[],cacheTimestamp:0,cacheDuration:3e5,pageSize:15,dialogVisible:!1}),getters:{findMessageById:e=>t=>e.messagesList.find((e=>e.id===t))},actions:{async fetchMessages(e=1){const t=Date.now();t-this.cacheTimestamp>this.cacheDuration&&this.clearCache();const a=(e-1)*this.pageSize,r=e*this.pageSize;if(!(this.cachedMessages.length>=r&&this.cachedMessages.slice(a,r).length>0))return await new Promise(((a,r)=>{te({url:ge,method:"GET",params:{page:e,size:this.pageSize}}).then((r=>{const{data:l,total:s}=r;l.forEach((e=>{this.cachedMessages.some((t=>t.id===e.id))||this.cachedMessages.push(e)})),this.totalMessages=s,this.cacheTimestamp=t,this.updateMessagesList(e),a()})).catch((e=>{r(e)}))}));this.updateMessagesList(e)},async fetchMessageById(e){const t=this.findMessageById(e);return t||await new Promise(((t,a)=>{te({url:`${ge}/${e}`,method:"GET"}).then((e=>t(e))).catch((e=>a(e)))}))},async addMessage(e){return await new Promise(((t,a)=>{te({url:ge,method:"POST",data:e}).then((e=>{Array.isArray(this.cachedMessages)||(this.cachedMessages=[]),this.cachedMessages.push(e),this.totalMessages+=1,this.updateMessagesList(this.currentPage),t()})).catch((e=>a(e)))}))},async updateMessage(e,t){return await new Promise(((a,r)=>{te({url:`${ge}/${e}/is-read`,method:"PUT",data:t}).then((e=>{const t=this.cachedMessages.findIndex((t=>t.id===e.id));-1!==t&&(this.cachedMessages[t]=e,this.updateMessagesList(this.currentPage)),a()})).catch((e=>{r(e)}))}))},async deleteMessage(e){return await new Promise(((t,a)=>{te({method:"DELETE",url:`${ge}/${e}`}).then((()=>{this.cachedMessages=this.cachedMessages.filter((t=>t.id!==e)),this.totalMessages-=1,this.updateMessagesList(this.currentPage),t()})).catch((e=>{a(e)}))}))},updateMessagesList(e){this.messagesList=this.cachedMessages.slice((e-1)*this.pageSize,e*this.pageSize),this.currentPage=e},clearCache(){this.cachedMessages=[],this.cacheTimestamp=0}},persist:{key:"messages-store",storage:sessionStorage}}),we=()=>({news:re(),projects:se(),publications:oe(),resources:ce(),upload:ue(),teams:he(),users:pe(),messages:fe(),login:X()}),be={slot:"header",class:"card-header"},_e={class:"card-value"},ve={slot:"header",class:"card-header"},ye={class:"card-value"},Pe={slot:"header",class:"card-header"},Ve={class:"card-value"},ke={slot:"header",class:"card-header"},Me={class:"card-value"},Te={slot:"header",class:"card-header"},Ue={class:"card-value ellipsis"},Ee={slot:"header",class:"card-header"},Le={class:"card-value"},ze={slot:"header",class:"card-header"},Ce={class:"card-value"},Se=J(e({__name:"Dashboard",setup(e){const{news:r,users:l,projects:i,publications:g,resources:f,teams:w,messages:b,login:_}=we(),{totalNews:v,newsGrowth:y}=V(r),{totalProjects:P}=V(i),{totalPublications:k,publicationsGrowth:M}=V(g),{totalResources:T,resourcesGrowth:U}=V(f),{totalTeamMembers:E}=V(w),{totalUsers:L,usersGrowth:z}=V(l),{totalMessages:C}=V(b),{isAuthenticated:S}=V(_),x=t({labels:[],datasets:[{label:"新闻数量变化折线图",data:[],fill:!1,borderColor:"#409EFF",tension:.1}]}),j=t({labels:[],datasets:[{label:"出版物变化折线图",data:[],fill:!1,borderColor:"#409EFF",tension:.1}]}),R=t({labels:[],datasets:[{label:"资源变化折线图",data:[],fill:!1,borderColor:"#409EFF",tension:.1}]}),A=t({labels:[],datasets:[{label:"用户变化折线图",data:[],fill:!1,borderColor:"#409EFF",tension:.1}]}),D=t(!0);return a((()=>{(async()=>{try{await r.fetchNews(),await r.fetchNewsGrowth().then((()=>{x.value.labels=y.value.map((e=>e.month)),x.value.datasets[0].data=y.value.map((e=>e.data))})),await l.fetchUsers(),await l.fetchUserGrowthData().then((()=>{A.value.labels=z.value.map((e=>e.month)),A.value.datasets[0].data=z.value.map((e=>e.data))})),await i.fetchProjects(),await g.fetchPublications(),await g.fetchPublicationsGrowth().then((()=>{j.value.labels=M.value.map((e=>e.month)),j.value.datasets[0].data=M.value.map((e=>e.data))})),await f.fetchResources(),await f.fechResourcesGrowth().then((()=>{R.value.labels=U.value.map((e=>e.month)),R.value.datasets[0].data=U.value.map((e=>e.data))})),await w.fetchTeamMembers(),await b.fetchMessages(),D.value=!1}catch(e){e.messages&&e.messages.includes("JWT verification failed")&&(S.value=!1,xt.push({name:"Login"}))}})()})),(e,t)=>{const a=o("router-link"),r=o("el-card"),l=o("el-col"),i=o("el-row"),g=o("el-main"),f=o("el-container");return D.value?(s(),n(f,{key:1,class:"dashboard"},{default:c((()=>[u(g,null,{default:c((()=>[u(i,{class:"stats-row"},{default:c((()=>[u(l,null,{default:c((()=>[u(r,{shadow:"hover"},{default:c((()=>t[7]||(t[7]=[d("p",null,"加载中...",-1)]))),_:1})])),_:1})])),_:1})])),_:1})])),_:1})):(s(),n(f,{key:0,class:"dashboard"},{default:c((()=>[u(g,null,{default:c((()=>[u(i,{gutter:20,class:"stats-row"},{default:c((()=>[u(l,{span:6},{default:c((()=>[u(r,{shadow:"hover"},{default:c((()=>[d("div",be,[u(a,{to:"/news"},{default:c((()=>t[0]||(t[0]=[h("新闻数量")]))),_:1})]),d("p",_e,m(p(v)),1)])),_:1})])),_:1}),u(l,{span:6},{default:c((()=>[u(r,{shadow:"hover"},{default:c((()=>[d("div",ve,[u(a,{to:"/projects"},{default:c((()=>t[1]||(t[1]=[h("项目数量")]))),_:1})]),d("p",ye,m(p(P)),1)])),_:1})])),_:1}),u(l,{span:6},{default:c((()=>[u(r,{shadow:"hover"},{default:c((()=>[d("div",Pe,[u(a,{to:"/publications"},{default:c((()=>t[2]||(t[2]=[h("出版物总数")]))),_:1})]),d("p",Ve,m(p(k)),1)])),_:1})])),_:1}),u(l,{span:6},{default:c((()=>[u(r,{shadow:"hover"},{default:c((()=>[d("div",ke,[u(a,{to:"/resources"},{default:c((()=>t[3]||(t[3]=[h("资源数量")]))),_:1})]),d("p",Me,m(p(T)),1)])),_:1})])),_:1})])),_:1}),u(i,{gutter:20,class:"stats-row",style:{"margin-top":"20px"}},{default:c((()=>[u(l,{span:6},{default:c((()=>[u(r,{shadow:"hover"},{default:c((()=>[d("div",Te,[u(a,{to:"/team"},{default:c((()=>t[4]||(t[4]=[h("团队成员数量")]))),_:1})]),d("p",Ue,m(p(E)),1)])),_:1})])),_:1}),u(l,{span:6},{default:c((()=>[u(r,{shadow:"hover"},{default:c((()=>[d("div",Ee,[u(a,{to:"/users"},{default:c((()=>t[5]||(t[5]=[h("用户总数")]))),_:1})]),d("p",Le,m(p(L)),1)])),_:1})])),_:1}),u(l,{span:6},{default:c((()=>[u(r,{shadow:"hover"},{default:c((()=>[d("div",ze,[u(a,{to:"/messages"},{default:c((()=>t[6]||(t[6]=[h("留言总数")]))),_:1})]),d("p",Ce,m(p(C)),1)])),_:1})])),_:1})])),_:1}),u(i,{gutter:20,style:{"margin-top":"20px"}},{default:c((()=>[u(l,{span:12},{default:c((()=>[u(r,{shadow:"hover"},{default:c((()=>[u(K,{"chart-data":x.value},null,8,["chart-data"])])),_:1})])),_:1}),u(l,{span:12},{default:c((()=>[u(r,{shadow:"hover"},{default:c((()=>[u(K,{"chart-data":j.value},null,8,["chart-data"])])),_:1})])),_:1})])),_:1}),u(i,{gutter:20,style:{"margin-top":"20px"}},{default:c((()=>[u(l,{span:12},{default:c((()=>[u(r,{shadow:"hover"},{default:c((()=>[u(K,{"chart-data":R.value},null,8,["chart-data"])])),_:1})])),_:1}),u(l,{span:12},{default:c((()=>[u(r,{shadow:"hover"},{default:c((()=>[u(K,{"chart-data":A.value},null,8,["chart-data"])])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}))}}}),[["__scopeId","data-v-caad31bf"]]),xe=(e,t)=>{if(!e)return"无日期";try{return new Intl.DateTimeFormat("zh-CN",{...t,timeZone:"Asia/Shanghai"}).format(new Date(e))}catch(a){return e}},je=e=>xe(e,{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",hour12:!1}).replace(/\//g,"-"),Re=e=>xe(e,{year:"numeric",month:"2-digit",day:"2-digit"}).replace(/\//g,"-"),Ae=e=>{if(!e)return NaN;try{if(/^\d{4}$/.test(e))return parseInt(e,10);return new Date(e).getFullYear()}catch(t){return 1900}},De={slot:"footer",class:"dialog-footer"},Ne=e({__name:"MessageDialog",props:{isEdit:{type:Boolean},currentMessage:{}},emits:["save"],setup(e,{emit:a}){const{messages:r}=we();let{dialogVisible:l}=V(r);const i=e,f=a,w=t(null),b=t({name:[{required:!0,message:"姓名不能为空",trigger:"blur"}],email:[{required:!0,type:"email",message:"请输入正确的邮箱地址",trigger:"blur"}],message:[{required:!0,message:"留言内容不能为空",trigger:"blur"}]}),_=()=>{w.value&&w.value.validate((async e=>{e?f("save",i.currentMessage):U.warning("请检查表单填写是否正确")}))},v=()=>{l.value=!1};return(e,t)=>{const a=o("el-input"),r=o("el-form-item"),i=o("el-switch"),f=o("el-button"),y=o("el-dialog");return s(),n(y,{title:e.isEdit?"编辑留言":"添加留言",modelValue:p(l),"onUpdate:modelValue":t[6]||(t[6]=e=>g(l)?l.value=e:l=e),onClose:v,"destroy-on-close":"",draggable:"","close-on-click-modal":!1},{default:c((()=>[u(p(T),{model:e.currentMessage,rules:b.value,ref_key:"messageForm",ref:w,"label-width":"100px","scroll-to-error":""},{default:c((()=>[u(r,{label:"姓名",prop:"name",readonly:""},{default:c((()=>[u(a,{modelValue:e.currentMessage.name,"onUpdate:modelValue":t[0]||(t[0]=t=>e.currentMessage.name=t),placeholder:"请输入留言者姓名",readonly:""},null,8,["modelValue"])])),_:1}),u(r,{label:"电子邮件",prop:"email"},{default:c((()=>[u(a,{modelValue:e.currentMessage.email,"onUpdate:modelValue":t[1]||(t[1]=t=>e.currentMessage.email=t),placeholder:"请输入留言者邮箱",readonly:""},null,8,["modelValue"])])),_:1}),u(r,{label:"留言内容",prop:"message"},{default:c((()=>[u(a,{modelValue:e.currentMessage.message,"onUpdate:modelValue":t[2]||(t[2]=t=>e.currentMessage.message=t),type:"textarea",placeholder:"请输入留言内容",readonly:""},null,8,["modelValue"])])),_:1}),u(r,{label:"IP 地址"},{default:c((()=>[u(a,{modelValue:e.currentMessage.ipAddress,"onUpdate:modelValue":t[3]||(t[3]=t=>e.currentMessage.ipAddress=t),placeholder:"请输入IP地址",readonly:""},null,8,["modelValue"])])),_:1}),u(r,{label:"是否已读"},{default:c((()=>[u(i,{modelValue:e.currentMessage.isRead,"onUpdate:modelValue":t[4]||(t[4]=t=>e.currentMessage.isRead=t),"active-icon":p(A),"inactive-icon":p(D),"inline-prompt":""},null,8,["modelValue","active-icon","inactive-icon"])])),_:1})])),_:1},8,["model","rules"]),d("div",De,[u(f,{onClick:t[5]||(t[5]=e=>g(l)?l.value=!1:l=!1)},{default:c((()=>t[7]||(t[7]=[h("取消")]))),_:1}),u(f,{type:"primary",onClick:_},{default:c((()=>[h(m(e.isEdit?"保存":"添加"),1)])),_:1})])])),_:1},8,["title","modelValue"])}}}),Ie=J(e({__name:"Messages",setup(e){const{messages:r}=we(),l=t(!1),i=t(1),g=t({createdAt:"",email:"",id:99999,ipAddress:"",isRead:!1,message:"",name:""}),w=async e=>{l.value?("无"===e.ipAddress&&(e.ipAddress=""),await r.updateMessage(e.id,e.isRead).then((()=>{U.success("留言更新成功"),r.dialogVisible=!1})).catch((e=>{U.error("留言更新失败: "+e)}))):await r.addMessage(e).then((()=>{U.success("留言添加成功"),r.dialogVisible=!1})).catch((e=>{U.error("留言添加失败: "+e)}))},b=e=>{i.value=e,r.fetchMessages(e)};return a((()=>{r.fetchMessages(i.value).catch((e=>{U.error("获取留言失败: "+e)}))})),(e,t)=>{const a=o("el-header"),_=o("el-table-column"),v=o("el-tag"),y=o("el-button"),P=o("el-table"),V=o("el-pagination"),k=o("el-empty"),M=o("el-main"),T=o("el-container");return s(),n(T,{class:"container-common"},{default:c((()=>[u(a,{class:"header-common"},{default:c((()=>t[0]||(t[0]=[d("div",{class:"header-content-common"},[d("h1",{class:"title-common"},"留言管理")],-1)]))),_:1}),u(M,null,{default:c((()=>[p(r).messagesList.length?(s(),n(P,{key:0,data:p(r).messagesList,style:{width:"100%"},height:"673",stripe:"",border:"","highlight-current-row":"","show-overflow-tooltip":""},{default:c((()=>[u(_,{fixed:"",label:"序号",width:"60",align:"center","header-align":"center"},{default:c((e=>{return[h(m((t=e.$index,(i.value-1)*r.pageSize+t+1)),1)];var t})),_:1}),u(_,{prop:"name",label:"姓名",width:"150",align:"center"}),u(_,{prop:"email",label:"邮箱","min-width":"200",align:"center"}),u(_,{prop:"message",label:"留言内容","min-width":"300",align:"center"}),u(_,{prop:"ipAddress",label:"IP 地址","min-width":"150",align:"center"}),u(_,{prop:"isRead",label:"是否已读",width:"90",align:"center"},{default:c((e=>[u(v,{type:e.row.isRead?"success":"danger"},{default:c((()=>[h(m(e.row.isRead?"已读":"未读"),1)])),_:2},1032,["type"])])),_:1}),u(_,{prop:"createdAt",label:"提交时间",width:"160",align:"center"},{default:c((e=>[h(m(p(je)(e.row.createdAt)),1)])),_:1}),u(_,{fixed:"right",label:"操作",width:"140",align:"center","header-align":"center"},{default:c((e=>[u(y,{onClick:t=>{return a=e.row,l.value=!0,a.ipAddress=a.ipAddress||"无",g.value={...a},void(r.dialogVisible=!0);var a},type:"primary",size:"small"},{default:c((()=>t[1]||(t[1]=[h("编辑")]))),_:2},1032,["onClick"]),u(y,{onClick:t=>(async e=>{await r.deleteMessage(e).then((()=>{U.success("删除成功"),r.fetchMessages(i.value)})).catch((e=>{U.error("删除失败: "+e)}))})(e.row.id),type:"danger",size:"small"},{default:c((()=>t[2]||(t[2]=[h("删除")]))),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"])):f("",!0),p(r).totalMessages>0?(s(),n(V,{key:1,background:"",layout:"total, prev, pager, next",total:p(r).totalMessages,"page-size":p(r).pageSize,onCurrentChange:b,class:"pagination_common"},null,8,["total","page-size"])):f("",!0),0===p(r).totalMessages?(s(),n(k,{key:2,style:{height:"673px"},description:"暂无留言"})):f("",!0)])),_:1}),u(Ne,{isEdit:l.value,currentMessage:g.value,onSave:w},null,8,["isEdit","currentMessage"])])),_:1})}}}),[["__scopeId","data-v-70c955c8"]]),$e={class:"header-content-common"},qe={class:"operation-buttons"},Fe=J(e({__name:"NewsList",setup(e){const{news:r}=we(),l=t(1),i=async e=>{l.value=e,await r.fetchNews(e).catch((e=>{U.error("加载新闻数据失败: "+e.message)}))};return a((()=>{r.fetchNews().catch((e=>{U.error("初始化新闻数据失败: "+e.message)}))})),(e,t)=>{const a=o("el-icon"),g=o("router-link"),w=o("el-tooltip"),b=o("el-header"),_=o("el-table-column"),v=o("el-button"),y=o("el-popconfirm"),P=o("el-table"),V=o("el-pagination"),k=o("el-empty"),M=o("el-main"),T=o("el-container");return s(),n(T,{class:"container-common"},{default:c((()=>[u(b,{class:"header-common"},{default:c((()=>[d("div",$e,[t[0]||(t[0]=d("h1",{class:"title-common"},"新闻与活动管理",-1)),u(w,{effect:"dark",content:"添加新闻",placement:"right-start"},{default:c((()=>[u(g,{to:{name:"NewsAdd"}},{default:c((()=>[u(a,{size:21,class:"add-icon-common"},{default:c((()=>[u(p(N))])),_:1})])),_:1})])),_:1})])])),_:1}),u(M,null,{default:c((()=>[p(r).newsList.length?(s(),n(P,{key:0,data:p(r).newsList,style:{width:"100%"},height:"673",stripe:"",border:"","highlight-current-row":"","show-overflow-tooltip":""},{default:c((()=>[u(_,{fixed:"",label:"序号",width:"60",align:"center","header-align":"center"},{default:c((e=>{return[h(m((t=e.$index,(l.value-1)*r.pageSize+t+1)),1)];var t})),_:1}),u(_,{prop:"title",label:"新闻标题",align:"center","min-width":"600","header-align":"center"}),u(_,{prop:"createdAt",label:"创建日期","min-width":"160",align:"center","header-align":"center"},{default:c((e=>[h(m(p(je)(e.row.createdAt)),1)])),_:1}),u(_,{prop:"publishTime",label:"发布日期","min-width":"160",align:"center","header-align":"center"},{default:c((e=>[h(m(p(je)(e.row.publishTime)),1)])),_:1}),u(_,{fixed:"right",label:"操作",width:"180",align:"center","header-align":"center"},{default:c((e=>[d("div",qe,[u(g,{to:{name:"NewsView",params:{id:e.row.id}}},{default:c((()=>[u(v,{type:"info",size:"small"},{default:c((()=>t[1]||(t[1]=[h("查看")]))),_:1})])),_:2},1032,["to"]),u(g,{to:{name:"NewsEdit",params:{id:e.row.id}}},{default:c((()=>[u(v,{type:"primary",size:"small"},{default:c((()=>t[2]||(t[2]=[h("编辑")]))),_:1})])),_:2},1032,["to"]),u(y,{"confirm-button-text":"是","cancel-button-text":"否",icon:p(I),"icon-color":"#626AEF",title:"确定删除这个文件嘛？",onConfirm:t=>(async e=>{await r.deleteNews(e).then((()=>{U.success("删除成功")})).catch((e=>{U.error("删除新闻失败: "+e.message)}))})(e.row.id)},{reference:c((()=>[u(v,{type:"danger",size:"small"},{default:c((()=>t[3]||(t[3]=[h("删除")]))),_:1})])),_:2},1032,["icon","onConfirm"])])])),_:1})])),_:1},8,["data"])):f("",!0),p(r).totalNews>0?(s(),n(V,{key:1,background:"",layout:"total, prev, pager, next",total:p(r).totalNews,"page-size":p(r).pageSize,"hide-on-single-page":!0,onCurrentChange:i,class:"pagination_common"},null,8,["total","page-size"])):f("",!0),0===p(r).newsList.length?(s(),n(k,{key:2,style:{height:"673px"},description:"暂无新闻"})):f("",!0)])),_:1})])),_:1})}}}),[["__scopeId","data-v-fe2231bc"]]),Ge={class:"header-content"},Be={class:"inline-form-item"},Oe={style:{border:"1px solid #ccc","min-height":"300px",width:"100%","text-align":"start"}},Ye=J(e({__name:"NewsEdit",props:{id:{},mode:{}},setup(e){const r=w(),i=t(""),g=t({}),f=t("default"),b=e=>{r.value=e,"edit"===v.mode&&k.value.content&&e.setHtml(k.value.content)},_=e=>{k.value.content=e.getHtml()};l((()=>{const e=r.value;null!=e&&e.destroy()}));const v=e,y=z(),{news:P,upload:V}=we(),k=t({id:null,title:"",content:"",publishTime:"",createdAt:""}),M=t(null),L={title:[{required:!0,message:"请输入新闻标题",trigger:"blur"}],content:[{required:!0,message:"请输入新闻内容",trigger:"blur"}],publishTime:[{required:!0,message:"请选择发布日期",trigger:"change"},{validator:(e,t,a)=>{new Date(t)<=new Date&&"add"===v.mode?a(new Error("发布日期必须在当前日期之后")):a()},trigger:"change"}]};a((()=>{var e;if("edit"===v.mode&&v.id){const t=P.findNewsById(v.id);t?(k.value=t,i.value=t.content,null==(e=r.value)||e.setHtml(t.content)):(U.error("未找到对应的新闻"),y.push({name:"News"}))}}));const C=t({placeholder:"输入新闻内容...",MENU_CONF:{uploadImage:{server:"/api/files/upload",fieldName:"image",headers:{Authorization:`Bearer ${localStorage.getItem("authToken")}`},maxFileSize:2097152,maxNumberOfFiles:5,allowedFileTypes:["image/jpeg","image/png"],customInsert(e,t){t(e.data,"",e.data)},async customUpload(e,t){Object.defineProperty(e,"uid",{value:E(),writable:!0,enumerable:!0,configurable:!0}),await V.uploadFile(e).then((e=>{t(e,"",e)})).catch((e=>{U.error("图片上传失败"+e)}))},onSuccess(e,t){U.success("图片上传成功")},onFailed(e,t){U.error("图片上传失败")},onError(e,t,a){U.error("图片上传出错")}}}}),S=()=>{y.push({name:"News"})},x=()=>{var e;null==(e=M.value)||e.validate((async e=>{e&&("add"===v.mode?await P.addNews({...k.value}).then((()=>{U.success("新闻添加成功"),y.push({name:"News"})})).catch((e=>{U.error("新闻添加失败："+e.message)})):await P.updateNews(k.value).then((()=>{U.success("新闻更新成功"),y.push({name:"News"})})).catch((e=>{U.error("新闻更新失败："+e.message)})))}))};return(e,t)=>{const a=o("el-button"),l=o("router-link"),w=o("el-header"),v=o("el-input"),y=o("el-form-item"),P=o("el-date-picker"),V=o("el-main"),U=o("el-container");return s(),n(U,{class:"news-edit"},{default:c((()=>[u(w,{class:"header"},{default:c((()=>{var t;return[d("div",Ge,[u(l,{to:{name:"News"}},{default:c((()=>[u(a,{type:"primary",icon:p($),class:"back-button",plain:""},null,8,["icon"])])),_:1}),d("h1",null,m("add"===e.mode?"添加新闻":`编辑 ${(null==(t=k.value)?void 0:t.title)||"新闻"}`),1)])]})),_:1}),u(V,null,{default:c((()=>[u(p(T),{model:k.value,rules:L,ref_key:"newsForm",ref:M,"label-width":"100px"},{default:c((()=>[u(y,{label:"新闻标题",prop:"title"},{default:c((()=>[u(v,{modelValue:k.value.title,"onUpdate:modelValue":t[0]||(t[0]=e=>k.value.title=e),placeholder:"请输入新闻标题"},null,8,["modelValue"])])),_:1}),d("div",Be,[u(y,{label:"发布日期",prop:"publishTime"},{default:c((()=>[u(P,{modelValue:k.value.publishTime,"onUpdate:modelValue":t[1]||(t[1]=e=>k.value.publishTime=e),type:"datetime",placeholder:"选择发布日期和时间","value-format":"YYYY-MM-DD HH:mm",format:"YYYY-MM-DD HH:mm"},null,8,["modelValue"])])),_:1}),d("div",null,[u(a,{onClick:S,class:"action-button"},{default:c((()=>t[3]||(t[3]=[h("取消")]))),_:1}),u(a,{type:"primary",onClick:x,class:"action-button"},{default:c((()=>[h(m("add"===e.mode?"添加":"保存"),1)])),_:1})])]),u(y,{label:"新闻内容",prop:"content"},{default:c((()=>[d("div",Oe,[u(p(W),{style:{"border-bottom":"1px solid #ccc"},editor:r.value,defaultConfig:g.value,mode:f.value},null,8,["editor","defaultConfig","mode"]),u(p(Z),{style:{height:"555px",width:"100%","overflow-y":"hidden"},modelValue:i.value,"onUpdate:modelValue":t[2]||(t[2]=e=>i.value=e),defaultConfig:C.value,mode:f.value,onOnCreated:b,onOnChange:_},null,8,["modelValue","defaultConfig","mode"])])])),_:1})])),_:1},8,["model"])])),_:1})])),_:1})}}}),[["__scopeId","data-v-0bd9831c"]]),He={class:"header-content"},We=["innerHTML"],Ze=J(e({__name:"NewsView",props:{id:{}},setup(e){const r=e;z();const{news:l}=we(),i=t(null),g=t(!1);return a((()=>{try{i.value=l.findNewsById(r.id)||{id:null,title:"新闻未找到",content:"抱歉，没有找到相关内容。",createdAt:(new Date).toISOString().slice(0,10),publishTime:(new Date).toISOString().slice(0,10)}}catch(e){g.value=!0}})),(e,t)=>{const a=o("el-button"),r=o("router-link"),l=o("el-header"),f=o("el-descriptions-item"),w=o("el-descriptions"),b=o("el-main"),_=o("el-alert"),v=o("el-container");return s(),n(v,{class:"news-view"},{default:c((()=>[u(l,{class:"header"},{default:c((()=>{var e;return[d("div",He,[u(r,{to:{name:"News"}},{default:c((()=>[u(a,{type:"primary",icon:p($),class:"back-button",plain:""},null,8,["icon"])])),_:1}),d("h1",null,m((null==(e=i.value)?void 0:e.title)||"新闻详情"),1)])]})),_:1}),g.value?(s(),n(b,{key:1,class:"error-main"},{default:c((()=>[u(_,{title:"无法加载新闻详情，请稍后重试。",type:"error","show-icon":""}),u(r,{to:{name:"News"}},{default:c((()=>[u(a,{type:"primary",icon:p($),class:"back-button",plain:""},null,8,["icon"])])),_:1})])),_:1})):(s(),n(b,{key:0},{default:c((()=>[u(w,{column:1,border:"",class:"news-details"},{default:c((()=>[u(f,{label:"发布日期：",class:"fixed-width-column"},{default:c((()=>{var e;return[h(m(p(je)(null==(e=i.value)?void 0:e.publishTime)),1)]})),_:1}),u(f,{label:"内容：",class:"fixed-width-column"},{default:c((()=>{var e;return[d("div",{innerHTML:null==(e=i.value)?void 0:e.content},null,8,We)]})),_:1})])),_:1})])),_:1}))])),_:1})}}}),[["__scopeId","data-v-4e4dd6f7"]]),Je={slot:"footer",class:"dialog-footer"},Ke=e({__name:"ProjectDialog",props:{isEdit:{type:Boolean},currentProject:{}},emits:["save"],setup(e,{emit:a}){const{projects:r}=we();let{dialogVisible:l}=V(r);const i=e,f=a,w=t(null),b=t({title:[{required:!0,message:"项目标题不能为空",trigger:"blur"}],status:[{required:!0,message:"请选择项目状态",trigger:"change"}],startDate:[{required:!0,message:"请选择开始日期",trigger:"change"}]}),_=()=>{w.value&&w.value.validate((async e=>{e?f("save",i.currentProject):U.warning("请检查表单填写是否正确")}))},v=()=>{l.value=!1};return(e,t)=>{const a=o("el-input"),r=o("el-form-item"),i=o("el-option"),f=o("el-select"),y=o("el-date-picker"),P=o("el-button"),V=o("el-dialog");return s(),n(V,{title:e.isEdit?"编辑项目":"添加项目",modelValue:p(l),"onUpdate:modelValue":t[7]||(t[7]=e=>g(l)?l.value=e:l=e),onClose:v,"destroy-on-close":"",draggable:"","close-on-click-modal":!1},{default:c((()=>[u(p(T),{model:e.currentProject,rules:b.value,ref_key:"projectForm",ref:w,"label-width":"100px","scroll-to-error":""},{default:c((()=>[u(r,{label:"项目标题",prop:"title"},{default:c((()=>[u(a,{modelValue:e.currentProject.title,"onUpdate:modelValue":t[0]||(t[0]=t=>e.currentProject.title=t),placeholder:"请输入项目标题"},null,8,["modelValue"])])),_:1}),u(r,{label:"项目描述"},{default:c((()=>[u(a,{modelValue:e.currentProject.description,"onUpdate:modelValue":t[1]||(t[1]=t=>e.currentProject.description=t),type:"textarea",placeholder:"请输入项目描述"},null,8,["modelValue"])])),_:1}),u(r,{label:"项目状态",prop:"status"},{default:c((()=>[u(f,{modelValue:e.currentProject.status,"onUpdate:modelValue":t[2]||(t[2]=t=>e.currentProject.status=t),placeholder:"请选择项目状态"},{default:c((()=>[u(i,{label:"未开始",value:"not_started"}),u(i,{label:"进行中",value:"in_progress"}),u(i,{label:"已完成",value:"completed"}),u(i,{label:"已取消",value:"cancelled"})])),_:1},8,["modelValue"])])),_:1}),u(r,{label:"开始日期",prop:"startDate"},{default:c((()=>[u(y,{modelValue:e.currentProject.startDate,"onUpdate:modelValue":t[3]||(t[3]=t=>e.currentProject.startDate=t),type:"date",placeholder:"选择开始日期"},null,8,["modelValue"])])),_:1}),u(r,{label:"结束日期",prop:"endDate"},{default:c((()=>[u(y,{modelValue:e.currentProject.endDate,"onUpdate:modelValue":t[4]||(t[4]=t=>e.currentProject.endDate=t),type:"date",placeholder:"选择结束日期"},null,8,["modelValue"])])),_:1}),u(r,{label:"项目备注"},{default:c((()=>[u(a,{modelValue:e.currentProject.notes,"onUpdate:modelValue":t[5]||(t[5]=t=>e.currentProject.notes=t),type:"textarea",placeholder:"请输入项目备注"},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"]),d("div",Je,[u(P,{onClick:t[6]||(t[6]=e=>g(l)?l.value=!1:l=!1)},{default:c((()=>t[8]||(t[8]=[h("取消")]))),_:1}),u(P,{type:"primary",onClick:_},{default:c((()=>[h(m(e.isEdit?"保存":"添加"),1)])),_:1})])])),_:1},8,["title","modelValue"])}}}),Qe={not_started:"info",in_progress:"warning",completed:"success",cancelled:"danger"},Xe={not_started:"未开始",in_progress:"进行中",completed:"已完成",cancelled:"已取消"},et={class:"header-content-common"},tt=e({__name:"Projects",setup(e){const{projects:r}=we(),l=t(!1),i=t(1),g=t({id:null,title:"",description:"",status:"",startDate:"",endDate:"",notes:"",createdAt:""}),w=()=>{l.value=!1,g.value={id:null,title:"",description:"",status:"",startDate:"",endDate:"",notes:"",createdAt:""},r.dialogVisible=!0},b=async e=>{l.value?await r.updateProject(e).then((()=>{U.success("项目更新成功"),r.dialogVisible=!1})).catch((e=>{U.error("项目更新失败"+e)})):await r.addProject(e).then((()=>{U.success("项目添加成功"),r.dialogVisible=!1})).catch((e=>{U.error("项目添加失败"+e)}))},_=async e=>{i.value=e,await r.fetchProjects(e).catch((e=>{U.error("加载项目数据失败: "+e)}))};return a((()=>{r.fetchProjects().catch((e=>{U.error("初始化项目数据失败: "+e.message)}))})),(e,t)=>{const a=o("el-icon"),v=o("el-tooltip"),y=o("el-header"),P=o("el-table-column"),V=o("el-tag"),k=o("el-button"),M=o("el-popconfirm"),T=o("el-table"),E=o("el-pagination"),L=o("el-empty"),z=o("el-main"),C=o("el-container");return s(),n(C,{class:"container-common"},{default:c((()=>[u(y,{class:"header-common"},{default:c((()=>[d("div",et,[t[0]||(t[0]=d("h1",{class:"title-common"},"项目管理",-1)),u(v,{class:"box-item",effect:"dark",content:"添加项目",placement:"right-start"},{default:c((()=>[u(a,{size:21,class:"add-icon-common",onClick:w},{default:c((()=>[u(p(N))])),_:1})])),_:1})])])),_:1}),u(z,null,{default:c((()=>[p(r).projectsList.length?(s(),n(T,{key:0,data:p(r).projectsList,style:{width:"100%"},height:"673",stripe:"",border:"","highlight-current-row":"","show-overflow-tooltip":""},{default:c((()=>[u(P,{fixed:"",label:"序号",width:"60",align:"center","header-align":"center"},{default:c((e=>{return[h(m((t=e.$index,(i.value-1)*r.pageSize+t+1)),1)];var t})),_:1}),u(P,{prop:"title",label:"项目标题","min-width":"200",align:"center","header-align":"center"}),u(P,{prop:"description",label:"项目描述","min-width":"200",align:"center","header-align":"center"},{default:c((e=>[h(m(e.row.description||"暂无描述"),1)])),_:1}),u(P,{prop:"status",label:"项目状态",width:"100",align:"center","header-align":"center"},{default:c((e=>[u(V,{type:p(Qe)[e.row.status],"disable-transitions":""},{default:c((()=>[h(m(p(Xe)[e.row.status]),1)])),_:2},1032,["type"])])),_:1}),u(P,{prop:"createdAt",label:"创建日期",width:"160",align:"center","header-align":"center"},{default:c((e=>[h(m(p(je)(e.row.createdAt)),1)])),_:1}),u(P,{prop:"startDate",label:"开始日期",width:"150",align:"center","header-align":"center"},{default:c((e=>[h(m(p(Re)(e.row.startDate)),1)])),_:1}),u(P,{prop:"endDate",label:"结束日期",width:"150",align:"center","header-align":"center"},{default:c((e=>[h(m(p(Re)(e.row.endDate)),1)])),_:1}),u(P,{prop:"notes",label:"备注","min-width":"200",align:"center","header-align":"center"},{default:c((e=>[h(m(e.row.notes||"暂无备注"),1)])),_:1}),u(P,{fixed:"right",label:"操作",width:"135",align:"center","header-align":"center"},{default:c((e=>[u(k,{onClick:t=>{return a=e.row,l.value=!0,g.value={...a},void(r.dialogVisible=!0);var a},type:"primary",size:"small"},{default:c((()=>t[1]||(t[1]=[h("编辑")]))),_:2},1032,["onClick"]),u(M,{"confirm-button-text":"是","cancel-button-text":"否",icon:p(I),"icon-color":"#626AEF",title:"确定删除这个文件嘛？",onConfirm:t=>(async e=>{await r.deleteProject(e).then((()=>{U.success("项目删除成功")})).catch((e=>{U.error("项目删除失败"+e)}))})(e.row.id)},{reference:c((()=>[u(k,{type:"danger",size:"small"},{default:c((()=>t[2]||(t[2]=[h("删除")]))),_:1})])),_:2},1032,["icon","onConfirm"])])),_:1})])),_:1},8,["data"])):f("",!0),p(r).totalProjects>0?(s(),n(E,{key:1,background:"",layout:"total, prev, pager, next",total:p(r).totalProjects,"page-size":p(r).pageSize,"hide-on-single-page":!0,onCurrentChange:_,class:"pagination_common"},null,8,["total","page-size"])):f("",!0),0===p(r).projectsList.length?(s(),n(L,{key:2,style:{height:"673px"},description:"暂无新闻"})):f("",!0)])),_:1}),u(Ke,{isEdit:l.value,currentProject:g.value,onSave:b,style:{"min-width":"600px"}},null,8,["isEdit","currentProject"])])),_:1})}}}),at={journal:"期刊",book:"书籍",conference:"会议论文",report:"报告",other:"其他"},rt={slot:"footer",class:"dialog-footer"},lt=e({__name:"PublicationDialog",props:{isEdit:{type:Boolean},currentPublication:{}},emits:["save"],setup(e,{emit:a}){const{publications:r}=we(),{dialogVisible:l}=V(r),f=e,w=a,v=t(null),y=t({title:[{required:!0,message:"出版物标题不能为空",trigger:"blur"}],author:[{required:!0,message:"作者不能为空",trigger:"blur"}],year:[{required:!0,message:"出版年份不能为空",trigger:"blur"}],type:[{required:!0,message:"请选择出版物类型",trigger:"change"}],link:[{required:!0,validator:(e,t,a)=>{t?/^https?:\/\//.test(t)?a():a(new Error("出版物链接必须以http或https开头")):a(new Error("出版物链接不能为空"))},trigger:"blur"}]}),P=()=>{v.value&&v.value.validate((async e=>{e?(f.currentPublication.year instanceof Date&&(f.currentPublication.year=f.currentPublication.year.getFullYear()),w("save",f.currentPublication)):U.warning("请检查表单填写是否正确")}))},k=()=>{l.value=!1};return(e,t)=>{const a=o("el-input"),r=o("el-form-item"),f=o("el-option"),w=o("el-select"),V=o("el-col"),M=o("el-date-picker"),U=o("el-row"),E=o("el-button"),L=o("el-dialog");return s(),n(L,{title:e.isEdit?"编辑出版物":"添加出版物",modelValue:p(l),"onUpdate:modelValue":t[6]||(t[6]=e=>g(l)?l.value=e:null),onClose:k,"destroy-on-close":"",draggable:"","close-on-click-modal":!1},{default:c((()=>[u(p(T),{model:e.currentPublication,rules:y.value,ref_key:"publicationForm",ref:v,"label-width":"100px","scroll-to-error":""},{default:c((()=>[u(r,{label:"出版物标题",prop:"title"},{default:c((()=>[u(a,{modelValue:e.currentPublication.title,"onUpdate:modelValue":t[0]||(t[0]=t=>e.currentPublication.title=t),placeholder:"请输入出版物标题"},null,8,["modelValue"])])),_:1}),u(r,{label:"作者",prop:"author"},{default:c((()=>[u(a,{modelValue:e.currentPublication.author,"onUpdate:modelValue":t[1]||(t[1]=t=>e.currentPublication.author=t),placeholder:"请输入作者"},null,8,["modelValue"])])),_:1}),u(U,{gutter:20},{default:c((()=>[u(V,{span:12},{default:c((()=>[u(r,{label:"类型",prop:"type"},{default:c((()=>[u(w,{modelValue:e.currentPublication.type,"onUpdate:modelValue":t[2]||(t[2]=t=>e.currentPublication.type=t),placeholder:"请选择出版物类型"},{default:c((()=>[(s(!0),i(_,null,b(p(at),((e,t)=>(s(),n(f,{key:t,label:e,value:t},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1}),u(V,{span:12},{default:c((()=>[u(r,{label:"年份",prop:"year"},{default:c((()=>[u(M,{modelValue:e.currentPublication.year,"onUpdate:modelValue":t[3]||(t[3]=t=>e.currentPublication.year=t),type:"year",placeholder:"请选择出版年份"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),u(r,{label:"出版物链接",prop:"link"},{default:c((()=>[u(a,{modelValue:e.currentPublication.link,"onUpdate:modelValue":t[4]||(t[4]=t=>e.currentPublication.link=t),placeholder:"请输入出版物链接"},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"]),d("div",rt,[u(E,{onClick:t[5]||(t[5]=e=>l.value=!1),class:"cancel-button"},{default:c((()=>t[7]||(t[7]=[h("取消")]))),_:1}),u(E,{type:"primary",onClick:P,class:"save-button"},{default:c((()=>[h(m(e.isEdit?"保存":"添加"),1)])),_:1})])])),_:1},8,["title","modelValue"])}}}),st={class:"header-content-common"},it=J(e({__name:"Publications",setup(e){const{publications:r}=we(),l=t(!1),i=t(1),g=t({id:null,title:"",author:"",year:"",type:"",link:""}),w=()=>{l.value=!1,g.value={id:null,title:"",author:"",year:"",type:"",link:""},r.dialogVisible=!0},b=async e=>{l.value?await r.updatePublication(e).then((()=>{U.success("出版物更新成功"),r.dialogVisible=!1})).catch((e=>{U.error("出版物更新失败"+e)})):await r.addPublication(e).then((()=>{U.success("出版物添加成功"),r.dialogVisible=!1})).catch((e=>{U.error("出版物添加失败"+e)}))},_=async e=>{i.value=e,await r.fetchPublications(e).catch((e=>{U.error("加载出版物数据失败: "+e)}))};return a((()=>{r.fetchPublications().catch((e=>{U.error("初始化项目数据失败: "+e.message)}))})),(e,t)=>{const a=o("el-icon"),v=o("el-tooltip"),y=o("el-header"),P=o("el-table-column"),V=o("el-link"),k=o("el-button"),M=o("el-popconfirm"),T=o("el-table"),E=o("el-pagination"),L=o("el-empty"),z=o("el-main"),C=o("el-container");return s(),n(C,{class:"container-common"},{default:c((()=>[u(y,{class:"header-common"},{default:c((()=>[d("div",st,[t[0]||(t[0]=d("h1",{class:"title-common"},"出版物管理",-1)),u(v,{effect:"dark",content:"添加出版物",placement:"right-start"},{default:c((()=>[u(a,{size:21,class:"add-icon-common",onClick:w},{default:c((()=>[u(p(N))])),_:1})])),_:1})])])),_:1}),u(z,null,{default:c((()=>[p(r).publicationsList.length?(s(),n(T,{key:0,data:p(r).publicationsList,style:{width:"100%"},height:"673",stripe:"",border:"","highlight-current-row":"","show-overflow-tooltip":""},{default:c((()=>[u(P,{fixed:"",label:"序号",width:"60",align:"center","header-align":"center"},{default:c((e=>{return[h(m((t=e.$index,(i.value-1)*r.pageSize+t+1)),1)];var t})),_:1}),u(P,{prop:"title",label:"标题","min-width":"300",align:"center","header-align":"center"}),u(P,{prop:"author",label:"作者","min-width":"100",align:"center","header-align":"center"}),u(P,{prop:"year",label:"年份",width:"100",align:"center","header-align":"center"},{default:c((e=>[h(m(p(Ae)(e.row.year)),1)])),_:1}),u(P,{prop:"link",label:"连接","min-width":"100",align:"center","header-align":"center"},{default:c((e=>[u(V,{href:e.row.link||"",target:"_blank"},{default:c((()=>[h(m(e.row.link||"无连接"),1)])),_:2},1032,["href"])])),_:1}),u(P,{prop:"type",label:"类型",width:"150",align:"center","header-align":"center"},{default:c((e=>[h(m(p(at)[e.row.type]),1)])),_:1}),u(P,{fixed:"right",label:"操作",width:"135",align:"center","header-align":"center"},{default:c((e=>[u(k,{onClick:t=>{return a=e.row,l.value=!0,g.value={...a},void(r.dialogVisible=!0);var a},type:"primary",size:"small"},{default:c((()=>t[1]||(t[1]=[h("编辑")]))),_:2},1032,["onClick"]),u(M,{"confirm-button-text":"是","cancel-button-text":"否",icon:p(I),"icon-color":"#626AEF",title:"确定删除这个文件嘛？",onConfirm:t=>(async e=>{await r.deletePublication(e).catch((e=>{U.error("删除出版物失败: "+e)}))})(e.row.id)},{reference:c((()=>[u(k,{type:"danger",size:"small"},{default:c((()=>t[2]||(t[2]=[h("删除")]))),_:1})])),_:2},1032,["icon","onConfirm"])])),_:1})])),_:1},8,["data"])):f("",!0),p(r).totalPublications>0?(s(),n(E,{key:1,background:"",layout:"total, prev, pager, next",total:p(r).totalPublications,"page-size":p(r).pageSize,"hide-on-single-page":!0,onCurrentChange:_,class:"pagination_common"},null,8,["total","page-size"])):f("",!0),0===p(r).publicationsList.length?(s(),n(L,{key:2,style:{height:"673px"},description:"暂无出版物"})):f("",!0)])),_:1}),u(lt,{isEdit:l.value,currentPublication:g.value,onSave:b,style:{"min-width":"600px"}},null,8,["isEdit","currentPublication"])])),_:1})}}}),[["__scopeId","data-v-0afebfd5"]]);var ot=(e=>(e.DOCUMENT="document",e.IMAGE="image",e.VIDEO="video",e.AUDIO="audio",e.ARCHIVE="archive",e.SOFTWARE="software",e.OTHER="other",e))(ot||{});const nt={document:"文档",image:"图片",video:"视频",audio:"音频",archive:"压缩文件",software:"软件",other:"其他"},ct={pdf:"document",doc:"document",docx:"document",xls:"document",xlsx:"document",txt:"document",rtf:"document",jpg:"image",jpeg:"image",png:"image",gif:"image",mp4:"video",avi:"video",mov:"video",mp3:"audio",wav:"audio",zip:"archive",rar:"archive","7z":"archive",exe:"software",dmg:"software"},ut=J(e({__name:"FileUpload",emits:["save_filename"],setup(e,{emit:a}){const{upload:r}=we(),{fileList:l}=V(r),i=t(null),u=a,m=e=>e.size/1024/1024<10?(l.value=[e],!1):(U.error("文件大小不能超过 10MB"),!1),g=e=>{m(e.raw)?u("save_filename",e.raw.name):i.value.clearFiles()},w=e=>{const t=e[0];m(t)&&(i.value.clearFiles(),t.uid=E(),i.value.handleStart(t))},b=()=>{l.value=[]};return(e,t)=>{const a=o("el-button"),r=o("el-upload");return s(),n(r,{ref_key:"uploadRef",ref:i,class:"file-uploader","file-list":p(l),"list-type":"text","auto-upload":!1,"on-remove":b,"on-exceed":w,limit:1,style:{width:"100%"},"on-change":g},{trigger:c((()=>[0===p(l).length?(s(),n(a,{key:0,type:"primary"},{default:c((()=>t[0]||(t[0]=[h("点击选择文件")]))),_:1})):f("",!0),t[1]||(t[1]=d("div",{class:"el-upload__tip"},"只能上传 PDF、PPT、DOCX 文件，且不超过 10MB",-1))])),_:1},8,["file-list"])}}}),[["__scopeId","data-v-cc272be3"]]),dt={slot:"footer",class:"dialog-footer"},ht=e({__name:"ResourceDialog",props:{isEdit:{type:Boolean},currentResource:{}},emits:["save"],setup(e,{emit:a}){const{resources:l,upload:f}=we(),{dialogVisible:w}=V(l),{fileList:v}=V(f),y=e,P=t(!0);r((()=>y.currentResource.url),(e=>{e&&e.startsWith("http")?P.value=!0:P.value=!1}),{immediate:!0});const k=t({title:[{required:!0,message:"资源标题不能为空",trigger:"blur"}],description:[{required:!0,message:"资源描述不能为空",trigger:"blur"}],category:[{required:!0,message:"请选择资源分类",trigger:"change"}],url:[{required:!0,message:"下载链接不能为空",trigger:"blur",when:()=>P.value}]}),M=a,E=t(null),L=()=>{w.value=!1},z=async e=>{const t=e.split("."),a=t.length>1?t[t.length-1].toLowerCase():"";y.currentResource.title=t[0],y.currentResource.category=ct[a]||ot.OTHER},C=async()=>{E.value&&E.value.validate((async e=>{e?!P.value&&f.fileList.length>0?await f.uploadFile(v.value[0]).then((e=>{y.currentResource.url=e,M("save",y.currentResource)})).catch((e=>{U.error("文件上传出错: "+e.message)})):P.value&&M("save",y.currentResource):U.warning("请检查表单填写是否正确")}))};return(e,t)=>{const a=o("el-input"),r=o("el-form-item"),l=o("el-option"),f=o("el-select"),v=o("el-col"),y=o("el-switch"),V=o("el-row"),M=o("el-button"),U=o("el-dialog");return s(),n(U,{title:e.isEdit?"编辑资源":"添加资源",modelValue:p(w),"onUpdate:modelValue":t[6]||(t[6]=e=>g(w)?w.value=e:null),onClose:L,"destroy-on-close":"",draggable:"","close-on-click-modal":!1},{default:c((()=>[u(p(T),{model:e.currentResource,rules:k.value,ref_key:"resourceForm",ref:E,"label-width":"100px","scroll-to-error":""},{default:c((()=>[u(r,{label:"资源标题",prop:"title","show-message":""===e.currentResource.title,"validate-status":""!==e.currentResource.title?"success":"error"},{default:c((()=>[u(a,{modelValue:e.currentResource.title,"onUpdate:modelValue":t[0]||(t[0]=t=>e.currentResource.title=t),placeholder:"请输入资源标题"},null,8,["modelValue"])])),_:1},8,["show-message","validate-status"]),u(r,{label:"描述",prop:"description"},{default:c((()=>[u(a,{modelValue:e.currentResource.description,"onUpdate:modelValue":t[1]||(t[1]=t=>e.currentResource.description=t),placeholder:"请输入资源描述",type:"textarea",rows:3,maxlength:"500","show-word-limit":""},null,8,["modelValue"])])),_:1}),u(V,{gutter:20},{default:c((()=>[u(v,{span:12},{default:c((()=>[u(r,{label:"分类",prop:"category"},{default:c((()=>[u(f,{modelValue:e.currentResource.category,"onUpdate:modelValue":t[2]||(t[2]=t=>e.currentResource.category=t),placeholder:"请选择分类"},{default:c((()=>[(s(!0),i(_,null,b(p(nt),((e,t)=>(s(),n(l,{key:t,label:e,value:t},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1}),u(v,{span:12},{default:c((()=>[u(r,{label:"链接?",prop:"isLink"},{default:c((()=>[u(y,{modelValue:P.value,"onUpdate:modelValue":t[3]||(t[3]=e=>P.value=e),"inline-prompt":"","active-icon":p(A),"inactive-icon":p(D)},null,8,["modelValue","active-icon","inactive-icon"])])),_:1})])),_:1})])),_:1}),P.value?(s(),n(r,{key:0,label:"下载链接",prop:"url"},{default:c((()=>[u(a,{modelValue:e.currentResource.url,"onUpdate:modelValue":t[4]||(t[4]=t=>e.currentResource.url=t),placeholder:"请输入资源下载链接"},null,8,["modelValue"])])),_:1})):(s(),n(r,{key:1,label:"上传资源"},{default:c((()=>[u(ut,{drag:"",onSave_filename:z})])),_:1}))])),_:1},8,["model","rules"]),d("div",dt,[u(M,{onClick:t[5]||(t[5]=e=>w.value=!1),class:"cancel-button"},{default:c((()=>t[7]||(t[7]=[h("取消")]))),_:1}),u(M,{type:"primary",onClick:C,class:"save-button"},{default:c((()=>[h(m(e.isEdit?"保存":"添加"),1)])),_:1})])])),_:1},8,["title","modelValue"])}}}),mt={class:"header-content-common"},pt=J(e({__name:"Resources",setup(e){const{resources:r}=we(),l=t(!1),i=t(1),g=t({id:null,title:"",description:"",url:"",category:"",downloadCount:0}),w=()=>{},b=()=>{l.value=!1,g.value={id:null,title:"",description:"",url:"",category:"",downloadCount:0},r.dialogVisible=!0},_=async e=>{i.value=e,await r.fetchResources(e).catch((e=>{U.error("加载项目数据失败: "+e)}))},v=async e=>{l.value?await r.updateResource(e).then((()=>{U.success("资源更新成功"),r.dialogVisible=!1})).catch((e=>{U.error("资源更新失败"+e)})):await r.addResource(e).then((()=>{U.success("资源添加成功"),r.dialogVisible=!1})).catch((e=>{U.error("资源添加失败"+e)}))};return a((()=>{r.fetchResources().catch((e=>{U.error("初始化资源数据失败: "+e.message)}))})),(e,t)=>{const a=o("el-icon"),y=o("el-tooltip"),P=o("el-header"),V=o("el-table-column"),k=o("el-link"),M=o("el-button"),T=o("el-popconfirm"),E=o("el-table"),L=o("el-pagination"),z=o("el-empty"),C=o("el-main"),S=o("el-container");return s(),n(S,{class:"container-common"},{default:c((()=>[u(P,{class:"header-common"},{default:c((()=>[d("div",mt,[t[0]||(t[0]=d("h1",{class:"title-common"},"资源下载管理",-1)),u(y,{effect:"dark",content:"添加资源",placement:"right-start"},{default:c((()=>[u(a,{size:21,class:"add-icon-common",onClick:b},{default:c((()=>[u(p(N))])),_:1})])),_:1})])])),_:1}),u(C,null,{default:c((()=>[p(r).resourcesList.length?(s(),n(E,{key:0,data:p(r).resourcesList,style:{width:"100%"},height:"673",stripe:"",border:"","highlight-current-row":"","show-overflow-tooltip":""},{default:c((()=>[u(V,{fixed:"",label:"序号",width:"60",align:"center","header-align":"center"},{default:c((e=>{return[h(m((t=e.$index,(i.value-1)*r.pageSize+t+1)),1)];var t})),_:1}),u(V,{prop:"title",label:"资源标题","min-width":"250",align:"center","header-align":"center"}),u(V,{prop:"description",label:"描述","min-width":"250",align:"center","header-align":"center"}),u(V,{prop:"category",label:"分类",width:"80",align:"center","header-align":"center"},{default:c((e=>[h(m(p(nt)[e.row.category]),1)])),_:1}),u(V,{prop:"createdAt",label:"创建日期",width:"150",align:"center","header-align":"center"}),u(V,{prop:"url",label:"下载链接",width:"100",align:"center","header-align":"center"},{default:c((e=>[u(k,{onClick:t=>(async(e,t)=>{await fetch(e).then((async e=>{if(!e.ok)return void U.error("文件下载失败");const a=await e.blob(),r=document.createElement("a"),l=URL.createObjectURL(a);r.href=l,r.download=t,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(l),U.success("下载开始")})).catch((e=>{U.error("下载失败: "+e)}))})(e.row.url,e.row.title),target:"_blank"},{default:c((()=>t[1]||(t[1]=[h("下载")]))),_:2},1032,["onClick"])])),_:1}),u(V,{prop:"downloadCount",label:"下载次数",width:"150",align:"center","header-align":"center"}),u(V,{fixed:"right",label:"操作",width:"135",align:"center","header-align":"center"},{default:c((e=>[u(M,{onClick:t=>{return a=e.row,l.value=!0,g.value={...a},void(r.dialogVisible=!0);var a},type:"primary",size:"small"},{default:c((()=>t[2]||(t[2]=[h("编辑")]))),_:2},1032,["onClick"]),u(T,{"confirm-button-text":"是","cancel-button-text":"否",icon:p(I),"icon-color":"#626AEF",title:"确定删除这个文件嘛？",onConfirm:t=>(async e=>{await r.deleteResource(e).then((()=>{U.success("资源删除成功")})).catch((e=>{U.error("资源删除失败"+e)}))})(e.row.id),onCancel:w},{reference:c((()=>[u(M,{type:"danger",size:"small"},{default:c((()=>t[3]||(t[3]=[h("删除")]))),_:1})])),_:2},1032,["icon","onConfirm"])])),_:1})])),_:1},8,["data"])):f("",!0),p(r).totalResources>0?(s(),n(L,{key:1,background:"",layout:"total, prev, pager, next",total:p(r).totalResources,"page-size":p(r).pageSize,"hide-on-single-page":!0,onCurrentChange:_,class:"pagination_common"},null,8,["total","page-size"])):f("",!0),0===p(r).resourcesList.length?(s(),n(z,{key:2,style:{height:"673px"},description:"暂无资源"})):f("",!0)])),_:1}),u(ht,{isEdit:l.value,currentResource:g.value,onSave:v,style:{"min-width":"600px"}},null,8,["isEdit","currentResource"])])),_:1})}}}),[["__scopeId","data-v-e5f84924"]]);var gt=(e=>(e.UNDERGRADUATE="undergraduate",e.GRADUATE="graduate",e.RESEARCHER="researcher",e.PROFESSOR="professor",e.LAB_MANAGER="lab_manager",e.ASSISTANT="assistant",e))(gt||{});const ft={undergraduate:"本科生",graduate:"研究生",researcher:"研究员",professor:"教授",lab_manager:"实验室经理",assistant:"助理"},wt={slot:"footer",class:"dialog-footer"},bt=e({__name:"TeamDialog",props:{isEdit:{type:Boolean},currentMember:{}},emits:["save"],setup(e,{emit:a}){const{teams:r}=we(),{dialogVisible:l,email_error:w}=V(r),y=e,P=a,k=t(null),M=v({name:[{required:!0,message:"姓名不能为空",trigger:"blur"}],position:[{required:!0,message:"请选择职位",trigger:"change"}],email:[{required:!0,validator:(e,t,a)=>{t?/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,6}$/.test(t)?a():a(new Error("请输入有效的邮箱地址")):a(new Error("邮箱不能为空"))},trigger:"blur"}],enrollmentYear:[{required:!0,message:"入学年份不能为空",trigger:"blur"}],graduationYear:[{required:!1,message:"毕业年份不能为空",trigger:"blur"}],careerPath:[{required:!1,message:"毕业去向不能为空",trigger:"blur"}]}),E=()=>{k.value&&k.value.validate((async e=>{e?(y.currentMember.enrollmentYear instanceof Date&&(y.currentMember.enrollmentYear=y.currentMember.enrollmentYear.getFullYear()),y.currentMember.graduationYear instanceof Date&&(y.currentMember.graduationYear=y.currentMember.graduationYear.getFullYear()),P("save",y.currentMember)):U.warning("请检查表单填写是否正确")}))},L=()=>{l.value=!1,w.value=""};return(e,t)=>{const a=o("el-input"),r=o("el-form-item"),v=o("el-option"),y=o("el-select"),P=o("el-col"),V=o("el-row"),U=o("el-date-picker"),z=o("el-button"),C=o("el-dialog");return s(),n(C,{title:e.isEdit?"编辑团队成员":"添加团队成员",modelValue:p(l),"onUpdate:modelValue":t[9]||(t[9]=e=>g(l)?l.value=e:null),onClose:L,"destroy-on-close":"",draggable:"","close-on-click-modal":!1},{default:c((()=>[u(p(T),{model:e.currentMember,rules:M,ref_key:"teamForm",ref:k,"label-width":"100px","scroll-to-error":""},{default:c((()=>[u(r,{label:"姓名",prop:"name"},{default:c((()=>[u(a,{modelValue:e.currentMember.name,"onUpdate:modelValue":t[0]||(t[0]=t=>e.currentMember.name=t),placeholder:"请输入团队成员姓名"},null,8,["modelValue"])])),_:1}),u(V,{gutter:20},{default:c((()=>[u(P,{span:12},{default:c((()=>[u(r,{label:"职位",prop:"position"},{default:c((()=>[u(y,{modelValue:e.currentMember.position,"onUpdate:modelValue":t[1]||(t[1]=t=>e.currentMember.position=t),placeholder:"请选择团队成员职位"},{default:c((()=>[(s(!0),i(_,null,b(p(ft),((e,t)=>(s(),n(v,{key:t,label:e,value:t},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1}),u(P,{span:12},{default:c((()=>["undergraduate"!==e.currentMember.position?(s(),n(r,{key:0,required:"undergraduate"!==e.currentMember.position,label:"研究领域",prop:"researchArea",error:"研究领域不能为空"},{default:c((()=>[u(a,{modelValue:e.currentMember.researchArea,"onUpdate:modelValue":t[2]||(t[2]=t=>e.currentMember.researchArea=t),placeholder:"请输入研究领域"},null,8,["modelValue"])])),_:1},8,["required"])):f("",!0)])),_:1})])),_:1}),u(V,{gutter:20},{default:c((()=>[u(P,{span:12},{default:c((()=>[u(r,{label:"入学年份",prop:"enrollmentYear"},{default:c((()=>[u(U,{modelValue:e.currentMember.enrollmentYear,"onUpdate:modelValue":t[3]||(t[3]=t=>e.currentMember.enrollmentYear=t),type:"year",placeholder:"请输入入学年份"},null,8,["modelValue"])])),_:1})])),_:1}),u(P,{span:12},{default:c((()=>[u(r,{label:"毕业年份",prop:"graduationYear"},{default:c((()=>[u(U,{modelValue:e.currentMember.graduationYear,"onUpdate:modelValue":t[4]||(t[4]=t=>e.currentMember.graduationYear=t),type:"year",placeholder:"请输入毕业年份"},null,8,["modelValue"])])),_:1})])),_:1})])),_:1}),u(r,{label:"毕业去向",prop:"careerPath"},{default:c((()=>[u(a,{modelValue:e.currentMember.careerPath,"onUpdate:modelValue":t[5]||(t[5]=t=>e.currentMember.careerPath=t),placeholder:"请输入毕业去向",type:"textarea"},null,8,["modelValue"])])),_:1}),u(r,{label:"邮箱",prop:"email",error:p(w)},{default:c((()=>[u(a,{modelValue:e.currentMember.email,"onUpdate:modelValue":t[6]||(t[6]=t=>e.currentMember.email=t),placeholder:"请输入团队成员邮箱",type:"email"},null,8,["modelValue"])])),_:1},8,["error"]),u(r,{label:"简介",prop:"description"},{default:c((()=>[u(a,{modelValue:e.currentMember.description,"onUpdate:modelValue":t[7]||(t[7]=t=>e.currentMember.description=t),placeholder:"请输入简介",type:"textarea"},null,8,["modelValue"])])),_:1})])),_:1},8,["model","rules"]),d("div",wt,[u(z,{onClick:t[8]||(t[8]=e=>l.value=!1),class:"cancel-button"},{default:c((()=>t[10]||(t[10]=[h("取消")]))),_:1}),u(z,{type:"primary",onClick:E,class:"save-button"},{default:c((()=>[h(m(e.isEdit?"保存":"添加"),1)])),_:1})])])),_:1},8,["title","modelValue"])}}}),_t={class:"header-content-common"},vt=J(e({__name:"Team",setup(e){const{teams:r}=we(),l=t(!1),i=t(1),g=t({id:null,name:"",position:gt.UNDERGRADUATE,email:"",description:"",researchArea:"",enrollmentYear:(new Date).getFullYear().toString(),graduationYear:"",careerPath:""}),w=()=>{l.value=!1,g.value={id:null,name:"",position:gt.UNDERGRADUATE,email:"",description:"",researchArea:"",enrollmentYear:(new Date).getFullYear().toString(),graduationYear:"",careerPath:""},r.dialogVisible=!0},b=async e=>{i.value=e,await r.fetchTeamMembers(e).catch((e=>{U.error("加载项目数据失败: "+e)}))},_=async e=>{l.value?await r.updateTeamMember(e).then((()=>{U.success("成员更新成功"),r.dialogVisible=!1})).catch((e=>{U.error("成员更新失败"+e.message)})):await r.addTeamMember(e).then((()=>{U.success("成员添加成功"),r.dialogVisible=!1})).catch((e=>{e.message.includes("email")&&(r.email_error="邮箱已存在")}))};return a((()=>{r.fetchTeamMembers().catch((e=>{U.error("初始化资源数据失败: "+e.message)}))})),(e,t)=>{const a=o("el-icon"),v=o("el-tooltip"),y=o("el-header"),P=o("el-table-column"),V=o("el-button"),k=o("el-popconfirm"),M=o("el-table"),T=o("el-pagination"),E=o("el-empty"),L=o("el-main"),z=o("el-container");return s(),n(z,{class:"container-common"},{default:c((()=>[u(y,{class:"header-common"},{default:c((()=>[d("div",_t,[t[0]||(t[0]=d("h1",{class:"title-common"},"团队管理",-1)),u(v,{effect:"dark",content:"添加团队成员",placement:"right-start"},{default:c((()=>[u(a,{size:21,class:"add-icon-common",onClick:w},{default:c((()=>[u(p(N))])),_:1})])),_:1})])])),_:1}),u(L,null,{default:c((()=>[p(r).teamMembersList.length?(s(),n(M,{key:0,data:p(r).teamMembersList,style:{width:"100%"},height:"673",stripe:"",border:"","highlight-current-row":"","show-overflow-tooltip":""},{default:c((()=>[u(P,{fixed:"",label:"序号",width:"60",align:"center","header-align":"center"},{default:c((e=>{return[h(m((t=e.$index,(i.value-1)*r.pageSize+t+1)),1)];var t})),_:1}),u(P,{prop:"name",label:"姓名",align:"center",width:"150","header-align":"center"}),u(P,{prop:"position",label:"职位",width:"150",align:"center","header-align":"center"},{default:c((e=>[h(m(p(ft)[e.row.position]),1)])),_:1}),u(P,{prop:"email",label:"邮箱","min-width":"200",align:"center","header-align":"center"}),u(P,{prop:"researchArea",label:"研究领域","min-width":"300",align:"center","header-align":"center"}),u(P,{prop:"enrollmentYear",label:"入学年份",width:"90",align:"center","header-align":"center"},{default:c((e=>[h(m(p(Ae)(e.row.enrollmentYear)),1)])),_:1}),u(P,{prop:"graduationYear",label:"毕业年份",width:"90",align:"center","header-align":"center"},{default:c((e=>[h(m(p(Ae)(e.row.graduationYear)||"尚未毕业"),1)])),_:1}),u(P,{fixed:"right",label:"操作",width:"200",align:"center","header-align":"center"},{default:c((e=>[u(V,{onClick:t=>{return a=e.row,g.value={...a},void(r.dialogVisible=!0);var a},type:"info",size:"small"},{default:c((()=>t[1]||(t[1]=[h("查看")]))),_:2},1032,["onClick"]),u(V,{onClick:t=>{return a=e.row,l.value=!0,g.value={...a},void(r.dialogVisible=!0);var a},type:"primary",size:"small"},{default:c((()=>t[2]||(t[2]=[h("编辑")]))),_:2},1032,["onClick"]),u(k,{"confirm-button-text":"是","cancel-button-text":"否",icon:p(I),"icon-color":"#626AEF",title:"确定删除该成员嘛？",onConfirm:t=>(async e=>{await r.deleteTeamMember(e).then((()=>{U.success("资源成员删除成功")})).catch((e=>{U.error("资源成员删除失败"+e)}))})(e.row.id)},{reference:c((()=>[u(V,{type:"danger",size:"small"},{default:c((()=>t[3]||(t[3]=[h("删除")]))),_:1})])),_:2},1032,["icon","onConfirm"])])),_:1})])),_:1},8,["data"])):f("",!0),p(r).totalTeamMembers>0?(s(),n(T,{key:1,background:"",layout:"total, prev, pager, next",total:p(r).totalTeamMembers,"page-size":p(r).pageSize,"hide-on-single-page":!0,onCurrentChange:b,class:"pagination_common"},null,8,["total","page-size"])):f("",!0),0===p(r).teamMembersList.length?(s(),n(E,{key:2,style:{height:"673px"},description:"暂无团队成员"})):f("",!0)])),_:1}),u(bt,{isEdit:l.value,currentMember:g.value,onSave:_},null,8,["isEdit","currentMember"])])),_:1})}}}),[["__scopeId","data-v-179b62cc"]]),yt={admin:"管理员",member:"普通用户",guest:"访客"},Pt={slot:"footer",class:"dialog-footer"},Vt=e({__name:"UserDialog",props:{isEdit:{type:Boolean},currentUser:{}},emits:["save"],setup(e,{emit:a}){const{users:r}=we(),{dialogVisible:l,email_error:w,username_error:v}=V(r),y=e,P=a,k=t(null),M={username:[{required:!0,message:"用户名不能为空",trigger:"blur"}],email:[{required:!0,validator:(e,t,a)=>{t?/^[a-zA-Z0-9._-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,6}$/.test(t)?a():a(new Error("请输入有效的邮箱地址")):a(new Error("邮箱不能为空"))},trigger:"blur"}],password:[{required:!y.isEdit,message:"密码不能为空",trigger:"blur"}],role:[{required:!0,message:"请选择角色",trigger:"change"}]},E=()=>{k.value&&k.value.validate((async e=>{e?P("save",y.currentUser):U.warning("请检查表单填写是否正确")}))},L=()=>{l.value=!1,w.value="",v.value=""};return(e,t)=>{const a=o("el-input"),r=o("el-form-item"),y=o("el-option"),P=o("el-select"),V=o("el-button"),U=o("el-dialog");return s(),n(U,{title:e.isEdit?"编辑用户":"添加用户",modelValue:p(l),"onUpdate:modelValue":t[5]||(t[5]=e=>g(l)?l.value=e:null),onClose:L,"destroy-on-close":"",draggable:"","close-on-click-modal":!1},{default:c((()=>[u(p(T),{model:e.currentUser,rules:M,ref_key:"userForm",ref:k,"label-width":"100px","scroll-to-error":""},{default:c((()=>[u(r,{label:"用户名",prop:"username",error:p(v)},{default:c((()=>[u(a,{modelValue:e.currentUser.username,"onUpdate:modelValue":t[0]||(t[0]=t=>e.currentUser.username=t),placeholder:"请输入用户名"},null,8,["modelValue"])])),_:1},8,["error"]),u(r,{label:"邮箱",prop:"email",error:p(w)},{default:c((()=>[u(a,{modelValue:e.currentUser.email,"onUpdate:modelValue":t[1]||(t[1]=t=>e.currentUser.email=t),placeholder:"请输入团队成员邮箱",type:"email"},null,8,["modelValue"])])),_:1},8,["error"]),e.isEdit?f("",!0):(s(),n(r,{key:0,label:"密码",prop:"password"},{default:c((()=>[u(a,{modelValue:e.currentUser.password,"onUpdate:modelValue":t[2]||(t[2]=t=>e.currentUser.password=t),placeholder:"请输入密码",type:"password"},null,8,["modelValue"])])),_:1})),u(r,{label:"角色",prop:"role"},{default:c((()=>[u(P,{modelValue:e.currentUser.role,"onUpdate:modelValue":t[3]||(t[3]=t=>e.currentUser.role=t),placeholder:"请选择角色"},{default:c((()=>[(s(!0),i(_,null,b(p(yt),((e,t)=>(s(),n(y,{key:t,label:e,value:t},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1},8,["model"]),d("div",Pt,[u(V,{onClick:t[4]||(t[4]=e=>l.value=!1),class:"cancel-button"},{default:c((()=>t[6]||(t[6]=[h("取消")]))),_:1}),u(V,{type:"primary",onClick:E,class:"save-button"},{default:c((()=>[h(m(e.isEdit?"保存":"添加"),1)])),_:1})])])),_:1},8,["title","modelValue"])}}}),kt={class:"header-content-common"},Mt={class:"forgot-password"};const Tt={class:"error-page"};const Ut={class:"error-page"};const Et={class:"error-page"};const Lt={class:"error-page"};const zt={class:"error-page"};const Ct={class:"error-page"};const St=[{path:"/",component:Se,name:"/",meta:{requiresAuth:!0}},{path:"/messages",component:Ie,name:"Messages",meta:{requiresAuth:!0}},{path:"/news",component:Fe,name:"News",meta:{requiresAuth:!0}},{path:"/news/add",component:Ye,name:"NewsAdd",meta:{requiresAuth:!0},props:{mode:"add"}},{path:"/news/edit/:id",component:Ye,name:"NewsEdit",meta:{requiresAuth:!0},props:e=>({mode:"edit",id:Number(e.params.id)})},{path:"/news/view/:id",component:Ze,name:"NewsView",meta:{requiresAuth:!0},props:e=>({id:Number(e.params.id)})},{path:"/projects",component:tt,name:"Projects",meta:{requiresAuth:!0}},{path:"/publications",component:it,name:"Publications",meta:{requiresAuth:!0}},{path:"/resources",component:pt,name:"Resources",meta:{requiresAuth:!0}},{path:"/team",component:vt,name:"Team",meta:{requiresAuth:!0}},{path:"/users",component:J(e({__name:"Users",setup(e){const{users:r}=we(),{dialogVisible:l}=V(r),i=t(!1),g=t(!1),w=t(1),b=t({id:null,username:"",password:"",role:""}),_=()=>{i.value=!1,g.value=!1,b.value={id:null,username:"",password:"",role:"",email:""},l.value=!0},v=async e=>{i.value?await r.updateUser(e).then((()=>{U.success("成员更新成功"),r.dialogVisible=!1})).catch((e=>{e.includes("not authorized")?U.error("权限不足"):U.error("成员更新失败"+e.message)})):await r.addUser(e).then((()=>{U.success("成员添加成功"),r.dialogVisible=!1})).catch((e=>{U.error("成员添加失败"+e.message),e.message.includes("email")&&(r.email_error="邮箱已存在"),e.message.includes("username")&&(r.username_error="用户名已存在")}))},y=async e=>{w.value=e,await r.fetchUsers(e).catch((e=>{U.error("加载用户数据失败: "+e)}))};return a((async()=>{await r.fetchUsers().catch((()=>{U.error("获取用户列表失败")}))})),(e,t)=>{const a=o("el-icon"),P=o("el-tooltip"),V=o("el-header"),k=o("el-table-column"),M=o("el-button"),T=o("el-table"),E=o("el-pagination"),L=o("el-empty"),z=o("el-main"),C=o("el-container");return s(),n(C,{class:"container-common"},{default:c((()=>[u(V,{class:"header-common"},{default:c((()=>[d("div",kt,[t[0]||(t[0]=d("h1",{class:"title-common"},"用户管理",-1)),u(P,{effect:"dark",content:"添加用户",placement:"right-start"},{default:c((()=>[u(a,{size:21,class:"add-icon-common",onClick:_},{default:c((()=>[u(p(N))])),_:1})])),_:1})])])),_:1}),u(z,null,{default:c((()=>[p(r).usersList.length?(s(),n(T,{key:0,data:p(r).usersList,style:{width:"100%"},height:"673",stripe:"",border:"","highlight-current-row":"","show-overflow-tooltip":""},{default:c((()=>[u(k,{fixed:"",label:"序号",width:"60",align:"center","header-align":"center"},{default:c((e=>{return[h(m((t=e.$index,(w.value-1)*r.pageSize+t+1)),1)];var t})),_:1}),u(k,{prop:"username",label:"用户名","min-width":"200",align:"center","header-align":"center"}),u(k,{prop:"role","min-width":"200",label:"角色",width:"150",align:"center","header-align":"center"},{default:c((e=>[h(m(p(yt)[e.row.role]),1)])),_:1}),u(k,{prop:"email",label:"邮箱","min-width":"200",align:"center","header-align":"center"}),u(k,{prop:"createdAt",label:"创建日期",width:"160",align:"center","header-align":"center"},{default:c((e=>[h(m(p(je)(e.row.createdAt)),1)])),_:1}),u(k,{fixed:"right",label:"操作",width:"140",align:"center","header-align":"center"},{default:c((e=>[u(M,{onClick:t=>{return a=e.row,i.value=!0,g.value=!1,b.value={...a,password:""},void(l.value=!0);var a},type:"primary",size:"small"},{default:c((()=>t[1]||(t[1]=[h("编辑")]))),_:2},1032,["onClick"]),"ADMIN"!==e.row.username.toString().toUpperCase()?(s(),n(M,{key:0,onClick:t=>(async e=>{var t;if("ADMIN"===(null==(t=r.findUserById(e))?void 0:t.username.toUpperCase()))return U.error("管理员不允许删除");await r.deleteUser(e).then((()=>{U.success("用户删除成功")})).catch((e=>{U.error("用户删除失败"+e)}))})(e.row.id),type:"danger",size:"small"},{default:c((()=>t[2]||(t[2]=[h("删除")]))),_:2},1032,["onClick"])):f("",!0)])),_:1})])),_:1},8,["data"])):f("",!0),p(r).totalUsers>0?(s(),n(E,{key:1,background:"",layout:"total, prev, pager, next",total:p(r).totalUsers,"page-size":p(r).pageSize,"hide-on-single-page":!0,"current-page":p(r).currentPage,onCurrentChange:y,class:"pagination_common"},null,8,["total","page-size","current-page"])):f("",!0),0===p(r).usersList.length?(s(),n(L,{key:2,style:{height:"673px"},description:"暂无用户"})):f("",!0)])),_:1}),u(Vt,{isEdit:i.value,currentUser:b.value,onSave:v},null,8,["isEdit","currentUser"])])),_:1})}}}),[["__scopeId","data-v-632a95cc"]]),name:"Users",meta:{requiresAuth:!0}},{path:"/login",component:J(e({__name:"Login",setup(e){const{login:r}=we(),{isAuthenticated:l}=V(r),i=t({username:"",password:""}),m={username:[{required:!0,message:"请输入用户名",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]},g=t(null),f=z(),w=t(!1);a((()=>{l.value&&localStorage.getItem("token")&&U.error("登陆信息出错 请重新登录！")}));const b=t({username:"admin",password:"admin",email:"admin@example.com",role:"ADMIN"}),_=()=>{var e;null==(e=g.value)||e.validate((async e=>{e&&(w.value=!0,await r.login({username:i.value.username,password:i.value.password}).then((()=>{l.value=!0,f.push({name:"/"})})).catch((e=>{l.value=!1,U.error("登录失败："+e)})).finally((()=>{w.value=!1})))}))},v=async()=>{await r.addAminCount(b.value).then((()=>{U.warning("忘记密码？")})).catch((e=>{}))};return(e,t)=>{const a=o("el-header"),r=o("el-input"),l=o("el-form-item"),f=o("el-button"),b=o("el-main"),y=o("el-container");return s(),n(y,{class:"login-container"},{default:c((()=>[u(a,{class:"login-header"},{default:c((()=>t[2]||(t[2]=[d("h1",null,"用户登录",-1)]))),_:1}),u(b,null,{default:c((()=>[u(p(T),{model:i.value,"status-icon":"",rules:m,ref_key:"formRef",ref:g,"label-width":"100px",class:"login-form"},{default:c((()=>[u(l,{label:"用户名",prop:"username"},{default:c((()=>[u(r,{modelValue:i.value.username,"onUpdate:modelValue":t[0]||(t[0]=e=>i.value.username=e),placeholder:"请输入用户名"},null,8,["modelValue"])])),_:1}),u(l,{label:"密码",prop:"password"},{default:c((()=>[u(r,{modelValue:i.value.password,"onUpdate:modelValue":t[1]||(t[1]=e=>i.value.password=e),type:"password",placeholder:"请输入密码"},null,8,["modelValue"])])),_:1}),u(l,null,{default:c((()=>[u(f,{type:"primary",class:"login-button",onClick:_,loading:w.value},{default:c((()=>t[3]||(t[3]=[h("登录")]))),_:1},8,["loading"])])),_:1}),u(l,null,{default:c((()=>[d("span",Mt,[t[5]||(t[5]=h(" 忘记密码? ")),u(f,{size:"small",type:"info",round:"",onClick:v},{default:c((()=>t[4]||(t[4]=[h("点此重置")]))),_:1})])])),_:1})])),_:1},8,["model"])])),_:1})])),_:1})}}}),[["__scopeId","data-v-84b4de98"]]),name:"Login"},{path:"/register",component:J({name:"Register",data(){return{form:{username:"",email:"",password:"",confirmPassword:""},rules:{username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:3,max:20,message:"用户名长度应在3到20个字符之间",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",message:"请输入有效的邮箱地址",trigger:["blur","change"]}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,message:"密码长度不能少于6个字符",trigger:"blur"}],confirmPassword:[{required:!0,message:"请确认密码",trigger:"blur"},{validator:(e,t,a)=>{t!==this.form.password?a(new Error("两次输入的密码不一致")):a()},trigger:"blur"}]}}},methods:{onSubmit(){this.$refs.form.validate((e=>{if(!e)return!1;R.post("/api/register",this.form).then((()=>{this.$message({type:"success",message:"注册成功"})})).catch((e=>{this.$message({type:"error",message:"注册失败，请重试"})}))}))}}},[["render",function(e,t,a,r,l,i){const m=o("el-header"),p=o("el-input"),g=o("el-form-item"),f=o("el-button"),w=o("el-form"),b=o("el-main"),_=o("el-container");return s(),n(_,{class:"register"},{default:c((()=>[u(m,null,{default:c((()=>t[4]||(t[4]=[d("h1",null,"用户注册",-1)]))),_:1}),u(b,null,{default:c((()=>[u(w,{model:l.form,"status-icon":"",rules:l.rules,ref:"form","label-width":"100px"},{default:c((()=>[u(g,{label:"用户名",prop:"username"},{default:c((()=>[u(p,{modelValue:l.form.username,"onUpdate:modelValue":t[0]||(t[0]=e=>l.form.username=e),placeholder:"请输入用户名"},null,8,["modelValue"])])),_:1}),u(g,{label:"邮箱",prop:"email"},{default:c((()=>[u(p,{modelValue:l.form.email,"onUpdate:modelValue":t[1]||(t[1]=e=>l.form.email=e),placeholder:"请输入邮箱"},null,8,["modelValue"])])),_:1}),u(g,{label:"密码",prop:"password"},{default:c((()=>[u(p,{modelValue:l.form.password,"onUpdate:modelValue":t[2]||(t[2]=e=>l.form.password=e),type:"password",placeholder:"请输入密码"},null,8,["modelValue"])])),_:1}),u(g,{label:"确认密码",prop:"confirmPassword"},{default:c((()=>[u(p,{modelValue:l.form.confirmPassword,"onUpdate:modelValue":t[3]||(t[3]=e=>l.form.confirmPassword=e),type:"password",placeholder:"请确认密码"},null,8,["modelValue"])])),_:1}),u(g,null,{default:c((()=>[u(f,{type:"primary",onClick:i.onSubmit},{default:c((()=>t[5]||(t[5]=[h("注册")]))),_:1},8,["onClick"])])),_:1})])),_:1},8,["model","rules"])])),_:1})])),_:1})}],["__scopeId","data-v-43a28940"]]),name:"Register"},{path:"/forgot-password",component:J({name:"ForgotPassword",data:()=>({form:{email:""},rules:{email:[{required:!0,message:"请输入邮箱地址",trigger:"blur"},{type:"email",message:"请输入有效的邮箱地址",trigger:["blur","change"]}]}}),methods:{onSubmit(){this.$refs.form.validate((e=>{if(!e)return!1;R.post("/api/forgot-password",this.form).then((()=>{this.$message({type:"success",message:"重置链接已发送到您的邮箱"})})).catch((e=>{this.$message({type:"error",message:"发送重置链接失败，请检查邮箱地址"})}))}))}}},[["render",function(e,t,a,r,l,i){const m=o("el-header"),p=o("el-input"),g=o("el-form-item"),f=o("el-button"),w=o("el-form"),b=o("el-main"),_=o("el-container");return s(),n(_,{class:"forgot-password"},{default:c((()=>[u(m,null,{default:c((()=>t[1]||(t[1]=[d("h1",null,"找回密码",-1)]))),_:1}),u(b,null,{default:c((()=>[u(w,{model:l.form,"status-icon":"",rules:l.rules,ref:"form","label-width":"100px"},{default:c((()=>[u(g,{label:"邮箱",prop:"email"},{default:c((()=>[u(p,{modelValue:l.form.email,"onUpdate:modelValue":t[0]||(t[0]=e=>l.form.email=e),placeholder:"请输入注册邮箱"},null,8,["modelValue"])])),_:1}),u(g,null,{default:c((()=>[u(f,{type:"primary",onClick:i.onSubmit},{default:c((()=>t[2]||(t[2]=[h("发送重置链接")]))),_:1},8,["onClick"])])),_:1})])),_:1},8,["model","rules"])])),_:1})])),_:1})}],["__scopeId","data-v-76337488"]]),name:"ForgotPassword"},{path:"/:pathMatch(.*)*",component:J({name:"NotFound"},[["render",function(e,t,a,r,l,n){const m=o("router-link");return s(),i("div",Tt,[t[1]||(t[1]=d("h1",null,"404",-1)),t[2]||(t[2]=d("p",null,"抱歉！您访问的页面不存在。",-1)),u(m,{to:"/"},{default:c((()=>t[0]||(t[0]=[h("返回首页")]))),_:1})])}],["__scopeId","data-v-85e1e872"]]),name:"NotFound"},{path:"/500",component:J({name:"ServerError"},[["render",function(e,t,a,r,l,n){const m=o("router-link");return s(),i("div",Ut,[t[1]||(t[1]=d("h1",null,"500",-1)),t[2]||(t[2]=d("p",null,"抱歉，服务器发生错误。",-1)),u(m,{to:"/"},{default:c((()=>t[0]||(t[0]=[h("返回首页")]))),_:1})])}],["__scopeId","data-v-81b649ce"]]),name:"ServerError"},{path:"/403",component:J({name:"Forbidden"},[["render",function(e,t,a,r,l,n){const m=o("router-link");return s(),i("div",Et,[t[1]||(t[1]=d("h1",null,"403",-1)),t[2]||(t[2]=d("p",null,"您无权访问此页面。",-1)),u(m,{to:"/"},{default:c((()=>t[0]||(t[0]=[h("返回首页")]))),_:1})])}],["__scopeId","data-v-8d372cf9"]]),name:"Forbidden"},{path:"/400",component:J({name:"BadRequest"},[["render",function(e,t,a,r,l,n){const m=o("router-link");return s(),i("div",Lt,[t[1]||(t[1]=d("h1",null,"400",-1)),t[2]||(t[2]=d("p",null,"请求错误，请检查您的输入。",-1)),u(m,{to:"/"},{default:c((()=>t[0]||(t[0]=[h("返回首页")]))),_:1})])}],["__scopeId","data-v-6ac85d20"]]),name:"BadRequest"},{path:"/401",component:J({name:"Unauthorized"},[["render",function(e,t,a,r,l,n){const m=o("router-link");return s(),i("div",zt,[t[1]||(t[1]=d("h1",null,"401",-1)),t[2]||(t[2]=d("p",null,"您未被授权访问此页面。",-1)),u(m,{to:"/login"},{default:c((()=>t[0]||(t[0]=[h("登录")]))),_:1})])}],["__scopeId","data-v-428cf9cd"]]),name:"Unauthorized"},{path:"/maintenance",component:J({name:"Maintenance"},[["render",function(e,t,a,r,l,o){return s(),i("div",Ct,t[0]||(t[0]=[d("h1",null,"我们很快回来！",-1),d("p",null,"我们的网站目前正在进行维护。",-1),d("p",null,"感谢您的耐心等待。",-1)]))}],["__scopeId","data-v-0d76c64f"]]),name:"Maintenance"}],xt=C({history:S(),routes:St});xt.beforeEach(((e,t,a)=>{const r=e.matched.some((e=>e.meta.requiresAuth)),l=!!localStorage.getItem("authToken");return r&&!l?a({name:"Login"}):"/login"!==e.path&&"/register"!==e.path||!l?void a():a({path:"/"})}));const jt={class:"el-dropdown-link"},Rt=J(e({__name:"Menu",setup(e){const l=z(),i=x(),m=t(""),g=t(!1),f=()=>{const e=i.path;m.value=e.startsWith("/news")?"/news":e.startsWith("/projects")?"/projects":e.startsWith("/publications")?"/publications":e.startsWith("/resources")?"/resources":e.startsWith("/team")?"/team":e.startsWith("/users")?"/users":e.startsWith("/messages")?"/messages":"/"},w=()=>{g.value=window.outerWidth<=1400},b=()=>{X().clearUserData(),X().$reset(),l.push({name:"Login"})};return a((()=>{f(),w(),window.addEventListener("resize",w)})),r(i,f),(e,t)=>{const a=o("el-col"),r=o("el-icon"),l=o("el-menu-item"),i=o("el-menu"),f=o("el-dropdown-item"),w=o("el-dropdown-menu"),_=o("el-dropdown"),v=o("el-row");return s(),n(v,{class:"header-row",type:"flex",justify:"space-between",align:"middle"},{default:c((()=>[u(a,{span:3,class:"logo-col"},{default:c((()=>t[0]||(t[0]=[d("img",{src:"/frontend_vite_dist/assets/AI_IIOT_Lab-logo-BW8oLYvo.png",alt:"Logo",class:"logo"},null,-1)]))),_:1}),u(a,{span:19,class:"menu-col"},{default:c((()=>[u(i,{"default-active":m.value,router:"",class:"el-menu-demo",mode:"horizontal",ellipsis:g.value,overflow:!0},{default:c((()=>[u(l,{index:"/"},{default:c((()=>[u(r,{class:"menu-icon"},{default:c((()=>[u(p(q))])),_:1}),t[1]||(t[1]=d("span",{class:"menu-text"},"主页",-1))])),_:1}),u(l,{index:"/news"},{default:c((()=>[u(r,{class:"menu-icon"},{default:c((()=>[u(p(F))])),_:1}),t[2]||(t[2]=d("span",{class:"menu-text"},"新闻",-1))])),_:1}),u(l,{index:"/projects"},{default:c((()=>[u(r,{class:"menu-icon"},{default:c((()=>[u(p(F))])),_:1}),t[3]||(t[3]=d("span",{class:"menu-text"},"项目",-1))])),_:1}),u(l,{index:"/publications"},{default:c((()=>[u(r,{class:"menu-icon"},{default:c((()=>[u(p(G))])),_:1}),t[4]||(t[4]=d("span",{class:"menu-text"},"出版物",-1))])),_:1}),u(l,{index:"/resources"},{default:c((()=>[u(r,{class:"menu-icon"},{default:c((()=>[u(p(B))])),_:1}),t[5]||(t[5]=d("span",{class:"menu-text"},"资源",-1))])),_:1}),u(l,{index:"/team"},{default:c((()=>[u(r,{class:"menu-icon"},{default:c((()=>[u(p(G))])),_:1}),t[6]||(t[6]=d("span",{class:"menu-text"},"团队成员",-1))])),_:1}),u(l,{index:"/users"},{default:c((()=>[u(r,{class:"menu-icon"},{default:c((()=>[u(p(G))])),_:1}),t[7]||(t[7]=d("span",{class:"menu-text"},"用户",-1))])),_:1}),u(l,{index:"/messages"},{default:c((()=>[u(r,{class:"menu-icon"},{default:c((()=>[u(p(O))])),_:1}),t[8]||(t[8]=d("span",{class:"menu-text"},"留言查看",-1))])),_:1})])),_:1},8,["default-active","ellipsis"])])),_:1}),u(a,{span:2,class:"logo-col"},{default:c((()=>[u(_,null,{dropdown:c((()=>[u(w,null,{default:c((()=>[u(f,{icon:p(Y),onClick:b},{default:c((()=>t[10]||(t[10]=[h("退出登录")]))),_:1},8,["icon"])])),_:1})])),default:c((()=>[d("span",jt,[t[9]||(t[9]=h(" 菜单")),u(r,{class:"el-icon--right"},{default:c((()=>[u(p(H))])),_:1})])])),_:1})])),_:1})])),_:1})}}}),[["__scopeId","data-v-c3026eb5"]]),At=y(J(e({__name:"App",setup(e){const{login:t}=we(),{isAuthenticated:r}=V(t),l=z();return a((()=>{r.value||"/login"===l.currentRoute.value.path||l.push({name:"Login"})})),(e,t)=>{const a=o("el-header"),l=o("router-view"),d=o("el-main"),h=o("el-container");return s(),n(h,{class:"app"},{default:c((()=>[p(r)?(s(),i(_,{key:0},[u(a,null,{default:c((()=>[u(Rt)])),_:1}),u(d,null,{default:c((()=>[u(l)])),_:1})],64)):(s(),n(d,{key:1},{default:c((()=>[u(l)])),_:1}))])),_:1})}}}),[["__scopeId","data-v-8db316b2"]])),Dt=k();Dt.use(M),At.use(xt),At.use(Dt),At.use(L),At.mount("#app");
